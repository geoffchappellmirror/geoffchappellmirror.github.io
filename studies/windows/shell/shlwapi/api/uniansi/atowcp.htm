<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SHAnsiToUnicodeCP</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>SHAnsiToUnicodeCP </h1>
<p>This function converts as much as possible of a multi-byte string in a given 
code page to a Unicode string. </p>
<h2>Declaration </h2>
<pre class="source">int
SHAnsiToUnicodeCP (
    UINT CodePage,
    LPCSTR pszSrc,
    LPWSTR pwszDst,
    int cwchBuf);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">CodePage</span> argument provides the ID of the 
code page to use for the conversion. </p>
<p>The <span class="argument">pszSrc</span> argument provides the address of a 
null-terminated multi-byte string. </p>
<p>The <span class="argument">pwszDst</span> argument provides the address of a 
buffer that is to receive the Unicode string. </p>
<p>The <span class="argument">cwchBuf</span> argument provides the size of the 
buffer, in Unicode characters. </p>
<h3>Return Value </h3>
<p>The function returns the size of the output string, in Unicode characters, 
including the terminating null. The function returns zero for failure. </p>
<h2>Behaviour </h2>
<p>If <span class="argument">pszSrc</span> is NULL, the function converts a null 
string. If <span class="argument">pwszDst</span> is NULL or
<span class="argument">cwchBuf</span> is zero, the function cannot produce 
output and therefore fails, returning zero. </p>
<p>For most code pages, the conversion is done by the standard API function
<span class="function">MultiByteToWideChar</span>, but for code pages 1200, 
50000, 65000 and 65001, the conversion is done by the MLANG function
<span class="function">ConvertINetMultiByteToUnicode</span>. Either way, if the 
output buffer is too small for a complete conversion, the function attempts a 
complete conversion in a temporary buffer and copies as much of the result as 
will fit in the given output buffer (still with a terminating null). </p>
<h2>Availability </h2>
<p>The <span class="function">SHAnsiToUnicodeCP</span> function is exported from 
SHLWAPI as ordinal 216 in version 5.00 and higher. </p>
<!--webbot bot="Include" U-Include="../_include/undoc500.htm" TAG="BODY" startspan -->

<p>Though this function dates from as long ago as 1999, it was still not 
documented by Microsoft in the MSDN Library at least as late as the CD edition 
dated January 2004. </p>

<!--webbot bot="Include" i-checksum="43429" endspan -->
<p>However, the similar function <span class="function">
<a href="atow.htm">SHAnsiToUnicode</a></span> got documented later in 2004. This 
article now conforms to Microsoft’s nomenclature, inasmuch as the two functions 
are likely to use the same names for the same things. </p>
<div class="Footer">
  <p class="Dates">This page was created on 29th September 2004 and was last 
  modified on 7th August 2009. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c0409.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2004-2009. Geoff Chappell. All rights reserved.
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="3935" endspan -->
</div>

</body>

</html>