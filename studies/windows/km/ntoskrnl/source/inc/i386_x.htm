<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>I386_X.H</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="43332" -->
<h1>I386_X.H </h1>
<div class="Main">
  <p>The public symbol file NTKRPAMP.PDB for the original release of Windows 10 
  tells that the kernel is built with the I386_X.H header at </p>
  <blockquote>
    d:\th\minkernel\ntos\inc
  </blockquote>
  <p>and draws from it the type definitions that are tabulated below. The header 
  I386_X.H is not known in any Device Driver Kit (DDK) or Windows Driver Kit (WDK).
  </p>
  <table class="LineNumbers">
    <colgroup>
      <col class="LineNumber"><col class="Name">
    </colgroup>
    <thead>
      <tr>
        <th>Line Number </th>
        <th>Type </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>580 </td>
        <td>struct <span class="struct">_HARDWARE_PTE</span> </td>
      </tr>
      <tr>
        <td>609 </td>
        <td>struct <span class="struct">_KGDTENTRY</span> </td>
      </tr>
      <tr>
        <td>612 </td>
        <td>unnamed union <span class="member">HighWord</span> <br>
        in struct <span class="union">_KGDTENTRY</span> </td>
      </tr>
      <tr>
        <td>613 </td>
        <td>unnamed struct <span class="member">Bytes</span> in <br>
        unnamed union <span class="member">HighWord</span> in <br>
        struct <span class="struct">_KGDTENTRY</span> </td>
      </tr>
      <tr>
        <td>619 </td>
        <td>unnamed struct <span class="member">Bits</span> in <br>
        unnamed union <span class="member">HighWord</span> in <br>
        struct <span class="struct">_KGDTENTRY</span> </td>
      </tr>
      <tr>
        <td>658 </td>
        <td>struct <span class="struct">_KIDTENTRY</span> </td>
      </tr>
      <tr>
        <td>702 </td>
        <td>struct <span class="struct">_KiIoAccessMap</span> </td>
      </tr>
      <tr>
        <td>708 </td>
        <td>struct <span class="struct">_KTSS</span> </td>
      </tr>
      <tr>
        <td>780 </td>
        <td>struct <span class="struct">_DESCRIPTOR</span> </td>
      </tr>
      <tr>
        <td>788 </td>
        <td>struct <span class="struct">_KSPECIAL_REGISTERS</span> </td>
      </tr>
      <tr>
        <td>816 </td>
        <td>struct <span class="struct">_KPROCESSOR_STATE</span> </td>
      </tr>
      <tr>
        <td>844 </td>
        <td>enum <span class="enum">
        <a href="../../inc/ntos/i386_x/cpu_vendors.htm">CPU_VENDORS</a></span>
        </td>
      </tr>
      <tr>
        <td>858 </td>
        <td>struct <span class="struct">
        <a href="../../inc/ntos/i386_x/kprcb/index.htm">_KPRCB</a></span> </td>
      </tr>
      <tr>
        <td>1512 </td>
        <td>struct <span class="struct">
        <a href="../../inc/ntos/i386_x/kpcr.htm">_KPCR</a></span> </td>
      </tr>
      <tr>
        <td>1642 </td>
        <td>struct <span class="struct">
        <a href="../../inc/ntos/i386_x/ktrap_frame.htm">_KTRAP_FRAME</a></span>
        </td>
      </tr>
      <tr>
        <td>2593 </td>
        <td>union <span class="union">_CPU_INFO</span> </td>
      </tr>
    </tbody>
  </table>
  <p>Of these types that the kernel is known to 
  pick up from I386_X.H, all but one are defined in the NTOSP.H which is in the “minwin” subdirectory 
  of the Windows 10 WDK for the original release and for Version 1511. One is 
  also defined 
  in the standard header NTDDK.H. </p>
  <h2>Reconstruction </h2>
  <p>The line numbers on the left are from the unseen 
  I386_X.H from the original Windows 10. They are deduced from public symbols 
  and statically linked libraries, notably CLFSMGMT.LIB which MIcrosoft 
  publishes with the Software Development Kit (SDK) for Windows 10. Those on the right are from 
  readily available headers, also for the original Windows 10. </p>
  <table class="LineNumbers">
    <colgroup>
      <col class="LineNumber"><col class="Name">
      <col class="LineNumber" span="3">
    </colgroup>
    <thead>
      <tr>
        <th>Line Number </th>
        <th>Type </th>
        <th>WDM.H </th>
        <th>NTDDK.H </th>
        <th>NTOSP.H </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>580 </td>
        <td>struct <span class="struct">_HARDWARE_PTE</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2222 </td>
      </tr>
      <tr>
        <td>581 </td>
        <td>anonymous union in <br>
        struct <span class="struct">_HARDWARE_PTE</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2223 </td>
      </tr>
      <tr>
        <td>582 </td>
        <td>anonymous struct in <br>
        anonymous union in <br>
        struct <span class="struct">_HARDWARE_PTE</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2224 </td>
      </tr>
      <tr>
        <td>598 </td>
        <td>anonymous struct in <br>
        anonymous union in <br>
        struct <span class="struct">_HARDWARE_PTE</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2240 </td>
      </tr>
      <tr>
        <td>609 </td>
        <td>struct <span class="struct">_KGDTENTRY</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2251 </td>
      </tr>
      <tr>
        <td>612 </td>
        <td>unnamed union <span class="member">HighWord</span> in <br>
        struct <span class="union">_KGDTENTRY</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2254 </td>
      </tr>
      <tr>
        <td>613 </td>
        <td>unnamed struct <span class="member">Bytes</span> in <br>
        unnamed union <span class="member">HighWord</span> in <br>
        struct <span class="union">_KGDTENTRY</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2255 </td>
      </tr>
      <tr>
        <td>619 </td>
        <td>unnamed struct <span class="member">Bits</span> in <br>
        unnamed union <span class="member">HighWord</span> in <br>
        struct <span class="union">_KGDTENTRY</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2261 </td>
      </tr>
      <tr>
        <td>658 </td>
        <td>struct <span class="struct">_KIDTENTRY</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2300 </td>
      </tr>
      <tr>
        <td>702 </td>
        <td>struct <span class="struct">_KiIoAccessMap</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2344 </td>
      </tr>
      <tr>
        <td>708 </td>
        <td>struct <span class="struct">_KTSS</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2350 </td>
      </tr>
      <tr>
        <td>780 </td>
        <td>struct <span class="struct">_DESCRIPTOR</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2422 </td>
      </tr>
      <tr>
        <td>788 </td>
        <td>struct <span class="struct">_KSPECIAL_REGISTERS</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2430 </td>
      </tr>
      <tr>
        <td>816 </td>
        <td>struct <span class="struct">_KPROCESSOR_STATE</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2458 </td>
      </tr>
      <tr>
        <td>844 </td>
        <td>enum <span class="enum">CPU_VENDORS</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2486 </td>
      </tr>
      <tr>
        <td>858 </td>
        <td>struct <span class="struct">_KPRCB</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2500 </td>
      </tr>
      <tr>
        <td>879 </td>
        <td>anonymous union in <br>
        struct <span class="struct">_KPRCB</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2521 </td>
      </tr>
      <tr>
        <td>881 </td>
        <td>anonymous struct in <br>
        anonymous union in <br>
        struct <span class="struct">_KPRCB</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2523 </td>
      </tr>
      <tr>
        <td>921 </td>
        <td>anonymous union in <br>
        struct <span class="struct">_KPRCB</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2563 </td>
      </tr>
      <tr>
        <td>924 </td>
        <td>anonymous struct in <br>
        anonymous union in <br>
        struct <span class="struct">_KPRCB</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2566 </td>
      </tr>
      <tr>
        <td>1127 </td>
        <td>anonymous union in <br>
        struct <span class="struct">_KPRCB</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>1130 </td>
        <td>anonymous struct in <br>
        anonymous union in <br>
        struct <span class="struct">_KPRCB</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>1135 </td>
        <td>anonymous struct in <br>
        anonymous union in <br>
        struct <span class="struct">_KPRCB</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>1512 </td>
        <td>struct <span class="struct">_KPCR</span> </td>
        <td>&nbsp;</td>
        <td>5023 </td>
        <td>2594 </td>
      </tr>
      <tr>
        <td>1526 </td>
        <td>anonymous union in <br>
        struct <span class="struct">_KPCR</span> </td>
        <td>&nbsp;</td>
        <td>5037 </td>
        <td>2608 </td>
      </tr>
      <tr>
        <td>1528 </td>
        <td>anonymous struct in <br>
        anonymous union in <br>
        struct <span class="struct">_KPCR</span> </td>
        <td>&nbsp;</td>
        <td>5039 </td>
        <td>2610 </td>
      </tr>
      <tr>
        <td>1642 </td>
        <td>struct <span class="struct">_KTRAP_FRAME</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2702 </td>
      </tr>
      <tr>
        <td>1769 </td>
        <td>struct <span class="struct">_KXMM_FRAME</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>2829 </td>
      </tr>
      <tr>
        <td>1780 </td>
        <td>struct <span class="struct">_KFLOATING_SAVE</span> </td>
        <td>16265 </td>
        <td>&nbsp;</td>
        <td>2838 </td>
      </tr>
      <tr>
        <td>1795 </td>
        <td>union <span class="union">_AMD_L1_CACHE_INFO</span> </td>
        <td>16280 </td>
        <td>&nbsp;</td>
        <td>2853 </td>
      </tr>
      <tr>
        <td>1797 </td>
        <td>anonymous struct in <br>
        union <span class="union">_AMD_L1_CACHE_INFO</span> </td>
        <td>16282 </td>
        <td>&nbsp;</td>
        <td>2855 </td>
      </tr>
      <tr>
        <td>1805 </td>
        <td>union <span class="union">_AMD_L2_CACHE_INFO</span> </td>
        <td>16290 </td>
        <td>&nbsp;</td>
        <td>2863 </td>
      </tr>
      <tr>
        <td>1807 </td>
        <td>anonymous struct in <br>
        union <span class="union">_AMD_L2_CACHE_INFO</span> </td>
        <td>16292 </td>
        <td>&nbsp;</td>
        <td>2865 </td>
      </tr>
      <tr>
        <td>1815 </td>
        <td>union <span class="union">_AMD_L3_CACHE_INFO</span> </td>
        <td>16300 </td>
        <td>&nbsp;</td>
        <td>2873 </td>
      </tr>
      <tr>
        <td>1817 </td>
        <td>anonymous struct in <br>
        union <span class="union">_AMD_L3_CACHE_INFO</span> </td>
        <td>16302 </td>
        <td>&nbsp;</td>
        <td>2875 </td>
      </tr>
      <tr>
        <td>1831 </td>
        <td>enum <span class="enum">_INTEL_CACHE_TYPE</span> </td>
        <td>16316 </td>
        <td>&nbsp;</td>
        <td>2889 </td>
      </tr>
      <tr>
        <td>1840 </td>
        <td>union <span class="union">INTEL_CACHE_INFO_EAX</span> </td>
        <td>16325 </td>
        <td>&nbsp;</td>
        <td>2898 </td>
      </tr>
      <tr>
        <td>1842 </td>
        <td>anonymous struct in <br>
        union <span class="union">INTEL_CACHE_INFO_EAX</span> </td>
        <td>16327 </td>
        <td>&nbsp;</td>
        <td>2900 </td>
      </tr>
      <tr>
        <td>1853 </td>
        <td>union <span class="union">INTEL_CACHE_INFO_EBX</span> </td>
        <td>16338 </td>
        <td>&nbsp;</td>
        <td>2911 </td>
      </tr>
      <tr>
        <td>1855 </td>
        <td>anonymous struct in <br>
        union <span class="union">INTEL_CACHE_INFO_EBX</span> </td>
        <td>16340 </td>
        <td>&nbsp;</td>
        <td>2913 </td>
      </tr>
      <tr>
        <td>2046 </td>
        <td>enum <span class="enum">_INTERLOCKED_RESULT</span> </td>
        <td>&nbsp;</td>
        <td>5155 </td>
        <td>3089 </td>
      </tr>
      <tr>
        <td>2150 </td>
        <td>struct <span class="struct">_FAR_JMP_16</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>3172 </td>
      </tr>
      <tr>
        <td>2160 </td>
        <td>struct <span class="struct">_PROCESSOR_START_BLOCK</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>3182 </td>
      </tr>
      <tr>
        <td>2410 </td>
        <td>struct <span class="struct">_UCALLOUT_FRAME</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>2545 </td>
        <td>union <span class="union">_PAT_ATTRIBUTES</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>2546 </td>
        <td>unnamed struct <span class="member">hw</span> in <br>
        union <span class="union">_PAT_ATTRIBUTES</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>2593 </td>
        <td>union <span class="union">_CPU_INFO</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>2595 </td>
        <td>anonymous struct in <br>
        union <span class="union">_CPU_INFO</span> </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
    </tbody>
  </table>
  <p>To go by the line numbers, the several hundred lines from
  <span class="struct">_HARDWARE_PTE</span> to <span class="struct">_KPRCB</span> 
  look to be copied exactly from I386_X.H to NTOSP.H. There, however, the 
  duplication becomes selective. The <span class="struct">_KPRCB</span> 
  definition in NTOSP.H is not the full definition. It ends after what 
  a comment describes as the “architecturally defined section of the PRCB.” Presumably, 
  the comment is in I386_X.H too, but is there followed by an “end_ntosp” comment 
  that ends the extraction to NTOSP.H, and then by something like five hundred lines 
  of non-architectural <span class="struct">_KPRCB</span> members and a “begin_ntosp” 
  comment to resume the extraction ahead of closing the reduced definition. </p>
  <p>The smaller <span class="struct">_KPCR</span> structure is similarly affected, 
  though without an explanatory comment. Some of the roughly twenty lines, mostly 
  if not entirely for <span class="struct">_KPCR</span> members, that are not extracted to NTOSP.H turn up in NTDDK.H. This is a rare case in which the public 
  NTDDK.H has more of a definition than does the private NTOSP.H. Neither of these 
  headers, however, has the full definition from I386_X.H which is knowable from 
  type information in public symbol files for the kernel. </p>
  <div class="Footer">
    <p class="Dates">This page was created on 23rd July 2020 but was not published 
    until 27th <a href="../../../../../../new/20/10.htm">October 2020</a>. It was 
    last modified on 6th <a href="../../../../../../new/23/02.htm">February 2023</a>. </p>
    <!--webbot bot="Include" U-Include="../../../_include/c2023.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2020-2023. Geoff Chappell. All rights reserved. 
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="54423" --></div>
</div>

</body>

</html>
