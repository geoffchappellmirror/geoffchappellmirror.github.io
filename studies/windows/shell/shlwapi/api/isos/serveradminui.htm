<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>OS_SERVERADMINUI</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>OS_SERVERADMINUI </h1>
<p>When the <span class="function"><a href="isos.htm">IsOS</a></span> function is 
given <span class="constant">OS_SERVERADMINUI</span> as its
<span class="argument">dwOS</span> argument, it answers according to the following 
registry value: </p>
<table class="Registry">
  <tr>
    <td>Key </td>
    <td><span class="regvalue">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced</span>
    </td>
  </tr>
  <tr>
    <td>Value </td>
    <td><span class="regvalue">ServerAdminUI</span> </td>
  </tr>
  <tr>
    <td>Type </td>
    <td><span class="constant">REG_DWORD</span> or <span class="constant">REG_BINARY</span>
    </td>
  </tr>
</table>
<p>Version 6.1 and higher return TRUE or FALSE according to whether the value has 
non-zero data of the expected type. Before then, the function accepts any data of 
any type, up to and including 4 bytes (reading into a zeroed buffer), and returns 
the data (and thus not necessarily TRUE or FALSE). </p>
<h2>The ServerAdminUI Registry Value </h2>
<p>A thorough explanation of this registry value is presently beyond the scope of 
this article, but a write-up is planned for this site’s section on tips and tweaks. 
A brief summary is offered meanwhile. </p>
<p>The <span class="regvalue">ServerAdminUI</span> value is prepared by EXPLORER.EXE 
to record that the user is likely to work more closely with the operating system 
than is typical and may prefer a user interface that tries less to be friendly—indeed, 
that this user may regard the standard behaviour not as friendly but as intrusive, 
irritating and even highly unwelcome. EXPLORER itself calculates this value when 
first run (per-user), or if the value has been deleted. EXPLORER sets the value 
as a DWORD to 1 or 0, mostly according to whether the operating system is a server 
edition and the user has sufficient privilege. The only action that EXPLORER itself 
takes in response to the calculation is to make it the default that Administrative 
Tools be shown on the Start Menu. The <span class="regvalue">ServerAdminUI</span> 
registry value is EXPLORER’s record of the calculation so that other modules, most 
notably SHELL32, can know to change their defaults away from such things as hiding 
filename extensions and preferring Large Icons to Details. </p>
<p>For a demonstration of the feature, start Windows Server 2003 and create two 
new test accounts. Make one an administrator and leave the other as an ordinary 
user. Log on to each in turn, and see that they are given different initial settings 
in the Folder Options. </p>
<h2>Availability </h2>
<p>The <span class="constant">OS_SERVERADMINUI</span> case of the SHLWAPI function
<span class="function">IsOS</span> is supported in version 6.0 from Windows XP SP2, 
and higher. </p>
<div class="Footer">
  <p class="Dates">This page was created on 11th May 2007 and was last modified 
  on 27th December 2009. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c0709.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2007-2009. Geoff Chappell. All rights reserved.
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="4319" endspan -->
</div>

</body>

</html>
