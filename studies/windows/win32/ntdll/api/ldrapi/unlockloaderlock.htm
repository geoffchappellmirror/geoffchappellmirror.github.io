<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>LdrUnlockLoaderLock</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/win32.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/win32.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell, Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="54033" endspan -->
<h1>LdrUnlockLoaderLock </h1>
<p>This function releases the special critical section known as the loader lock.
</p>
<h2>Declaration </h2>
<pre class="source">NTSTATUS
LdrUnlockLoaderLock (
    ULONG Flags,
    ULONG Cookie);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">Flags</span> argument supplies bit flags to vary the 
function’s behaviour. There is one supported value: </p>
<table>
  <tr>
    <td>0x01 </td>
    <td>do not return error, raise exception </td>
  </tr>
</table>
<p>The <span class="argument">Cookie</span> argument is a cookie that is expected 
to have been obtained from <span class="function"><a href="lockloaderlock.htm">LdrLockLoaderLock</a></span>.
</p>
<h3>Return Value </h3>
<p>The function returns zero for success, else an error code. </p>
<p>If the 0x01 bit is set in the <span class="argument">Flags</span>, then all errors 
are reported as exceptions. If the function returns at all, it is successful. Indeed, 
the point to the 0x01 bit is surely that the function may be treated as returning
<span class="type">void</span>. </p>
<h2>Behaviour </h2>
<p>The function distinguishes several cases of invalid parameter: </p>
<table>
  <tr>
    <td><span class="constant">STATUS_INVALID_PARAMETER_1</span> </td>
    <td>the <span class="argument">Flags</span> argument has a set bit other than 
    the one shown above </td>
  </tr>
  <tr>
    <td><span class="constant">STATUS_INVALID_PARAMETER_2</span> </td>
    <td>the <span class="argument">Cookie</span> argument is invalid (see below)
    </td>
  </tr>
</table>
<p>If the <span class="argument">Cookie</span> argument is zero, the function succeeds 
trivially, i.e., without releasing the loader lock. Otherwise, the cookie is tested 
for some sort of plausibility as having been generated by an earlier call to
<span class="function">LdrLockLoaderLock</span> by the same thread. The test is 
surely an implementation detail and should not be depended upon. Only the high word 
matters. Its high 4 bits must be clear. Its low 12 bits must be those of the thread 
ID. </p>
<p>Except for invalid parameters, the function can fail only if an exception occurs 
while trying to leave the loader lock. If the 0x01 bit is clear, such exceptions 
are caught within the function, so that the exception code becomes the returned 
value. </p>
<h2>Availability </h2>
<p>The <span class="function">LdrUnlockLoaderLock</span> function is exported by 
name from NTDLL.DLL in version 5.1 and higher. </p>
<div class="Footer">
  <p class="Dates">This page was created on 26th November 2008. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c08.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2008. Geoff Chappell. All rights reserved. 
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="62741" endspan -->
</div>

</body>

</html>
