<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SYSTEM_VDM_INSTEMUL_INFO</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <h1>SYSTEM_VDM_INSTEMUL_INFO </h1>
  <p>The <span class="struct">SYSTEM_VDM_INSTEMUL_INFO</span> structure (formally
  <span class="struct">_SYSTEM_VDM_INSTEMUL_INFO</span>) is what a successful call 
  to <span class="function"><a href="../../../api/ex/sysinfo/query.htm">ZwQuerySystemInformation</a></span> 
  or <span class="function">NtQuerySystemInformation</span> produces in its output 
  buffer when given the information class <span class="constant">SystemVdmInstemulInformation</span> 
  (0x13). </p>
  <p>The x64 builds reject this information class as not implemented. </p>
  <h2>Documentation Status </h2>
  <p>The <span class="struct">SYSTEM_VDM_INSTEMUL_INFO</span> structure is not documented.
  </p>
  <!--webbot bot="Include" U-Include="../_include/type_info_urlmon.htm" TAG="BODY" startspan -->

<p>Microsoft does publish the practical equivalent of a C-language definition as 
type information in symbol files—not for the kernel, where the structure is prepared, 
nor even for low-level user-mode DLLs that interpret the structure, but for a handful 
of higher-level DLLs that might ordinarily be thought very distant from any involvement 
with the structure. Perhaps only by oversight, but starting as long ago as Windows 
8, Microsoft’s downloadable packages of public symbols have included a smattering 
of private symbol files and these continue to be available through the public symbol 
server. Precisely which DLLs have the type information varies between versions. 
COMBASE.DLL is among the more reliable nowadays. Disclosure in symbol files for 
URLMON.DLL stopped for the 1803 release of Windows 10 but is specially notable 
because of this DLL’s origins in Internet Explorer and thence for the strong suggestion 
that Microsoft’s programmers of Internet Explorer had access to more details of 
low-level Windows programming than Microsoft publishes for wider use (including 
by the programmers of competing web browsers). </p>

<!--webbot bot="Include" endspan i-checksum="12783" -->
  <!--webbot bot="Include" U-Include="../_include/type_info_ddklibs.htm" TAG="BODY" startspan -->

<p>Type information for the structure has also seeped out at the other end of the 
Windows timeline, though not in symbol files but in statically linked libraries: 
GDISRVL.LIB from the Device Driver Kit (DDK) for Windows NT 3.51; and SHELL32.LIB 
from the DDK for Windows NT 4.0. </p>

<!--webbot bot="Include" endspan i-checksum="3859" -->
  <h2>Layout </h2>
  <p>The <span class="struct">SYSTEM_VDM_INSTEMUL_INFO</span> is 0x88 bytes in both 
  32-bit and 64-bit Windows in all known versions. </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset"><col class="Definition">
    </colgroup>
    <thead>
      <tr>
        <th>Offset </th>
        <th>Definition </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00 </td>
        <td>
        <pre class="source">ULONG SegmentNotPresent;</pre>
        </td>
      </tr>
      <tr>
        <td>0x04 </td>
        <td>
        <pre class="source">ULONG VdmOpcode0F;</pre>
        </td>
      </tr>
      <tr>
        <td>0x08 </td>
        <td>
        <pre class="source">ULONG OpcodeESPrefix;</pre>
        </td>
      </tr>
      <tr>
        <td>0x0C </td>
        <td>
        <pre class="source">ULONG OpcodeCSPrefix;</pre>
        </td>
      </tr>
      <tr>
        <td>0x10 </td>
        <td>
        <pre class="source">ULONG OpcodeSSPrefix;</pre>
        </td>
      </tr>
      <tr>
        <td>0x14 </td>
        <td>
        <pre class="source">ULONG OpcodeDSPrefix;</pre>
        </td>
      </tr>
      <tr>
        <td>0x18 </td>
        <td>
        <pre class="source">ULONG OpcodeFSPrefix;</pre>
        </td>
      </tr>
      <tr>
        <td>0x1C </td>
        <td>
        <pre class="source">ULONG OpcodeGSPrefix;</pre>
        </td>
      </tr>
      <tr>
        <td>0x20 </td>
        <td>
        <pre class="source">ULONG OpcodeOPER32Prefix;</pre>
        </td>
      </tr>
      <tr>
        <td>0x24 </td>
        <td>
        <pre class="source">ULONG OpcodeADDR32Prefix;</pre>
        </td>
      </tr>
      <tr>
        <td>0x28 </td>
        <td>
        <pre class="source">ULONG OpcodeINSB;</pre>
        </td>
      </tr>
      <tr>
        <td>0x2C </td>
        <td>
        <pre class="source">ULONG OpcodeINSW;</pre>
        </td>
      </tr>
      <tr>
        <td>0x30 </td>
        <td>
        <pre class="source">ULONG OpcodeOUTSB;</pre>
        </td>
      </tr>
      <tr>
        <td>0x34 </td>
        <td>
        <pre class="source">ULONG OpcodeOUTSW;</pre>
        </td>
      </tr>
      <tr>
        <td>0x38 </td>
        <td>
        <pre class="source">ULONG OpcodePUSHF;</pre>
        </td>
      </tr>
      <tr>
        <td>0x3C </td>
        <td>
        <pre class="source">ULONG OpcodePOPF;</pre>
        </td>
      </tr>
      <tr>
        <td>0x40 </td>
        <td>
        <pre class="source">ULONG OpcodeINTnn;</pre>
        </td>
      </tr>
      <tr>
        <td>0x44 </td>
        <td>
        <pre class="source">ULONG OpcodeINTO;</pre>
        </td>
      </tr>
      <tr>
        <td>0x48 </td>
        <td>
        <pre class="source">ULONG OpcodeIRET;</pre>
        </td>
      </tr>
      <tr>
        <td>0x4C </td>
        <td>
        <pre class="source">ULONG OpcodeINBimm;</pre>
        </td>
      </tr>
      <tr>
        <td>0x50 </td>
        <td>
        <pre class="source">ULONG OpcodeINWimm;</pre>
        </td>
      </tr>
      <tr>
        <td>0x54 </td>
        <td>
        <pre class="source">ULONG OpcodeOUTBimm;</pre>
        </td>
      </tr>
      <tr>
        <td>0x58 </td>
        <td>
        <pre class="source">ULONG OpcodeOUTWimm;</pre>
        </td>
      </tr>
      <tr>
        <td>0x5C </td>
        <td>
        <pre class="source">ULONG OpcodeINB;</pre>
        </td>
      </tr>
      <tr>
        <td>0x60 </td>
        <td>
        <pre class="source">ULONG OpcodeINW;</pre>
        </td>
      </tr>
      <tr>
        <td>0x64 </td>
        <td>
        <pre class="source">ULONG OpcodeOUTB;</pre>
        </td>
      </tr>
      <tr>
        <td>0x68 </td>
        <td>
        <pre class="source">ULONG OpcodeOUTW;</pre>
        </td>
      </tr>
      <tr>
        <td>0x6C </td>
        <td>
        <pre class="source">ULONG OpcodeLOCKPrefix;</pre>
        </td>
      </tr>
      <tr>
        <td>0x70 </td>
        <td>
        <pre class="source">ULONG OpcodeREPNEPrefix;</pre>
        </td>
      </tr>
      <tr>
        <td>0x74 </td>
        <td>
        <pre class="source">ULONG OpcodeREPPrefix;</pre>
        </td>
      </tr>
      <tr>
        <td>0x78 </td>
        <td>
        <pre class="source">ULONG OpcodeHLT;</pre>
        </td>
      </tr>
      <tr>
        <td>0x7C </td>
        <td>
        <pre class="source">ULONG OpcodeCLI;</pre>
        </td>
      </tr>
      <tr>
        <td>0x80 </td>
        <td>
        <pre class="source">ULONG OpcodeSTI;</pre>
        </td>
      </tr>
      <tr>
        <td>0x84 </td>
        <td>
        <pre class="source">ULONG BopCount;</pre>
        </td>
      </tr>
    </tbody>
  </table>
  <p>Each member is a dispatch count, mostly for a corresponding opcode whose virtual-8086 
  execution is handled first in ring 0. </p>
  <div class="Footer">
    <p class="Dates">This page was created on 9th July 2016 but was not published 
    until 25th <a href="../../../../../../../new/16/10.htm">October 2016</a>. It 
    was last modified on 20th February 2023. </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c1623.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2016-2023. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="4941" -->
  </div>
</div>

</body>

</html>
