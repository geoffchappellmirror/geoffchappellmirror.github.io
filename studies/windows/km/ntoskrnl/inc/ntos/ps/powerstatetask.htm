<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>POWERSTATETASK</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <h1>POWERSTATETASK </h1>
  <p>The <span class="enum">POWERSTATETASK</span> (formally <span class="enum">_POWERSTATETASK</span>) 
  enumerates the possible notifications that can percolate from the kernel to user 
  mode to tell of changes in power state. The enumeration passes to WIN32K.SYS (or, 
  if only in principle, whoever else registered instead) as a member of the
  <span class="struct"><a href="win32_powerstate_parameters.htm">WIN32_POWERSTATE_PARAMETERS</a></span> 
  structure. </p>
  <h2>Documentation Status </h2>
  <p>Even among undocumented enumerations, the <span class="enum">POWERSTATETASK</span> 
  is unusually obscure. Except for what looks to be known from leaked source code 
  and then recirculated as research, Microsoft’s name for this enumeration, let 
  alone for any of its members, was unknown for decades—and then Microsoft disclosed 
  the whole of it twice. </p>
  <p>First is a C-language definition in the NTOSP.H which Microsoft published with 
  the Windows Driver Kit (WDK) for the original and 1511 releases of Windows 10. 
  Publication of this header was apparently an oversight. Though it is chock full 
  of previously undisclosed definitions for kernel-mode programming, it is supplied 
  in a subdirectory (named “minwin”) of a directory named “um” as if to suggest 
  user-mode programming. Mistake or not, this disclosure has not been repeated in 
  later kits. </p>
  <p>The second disclosure is in type information from symbol files for a driver 
  named NetAdapterCx.sys. Starting with the 1803 release of Windows 10, the symbol 
  files for this driver, as made available by Microsoft at its public symbol server, 
  are private symbol files. They have type information for the
  <span class="enum">POWERSTATETASK</span> from the driver’s inclusion of NTOSP.H.
  </p>
  <p>Or so I wrote at first. Type information for the POWERSTATETASK turns out to 
  have been available more obscurely, in a statically linked library named CLFSMGMT.LIB 
  which Microsoft distributes with the Software Development Kit (SDK) as if for 
  user-mode programming. This type information goes back to Windows Vista. </p>
  <h2>Values </h2>
  <p>Microsoft’s names for the enumeration and for some of its defined values are 
  known with certainty only for Windows Vista and higher, as described above.
  </p>
  <table class="Enum">
    <colgroup>
      <col class="Value"><col class="Symbol"><col class="Version">
    </colgroup>
    <thead>
      <tr>
        <th>Value </th>
        <th>Symbol </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0 </td>
        <td><span class="constant">PowerState_BlockSessionSwitch</span> </td>
        <td>5.1 and higher </td>
      </tr>
      <tr>
        <td>1 </td>
        <td><span class="constant">PowerState_Init</span> </td>
        <td>5.1 and higher </td>
      </tr>
      <tr>
        <td rowspan="2">2 (5.1 to 6.0) </td>
        <td>query </td>
        <td>5.1 to 5.2 </td>
      </tr>
      <tr>
        <td><span class="constant">PowerState_QueryApps</span> </td>
        <td>6.0 only </td>
      </tr>
      <tr>
        <td>3 (6.0) </td>
        <td><span class="constant">PowerState_QueryServices</span> </td>
        <td>6.0 only </td>
      </tr>
      <tr>
        <td rowspan="2">3 (5.1 to 5.2); <br>
        4 (6.0) </td>
        <td>query failed </td>
        <td>5.1 to 5.2 </td>
      </tr>
      <tr>
        <td><span class="constant">PowerState_QueryAppsFailed</span> </td>
        <td>6.0 only </td>
      </tr>
      <tr>
        <td>5 (6.0) </td>
        <td><span class="constant">PowerState_QueryServicesFailed</span> </td>
        <td>6.0 only </td>
      </tr>
      <tr>
        <td rowspan="2">4 (5.1 to 5.2); <br>
        6 (6.0); <br>
        2 </td>
        <td>suspend </td>
        <td>5.1 to 5.2 </td>
      </tr>
      <tr>
        <td><span class="constant">PowerState_SuspendApps</span> </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>7 (6.0); <br>
        3 </td>
        <td><span class="constant">PowerState_SuspendServices</span> </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>5 (5.1 to 5.2); <br>
        8 (6.0) </td>
        <td><span class="constant">PowerState_ShowUI</span> </td>
        <td>5.1 to 6.0 </td>
      </tr>
      <tr>
        <td>6 (5.1 to 5.2); <br>
        9 (6.0); <br>
        4 </td>
        <td><span class="constant">PowerState_NotifyWL</span> </td>
        <td>5.1 and higher </td>
      </tr>
      <tr>
        <td rowspan="2">7 (5.1 to 5.2); <br>
        10 (6.0); <br>
        5 </td>
        <td>resume </td>
        <td>5.1 to 5.2 </td>
      </tr>
      <tr>
        <td><span class="constant">PowerState_ResumeApps</span> </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>11 (6.0); <br>
        6 </td>
        <td><span class="constant">PowerState_ResumeServices</span> </td>
        <td>6.1 and higher </td>
      </tr>
      <tr>
        <td>8 (5.1 to 5.2); <br>
        12 (6.0); <br>
        7 </td>
        <td><span class="constant">PowerState_UnblockSessionSwitch</span> </td>
        <td>5.1 and higher </td>
      </tr>
      <tr>
        <td>13 (6.0); <br>
        8 </td>
        <td><span class="constant">PowerState_End</span> </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>14 (6.0) </td>
        <td><span class="constant">PowerState_HideUI</span> </td>
        <td>6.0 only </td>
      </tr>
      <tr>
        <td>9 </td>
        <td><span class="constant">PowerState_Flush</span> </td>
        <td>6.1 and higher </td>
      </tr>
      <tr>
        <td>10 </td>
        <td><span class="constant">PowerState_StartPartitionReplace</span> </td>
        <td>6.1 and higher </td>
      </tr>
      <tr>
        <td>11 </td>
        <td><span class="constant">PowerState_EndPartitionReplace</span> </td>
        <td>6.1 and higher </td>
      </tr>
      <tr>
        <td>12 </td>
        <td><span class="constant">PowerState_MonitorOff</span> </td>
        <td>10.0 and higher </td>
      </tr>
      <tr>
        <td>13 </td>
        <td><span class="constant">PowerState_PrepareSleep</span> </td>
        <td>1903 and higher </td>
      </tr>
    </tbody>
  </table>
  <div class="Footer">
    <p class="Dates">This page was created on 20th
    <a href="../../../../../../../new/22/09.htm">September 2022</a> and was last 
    modified on 5th December 2022. </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c22.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2022. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="5890" -->
  </div>
</div>

</body>

</html>
