<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>NTDLL Versions</title>
<link rel="stylesheet" type="text/css" href="../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../_styles/win32.css">
<script type="text/javascript" src="../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../_scripts/win32.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="63592" -->
<div class="Main">
  <h1>NTDLL Versions </h1>
  <p>As the kernel’s footprint in user mode, NTDLL.DLL is essential to the Windows 
  NT architecture from the start. Major version 4, however, is shared with the 32-bit 
  Windows that runs on DOS. Only in the NT versions of Windows is NTDLL.DLL a substantial 
  executable. </p>
  <table class="ProductVersions">
    <colgroup>
      <col class="ProductVersion"><col span="2" class="Package">
    </colgroup>
    <thead>
      <tr>
        <th rowspan="2" class="ProductVersion">File Version </th>
        <th colspan="2" class="Distribution">Distribution </th>
      </tr>
      <tr>
        <th class="Distribution">Windows </th>
        <th class="Distribution">NT </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>3.10 </td>
        <td>&nbsp;</td>
        <td>Windows NT 3.10 </td>
      </tr>
      <tr>
        <td>3.50 </td>
        <td>&nbsp;</td>
        <td>Windows NT 3.50 </td>
      </tr>
      <tr>
        <td>3.51 </td>
        <td>&nbsp;</td>
        <td>Windows NT 3.51 </td>
      </tr>
      <tr>
        <td>4.0 </td>
        <td>Windows 95 </td>
        <td>Windows NT 4.0 </td>
      </tr>
      <tr>
        <td>4.10 </td>
        <td>Windows 98 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>4.90 </td>
        <td>Windows Me </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>5.0 </td>
        <td>&nbsp;</td>
        <td>Windows 2000 </td>
      </tr>
      <tr>
        <td>5.1 </td>
        <td>&nbsp;</td>
        <td>Windows XP </td>
      </tr>
      <tr>
        <td>5.2 </td>
        <td>&nbsp;</td>
        <td>Windows Server 2003 </td>
      </tr>
      <tr>
        <td>6.0 </td>
        <td>&nbsp;</td>
        <td>Windows Vista <br>
        Windows Server 2008 </td>
      </tr>
      <tr>
        <td>6.1 </td>
        <td>&nbsp;</td>
        <td>Windows 7 <br>
        Windows Server 2008 R2 </td>
      </tr>
      <tr>
        <td>6.2 </td>
        <td>&nbsp;</td>
        <td>Windows 8 </td>
      </tr>
      <tr>
        <td>6.3 </td>
        <td>&nbsp;</td>
        <td>Windows 8.1 </td>
      </tr>
      <tr>
        <td>10.0 </td>
        <td>&nbsp;</td>
        <td>Windows 10 </td>
      </tr>
    </tbody>
  </table>
  <p>Until version 6.0 reunified client and server editions under different product 
  names, each new name for a Windows package brought at least a change of the minor 
  version number. (Yes, that should be unremarkable, but compare with DLLs from 
  the Windows Shell, some of which kept to one version number for all of Windows 
  XP, Windows Server 2003, Windows Vista and Windows Server 2008.) </p>
  <p>The version numbering gets indisputably quirky for Windows Vista, Windows 7, 
  Windows 8 and Windows 8.1. These were each in their time promoted as a significant—even 
  major—release, yet they all have the same major version number which anyway isn’t 
  in any of the names. As if to acknowledge this as unsatisfactory, the major version 
  number for Windows 10 leaps ahead to 10. </p>
  <h2>Builds </h2>
  <!--webbot bot="Include" U-Include="../../_include/builds.htm" TAG="BODY" startspan -->

<p>The following builds have been inspected for these notes. Most are from MSDN 
discs. Some, especially since Microsoft greatly reduced its shipment of operating 
systems on MSDN discs, are from service packs downloaded (typically as self-extracting 
executables) from a Microsoft website. </p>
<p>Special mention must be made of the very oldest builds. Even among the many discs 
that I retain from MSDN subscriptions in the mid-1990s, what was then the new Windows 
that is entirely its own operating system rather than a large DOS program goes no 
further back than Windows NT 3.51. For all practical effect, Microsoft informally 
disowned the early versions, even for its so-called Archive editions. For decades 
I had little choice but to treat Windows NT 3.51 as the dawn of time for these notes. 
In 2017 someone pointed me to an online collection of earlier builds. The sample 
is inevitably incomplete. The provenance is unknown. I have since sought more: the
<a href="https://winworldpc.com/home">WinWorld</a> online museum is notable. </p>
<p>Builds are arranged in increasing order of the file version as recorded in the 
executable’s resources. This version number is readily visible using Windows Explorer 
either in a so-called infotip for the file or by accessing the Version tab in the 
Properties dialog for the file. Programmers know this version number as coming from 
the so-called root block of the version-information resource, specifically from 
the <span class="member">dwFileVersionMS</span> and <span class="member">dwFileVersionLS</span> 
members of a <span class="struct">VS_FIXEDFILEINFO</span> structure. </p>
<p>The date stamp shown for each version is more obscure. File dates are easily 
modified after the executable is built and are anyway liable to be shown differently 
when read from different time zones. However, there is in each executable’s header 
a date stamp which is set when the executable is built and which is not commonly 
changed afterwards. It is readily accessible to anyone with programming knowledge 
and appropriate tools, e.g., Microsoft’s own DUMPBIN utility. </p>
<p>Any study worth making of Windows—and please remember that the list below exists 
only as a catalogue of which builds I have obtained for study—is much too intensive 
to cover pre-release builds, hot fixes and other updates. Access to pre-release 
builds anyway tends to come with constraints and compromise that other researchers 
may tolerate (and even be happy with) but which I do not. None of this work is done 
with any sort of assistance from Microsoft beyond the binaries, as published by 
the tens and even hundreds of millions, and the same documentation that’s available 
to all Windows programmers. </p>

<!--webbot bot="Include" endspan i-checksum="64682" -->
  <h3>32-Bit Windows (x86) </h3>
  <p>For the versions of Windows that runs on MS-DOS, NTDLL exists only as a small 
  collection of stub functions, and might more usefully be considered a different 
  executable. </p>
  <table class="FileVersions">
    <colgroup>
      <col class="Version"><col class="Date"><col class="Size">
      <col class="Package">
    </colgroup>
    <thead>
      <tr>
        <th>File Version </th>
        <th>File Header Date Stamp </th>
        <th>File Size </th>
        <th>Package </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>3.10.497.1 </td>
        <td>2C4F15D7 (22nd July 1993) </td>
        <td>264,676 </td>
        <td>Windows NT 3.10 Advanced Server <br>
        Windows NT 3.10 Workstation </td>
      </tr>
      <tr>
        <td>3.10.511.1 </td>
        <td>2DA1DF9B (5th April 1994) </td>
        <td>264,660 </td>
        <td>Windows NT 3.10 SP3 </td>
      </tr>
      <tr>
        <td>3.50.800.1 </td>
        <td>2E67E68D (2nd September 1994) </td>
        <td>269,120 </td>
        <td>Windows NT 3.50 </td>
      </tr>
      <tr>
        <td>3.50.807.1 </td>
        <td>2FCE52C7 (1st June 1995) </td>
        <td>267,072 </td>
        <td>Windows NT 3.50 SP3 </td>
      </tr>
      <tr>
        <td>3.51.1025.1 </td>
        <td>2FC3AE99 (25th May 1995) </td>
        <td>307,088 </td>
        <td>Windows NT 3.51 </td>
      </tr>
      <tr>
        <td>3.51.1057.3 </td>
        <td>3061C531 (21st September 1995) </td>
        <td>307,088 </td>
        <td>Windows NT 3.51 SP2 <br>
        Windows NT 3.51 SP3 </td>
      </tr>
      <tr>
        <td>3.51.1057.4 </td>
        <td>30D0DB93 (14th December 1995) </td>
        <td>307,088 </td>
        <td>Windows NT 3.51 SP4 </td>
      </tr>
      <tr>
        <td>3.51.1057.6 </td>
        <td>3214F49D (17th August 1996) </td>
        <td>307,088 </td>
        <td>Windows NT 3.51 SP5 </td>
      </tr>
      <tr>
        <td>4.0.0.950 </td>
        <td>2FF36CC2 (30th June 1995) </td>
        <td>5,632 </td>
        <td>Windows 95 <br>
        Windows 95 OSR2 </td>
      </tr>
      <tr>
        <td>4.0.1376.1 </td>
        <td>31F3C73E (23rd July 1996) </td>
        <td>353,552 </td>
        <td>Windows NT 4.0 </td>
      </tr>
      <tr>
        <td>4.0.1381.3 </td>
        <td>329F4942 (29th November 1996) </td>
        <td>355,088 </td>
        <td>Windows NT 4.0 SP2 </td>
      </tr>
      <tr>
        <td>4.0.1381.4 </td>
        <td>334EA15A (12th April 1997) </td>
        <td>355,088 </td>
        <td>Windows NT 4.0 SP3 </td>
      </tr>
      <tr>
        <td>4.0.1381.130 </td>
        <td>361D3EA2 (9th October 1998) </td>
        <td>355,600 </td>
        <td>Windows NT 4.0 SP4 </td>
      </tr>
      <tr>
        <td>4.0.1381.174 </td>
        <td>36D5E9A4 (26th February 1999) </td>
        <td>363,792 </td>
        <td>Windows NT 4.0 SP5 </td>
      </tr>
      <tr>
        <td>4.0.1381.298 </td>
        <td>3786600B (10th July 1999) </td>
        <td>366,864 </td>
        <td>Windows NT 4.0 SP6 </td>
      </tr>
      <tr>
        <td>4.10.0.1998 </td>
        <td>3546AB93 (29th April 1998) </td>
        <td>20,480 </td>
        <td>Windows 98 <br>
        Windows 98 SE </td>
      </tr>
      <tr>
        <td>4.90.0.3000 </td>
        <td>39403BE1 (9th June 2000) </td>
        <td>20,480 </td>
        <td>Windows Me </td>
      </tr>
      <tr>
        <td>5.0.2163.1 </td>
        <td>38175B30 (28th October 1999) </td>
        <td>481,040 </td>
        <td>Windows 2000 </td>
      </tr>
      <tr>
        <td>5.0.2195.1600 </td>
        <td>394193D2 (10th June 2000) </td>
        <td>486,672 </td>
        <td>Windows 2000 SP1 </td>
      </tr>
      <tr>
        <td>5.0.2195.5400 </td>
        <td>3D3D0209 (23rd July 2002) </td>
        <td>490,768 </td>
        <td>Windows 2000 SP3 </td>
      </tr>
      <tr>
        <td>5.0.2195.6685 </td>
        <td>3EF274DC (20th June 2003) </td>
        <td>491,792 </td>
        <td>Windows 2000 SP4 </td>
      </tr>
      <tr>
        <td>5.1.2600.0 </td>
        <td>3B7DE01E (18th August 2001) </td>
        <td>674,304 </td>
        <td>Windows XP </td>
      </tr>
      <tr>
        <td>5.1.2600.1106 </td>
        <td>3D6DFA28 (29th August 2002) </td>
        <td>668,672 </td>
        <td>Windows XP SP1 </td>
      </tr>
      <tr>
        <td>5.1.2600.2180 </td>
        <td>411096B4 (4th August 2004) </td>
        <td>708,096 </td>
        <td>Windows XP SP2 </td>
      </tr>
      <tr>
        <td>5.1.2600.5512 </td>
        <td>4802A12C (14th April 2008) </td>
        <td>706,048 </td>
        <td>Windows XP SP3 </td>
      </tr>
      <tr>
        <td>5.2.3790.0 </td>
        <td>3E802494 (25th March 2003) </td>
        <td>739,840 </td>
        <td>Windows Server 2003 </td>
      </tr>
      <tr>
        <td>5.2.3790.1830 </td>
        <td>424377D2 (25th March 2005) </td>
        <td>766,464 </td>
        <td>Windows Server 2003 SP1 </td>
      </tr>
      <tr>
        <td>5.2.3790.3959 </td>
        <td>45D70AD8 (18th February 2007) </td>
        <td>765,440 </td>
        <td>Windows Server 2003 SP2 </td>
      </tr>
      <tr>
        <td>6.0.6000.16386 </td>
        <td>4549BDC9 (2nd November 2006) </td>
        <td>1,162,656 </td>
        <td>Windows Vista </td>
      </tr>
      <tr>
        <td>6.0.6001.18000 </td>
        <td>4791A7A6 (19th January 2008) </td>
        <td>1,203,792 </td>
        <td>Windows Vista SP1 <br>
        Windows Server 2008 </td>
      </tr>
      <tr>
        <td>6.0.6002.18005 </td>
        <td>49E03821 (11th April 2009) </td>
        <td>1,202,168 </td>
        <td>Windows Vista SP2 </td>
      </tr>
      <tr>
        <td>6.1.7600.16385 </td>
        <td>4A5BDADB (14th July 2009) </td>
        <td>1,286,144 </td>
        <td>Windows 7 </td>
      </tr>
      <tr>
        <td>6.1.7601.17514 </td>
        <td>4CE7B96E (20th November 2010) </td>
        <td>1,288,488 </td>
        <td>Windows 7 SP1 </td>
      </tr>
      <tr>
        <td>6.2.9200.16384 </td>
        <td>5010AEB6 (25th July 2012) </td>
        <td>1,472,896 </td>
        <td>Windows 8 </td>
      </tr>
      <tr>
        <td>6.3.9600.16384 </td>
        <td>52159006 (22nd August 2013) </td>
        <td>1,445,728 </td>
        <td>Windows 8.1 </td>
      </tr>
      <tr>
        <td>6.3.9600.17031 </td>
        <td>53088928 (22nd February 2014) </td>
        <td>1,451,392 </td>
        <td>Windows 8.1 With Update </td>
      </tr>
      <tr>
        <td>10.0.10240.16384 </td>
        <td>559F3AAC (9th July 2015) </td>
        <td>1,535,576 </td>
        <td>Windows 10 </td>
      </tr>
    </tbody>
  </table>
  <p>Where packages are listed on the same row, the binaries are exactly identical, 
  except as noted in the next two paragraphs which anyway apply only to the Windows 
  that runs on DOS. </p>
  <p>For the two Windows 95 versions (original and OSR2) and the two Windows 98 
  versions (original and SE), the only difference between the binaries in each pair 
  is that the later is built with newer import libraries for some DLLs, so that 
  each executable has a slightly different Import Address Table and a different 
  checksum in the executable’s header. </p>
  <p>The build for Windows Me differs from the two for Windows 98 only by a change 
  of version number and by rebasing, both for the executable itself and for imported 
  addresses, with a corresponding change in the file header’s date stamp and checksum.
  </p>
  <p>Among the gaps in service packs for early versions, note for definiteness that 
  a Windows NT 4.0 SP1 and a Windows 2000 SP2 have been obtained for inspection 
  but do not contain an NTDLL.DLL. </p>
  <h3>64-Bit Windows (amd64) </h3>
  <!--webbot bot="Include" U-Include="../../_include/builds64.htm" TAG="BODY" startspan -->

<p>Microsoft’s distribution of 64-bit Windows on MSDN discs in the early years was 
even less reliable than was my renewal of subscriptions. I seem never to have received 
a 64-bit edition of Windows XP, which is therefore not included in this study. (I 
suspect anyway that it was a build of version 5.2, i.e., of Windows Server 2003, 
rebadged for better marketing.) Though correspondents tell me that 64-bit Windows 
Vista was readily available the moment that Windows Vista was released, my experience 
is instead that a year-long MSDN subscription in 2007 produced no x64 build of the 
original Windows Vista. The copy inspected of that is instead from an OEM disc. </p>
<p>Though all service-pack builds that have been inspected for this study have been 
available through MSDN subscriptions, some of the copies studied have instead been 
downloaded as self-extracting executables from Microsoft’s free websites since, 
for who knows what reason, it frequently happened that the MSDN site that I paid 
to access was intolerably slow—not that my tolerance was high, especially while 
Microsoft was at the time not just leaving me to the tedium of burning disks and 
labelling them, but telling me that their purpose was to be environmentally friendly.
</p>

<!--webbot bot="Include" endspan i-checksum="3228" -->
  <table class="FileVersions">
    <colgroup>
      <col class="Version"><col class="Date"><col class="Size">
      <col class="Package">
    </colgroup>
    <thead>
      <tr>
        <th>File Version </th>
        <th>File Header Date Stamp </th>
        <th>File Size </th>
        <th>Package </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>5.2.3790.1830 </td>
        <td>42438B79 (25th March 2005) </td>
        <td>1,257,472 </td>
        <td>Windows Server 2003 SP1 </td>
      </tr>
      <tr>
        <td>5.2.3790.3959 </td>
        <td>45D6CC72 (17th February 2007) </td>
        <td>1,254,400 </td>
        <td>Windows Server 2003 SP2 </td>
      </tr>
      <tr>
        <td>6.0.6000.16386 </td>
        <td>4549D372 (2nd November 2006) </td>
        <td>1,533,992 </td>
        <td>Windows Vista </td>
      </tr>
      <tr>
        <td>6.0.6001.18000 </td>
        <td>4791ADEC (19th January 2008) </td>
        <td>1,559,696 </td>
        <td>Windows Vista SP1 <br>
        Windows Server 2008 </td>
      </tr>
      <tr>
        <td>6.0.6002.18005 </td>
        <td>49E0421D (11th April 2009) </td>
        <td>1,582,792 </td>
        <td>Windows Vista SP2 </td>
      </tr>
      <tr>
        <td>6.1.7600.16385 </td>
        <td>4A5BE02B (14th July 2009) </td>
        <td>1,736,792 </td>
        <td>Windows 7 <br>
        Windows Server 2008 R2 </td>
      </tr>
      <tr>
        <td>6.1.7601.17514 </td>
        <td>4CE7C8F9 (20th November 2010) </td>
        <td>1,731,936 </td>
        <td>Windows 7 SP1 <br>
        Windows Server 2008 R2 SP1 </td>
      </tr>
      <tr>
        <td>6.2.9200.16384 </td>
        <td>5010ACD2 (25th July 2012) </td>
        <td>1,825,216 </td>
        <td>Windows 8 </td>
      </tr>
      <tr>
        <td>6.3.9600.16384 </td>
        <td>5215F938 (22nd August 2013) </td>
        <td>1,722,608 </td>
        <td>Windows 8.1 </td>
      </tr>
      <tr>
        <td>6.3.9600.17031 </td>
        <td>530895AF (22nd February 2014) </td>
        <td>1,727,760 </td>
        <td>Windows 8.1 With Update </td>
      </tr>
      <tr>
        <td>10.0.10240.16384 </td>
        <td>559F384F (9th July 2015) </td>
        <td>1,822,832 </td>
        <td>Windows 10 </td>
      </tr>
    </tbody>
  </table>
  <p>Where two packages are shown for the same build, the executables are identical. 
  This identity is formalised for Windows 7 SP1 and Windows Server 2008 R2 SP1 since 
  Microsoft provides the one self-extracting executable for both product names.
  </p>
  <h3>32-Bit Windows on 64-Bit Windows (wow64) </h3>
  <p>NTDLL is sufficiently low-level that its 32-bit executables for 64-bit Windows 
  differ from those of the corresponding 32-bit Windows versions. </p>
  <table class="FileVersions">
    <colgroup>
      <col class="Version"><col class="Date"><col class="Size">
      <col class="Package">
    </colgroup>
    <thead>
      <tr>
        <th>File Version </th>
        <th>File Header Date Stamp </th>
        <th>File Size </th>
        <th>Package </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>5.2.3790.1830 </td>
        <td>42437794 (25th March 2005) </td>
        <td>762,880 </td>
        <td>Windows Server 2003 SP1 </td>
      </tr>
      <tr>
        <td>5.2.3790.3959 </td>
        <td>45D709FF (17th February 2007) </td>
        <td>766,464 </td>
        <td>Windows Server 2003 SP2 </td>
      </tr>
      <tr>
        <td>6.0.6000.16386 </td>
        <td>4549BDF8 (2nd November 2006) </td>
        <td>1,145,664 </td>
        <td>Windows Vista </td>
      </tr>
      <tr>
        <td>6.0.6001.18000 </td>
        <td>4791A783 (19th January 2008) </td>
        <td>1,165,688 </td>
        <td>Windows Vista SP1 <br>
        Windows Server 2008 </td>
      </tr>
      <tr>
        <td>6.0.6002.18005 </td>
        <td>49E03824 (11th April 2009) </td>
        <td>1,165,088 </td>
        <td>Windows Vista SP2 </td>
      </tr>
      <tr>
        <td>6.1.7600.16385 </td>
        <td>4A5BDB3B (14th July 2009) </td>
        <td>1,289,712 </td>
        <td>Windows 7 <br>
        Windows Server 2008 R2 </td>
      </tr>
      <tr>
        <td>6.1.7601.17514 </td>
        <td>4CE7BA58 (20th November 2010) </td>
        <td>1,292,096 </td>
        <td>Windows 7 <br>
        Windows Server 2008 R2 SP1 </td>
      </tr>
      <tr>
        <td>6.2.9200.16384 </td>
        <td>5010AE7A (25th July 2012) </td>
        <td>1,409,384 </td>
        <td>Windows 8 </td>
      </tr>
      <tr>
        <td>6.3.9600.16384 </td>
        <td>52159015 (22nd August 2013) </td>
        <td>1,471,544 </td>
        <td>Windows 8.1 </td>
      </tr>
      <tr>
        <td>6.3.9600.17031 </td>
        <td>5308893D (22nd February 2014) </td>
        <td>1,474,104 </td>
        <td>Windows 8.1 With Update </td>
      </tr>
      <tr>
        <td>10.0.10240.16384 </td>
        <td>559F3AAB (9th July 2015) </td>
        <td>1,533,496 </td>
        <td>Windows 10 </td>
      </tr>
    </tbody>
  </table>
  <p>Where two packages are shown for the same build, the executables are identical.
  </p>
  <div class="Footer">
    <p class="Dates">This page was created on 7th October 2008 and was last modified 
    on 21st May 2022. </p>
    <!--webbot bot="Include" U-Include="../../_include/c0819.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2008-2019. Geoff Chappell. All rights reserved. 
<a href="../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="5611" -->
  </div>
</div>

</body>

</html>
