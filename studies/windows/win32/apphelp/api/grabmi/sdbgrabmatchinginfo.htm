<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SdbGrabMatchingInfo</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/win32.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/win32.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell, Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="54033" -->
<h1>SdbGrabMatchingInfo </h1>
<!--webbot bot="Include" U-Include="_include/description.htm" TAG="BODY" startspan -->

<p>This function collects into an XML file various sorts of information about files 
that seem related to a given executable. The intended use seems to be that the executable 
needs a patch, shim or similar support in particular circumstances and the collected 
descriptions of the related files, or some extract from them, can help those circumstances 
be recognised later (and elsewhere) by the presence of so-called
<span class="definition">matching files</span>. </p>

<!--webbot bot="Include" endspan i-checksum="26035" -->
<h2>Declaration </h2>
<pre class="source">BOOL 
SdbGrabMatchingInfo (
    PCWSTR szExe, 
    DWORD dwFilter, 
    PCWSTR szFile);</pre>
<h3>Parameters </h3>
<!--webbot bot="Include" U-Include="_include/parameters.htm" TAG="BODY" startspan -->

<p>The <span class="argument">szExe</span> argument addresses a pathname of a file-system 
object, such as an executable file, and the function is to collect information about 
the matching files in the same directory and (typically) beneath. The pathname can 
instead specify just the directory. Depending on other arguments,
<span class="argument">szExe</span> can be ignored. </p>
<p>The low 16 bits of the <span class="argument">dwFilter</span> argument define 
what type of files count as matching files, what type of information to collect, 
and may even define where to look (overriding <span class="argument">szExe</span>). 
The high 16 bits of <span class="argument">dwFilter</span> are bit flags that can 
more generally vary the function’s behaviour, e.g., to stop the search’s recursion 
through subdirectories, and to arrange for the one output file to collect descriptions 
from multiple calls to the function. The types and flags that are supported for 
the <a href="filter.htm">Matching Information Filter</a> are described separately.
</p>
<p>The <span class="argument">szFile</span> argument names the output file. </p>

<!--webbot bot="Include" endspan i-checksum="25264" -->
<h3>Return Value </h3>
<p>The function returns <span class="constant">TRUE</span> or
<span class="constant">FALSE</span> for success or failure, respectively. </p>
<h2>Availability </h2>
<p>The <span class="function">SdbGrabMatchingInfo</span> function is exported by 
name from APPHELP.DLL in version 5.1 and higher, and before then from SDBAPIU.DLL.
</p>
<h2>Documentation Status </h2>
<p>The <span class="function">SdbGrabMatchingInfo</span> function is not documented.
</p>
<!--webbot bot="Include" U-Include="_include/names.htm" TAG="BODY" startspan -->

<p>The names given above for the <span class="argument">dwFilter</span> and
<span class="argument">szFile</span> arguments are plausibly Microsoft’s, being 
extracted from text that APPHELP can write to a log file. Other names are mere placeholders 
awaiting the discovery of Microsoft’s. </p>

<!--webbot bot="Include" endspan i-checksum="42598" -->
<h3>Use by Microsoft </h3>
<p>This is not a function that has many callers. In some sense,
<span class="function">SdbGrabMatchingInfo</span> is about as obscure as any function 
can be except by not being used at all. Yet its output is known to anyone who has 
ever looked at the files that Windows Error Reporting (WER) would upload to Microsoft 
to describe a problem. Among those files nowadays is one named appcompat.txt, and 
it is created by APPHLPDM.DLL or PCWUTL.DLL calling <span class="function">SdbGrabMatchingInfo</span> 
for descriptions of 25 executables (including DLLs) from the same directory as the 
faulting application. </p>
<h2>Behaviour </h2>
<p>This function is implemented as <span class="function">
<a href="sdbgrabmatchinginfoex.htm">SdbGrabMatchingInfoEx</a></span> with no callback 
function. </p>
<div class="Footer">
  <p class="Dates">This page was created on 3rd 
  <a href="../../../../../../new/16/09.htm">September 2016</a> and was last modified 
  on 27th October 2016. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c16.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2016. Geoff Chappell. All rights reserved. 
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="62549" -->
</div>

</body>

</html>
