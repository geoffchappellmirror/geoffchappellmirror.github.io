<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SYSTEM_OBJECT_INFORMATION</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <h1>SYSTEM_OBJECT_INFORMATION </h1>
  <p>The <span class="struct">SYSTEM_OBJECT_INFORMATION</span> structure 
  (formally <span class="struct">_SYSTEM_OBJECT_INFORMATION</span>) is an irregularly 
  recurring element in what a successful call to <span class="function">
  <a href="../../../api/ex/sysinfo/query.htm">ZwQuerySystemInformation</a></span> 
  or <span class="function">NtQuerySystemInformation</span> produces in its output 
  buffer when given the information class <span class="constant">SystemObjectInformation</span> 
  (0x11). The output begins with a <span class="struct">
  <a href="system_objecttype_information.htm">SYSTEM_OBJECTTYPE_INFORMATION</a></span>. 
  There can be, and typically are, more of these throughout the buffer, but irregularly 
  because each can be followed by any number of <span class="struct">SYSTEM_OBJECT_INFORMATION</span> 
  structures. These too are irregularly spaced because although each is fixed in 
  size, each is followed in turn by a variable-size Unicode string. </p>
  <h2>Documentation Status </h2>
  <p>The <span class="struct">SYSTEM_OBJECT_INFORMATION</span> structure is not 
  documented. </p>
  <!--webbot bot="Include" U-Include="../_include/type_info_urlmon.htm" TAG="BODY" startspan -->

<p>Microsoft does publish the practical equivalent of a C-language definition as 
type information in symbol files—not for the kernel, where the structure is prepared, 
nor even for low-level user-mode DLLs that interpret the structure, but for a handful 
of higher-level DLLs that might ordinarily be thought very distant from any involvement 
with the structure. Perhaps only by oversight, but starting as long ago as Windows 
8, Microsoft’s downloadable packages of public symbols have included a smattering 
of private symbol files and these continue to be available through the public symbol 
server. Precisely which DLLs have the type information varies between versions. 
COMBASE.DLL is among the more reliable nowadays. Disclosure in symbol files for 
URLMON.DLL stopped for the 1803 release of Windows 10 but is specially notable 
because of this DLL’s origins in Internet Explorer and thence for the strong suggestion 
that Microsoft’s programmers of Internet Explorer had access to more details of 
low-level Windows programming than Microsoft publishes for wider use (including 
by the programmers of competing web browsers). </p>

<!--webbot bot="Include" endspan i-checksum="12783" -->
  <!--webbot bot="Include" U-Include="../_include/type_info_ddklibs.htm" TAG="BODY" startspan -->

<p>Type information for the structure has also seeped out at the other end of the 
Windows timeline, though not in symbol files but in statically linked libraries: 
GDISRVL.LIB from the Device Driver Kit (DDK) for Windows NT 3.51; and SHELL32.LIB 
from the DDK for Windows NT 4.0. </p>

<!--webbot bot="Include" endspan i-checksum="3859" -->
  <h2>Layout </h2>
  <p>The <span class="struct">SYSTEM_OBJECT_INFORMATION</span> is 0x30 or 0x50 bytes 
  in 32-bit and 64-bit Windows, respectively. </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition"><col class="Versions">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00 </td>
        <td>0x00 </td>
        <td>
        <pre class="source">ULONG NextEntryOffset;</pre>
        </td>
        <td>
        all </td>
      </tr>
      <tr>
        <td>0x04 </td>
        <td>0x08 </td>
        <td>
        <pre class="source">PVOID Object;</pre>
        </td>
        <td>
        all </td>
      </tr>
      <tr>
        <td>0x08 </td>
        <td>0x10 </td>
        <td>
        <pre class="source">PVOID CreatorUniqueProcess;</pre>
        </td>
        <td>
        all </td>
      </tr>
      <tr>
        <td>0x0C </td>
        <td>0x18 </td>
        <td>
        <pre class="source">USHORT CreatorBackTraceIndex;</pre>
        </td>
        <td>
        3.50 and higher </td>
      </tr>
      <tr>
        <td rowspan="2">0x0C (3.10); <br>
        0x0E </td>
        <td rowspan="2">0x1A </td>
        <td>
        <pre class="source">ULONG Flags;</pre>
        </td>
        <td>
        3.10 only </td>
      </tr>
      <tr>
        <td>
        <pre class="source">USHORT Flags;</pre>
        </td>
        <td>
        3.50 and higher </td>
      </tr>
      <tr>
        <td>0x10 </td>
        <td>0x1C </td>
        <td>
        <pre class="source">LONG PointerCount;</pre>
        </td>
        <td>
        all </td>
      </tr>
      <tr>
        <td>0x14 </td>
        <td>0x20 </td>
        <td>
        <pre class="source">LONG HandleCount;</pre>
        </td>
        <td>
        all </td>
      </tr>
      <tr>
        <td>0x18 </td>
        <td>0x24 </td>
        <td>
        <pre class="source">ULONG PagedPoolCharge;</pre>
        </td>
        <td>
        all </td>
      </tr>
      <tr>
        <td>0x1C </td>
        <td>0x28 </td>
        <td>
        <pre class="source">ULONG NonPagedPoolCharge;</pre>
        </td>
        <td>
        all </td>
      </tr>
      <tr>
        <td>0x20 </td>
        <td>0x30 </td>
        <td>
        <pre class="source">PVOID ExclusiveProcessId;</pre>
        </td>
        <td>
        all </td>
      </tr>
      <tr>
        <td rowspan="2">0x24 </td>
        <td rowspan="2">0x38 </td>
        <td>
        unknown dword
        </td>
        <td>
        3.10 only </td>
      </tr>
      <tr>
        <td>
        <pre class="source">PVOID SecurityDescriptor;</pre>
        </td>
        <td>
        3.50 and higher </td>
      </tr>
      <tr>
        <td>0x28 </td>
        <td>0x40 </td>
        <td>
        <pre class="source">OBJECT_NAME_INFORMATION NameInfo;</pre>
        </td>
        <td>
        all </td>
      </tr>
    </tbody>
  </table>
  <div class="Footer">
    <p class="Dates">This page was created on 9th July 2016 but was not published 
    until 25th <a href="../../../../../../../new/16/10.htm">October 2016</a>. It 
    was last modified on 30th August 2022. </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c1622.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2016-2022. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="4925" --></div>
</div>

</body>

</html>
