<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>The #import Directive</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/msvc.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/msvc.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="35843" endspan -->
<h1>The #import Directive </h1>
<h2>Syntax </h2>
<blockquote>
  <p><span class="directive">#import &quot;</span><span class="placeholder">filename</span><span class="directive">&quot;
  </span>[<span class="placeholder">attributes</span>] </p>
  <p><span class="directive">#import &lt;</span><span class="placeholder">filename</span><span class="directive">&gt;
  </span>[<span class="placeholder">attributes</span>] </p>
</blockquote>
<p>The <span class="placeholder">filename</span> is enclosed in either 
double-quotes or angle-brackets (i.e., a less-than sign before and a 
greater-than sign after). The choice has a significance described below. </p>
<p>Within its enclosure, the <span class="placeholder">filename</span> has a 
complex syntax, not least because it need not actually name a file, not 
directly. In the forms </p>
<blockquote>
  <p><span class="directive">file: </span><span class="placeholder">file</span>
  </p>
  <p><span class="directive">libid: </span><span class="placeholder">libid</span>
  </p>
  <p><span class="directive">progid: </span><span class="placeholder">progid</span>
  </p>
</blockquote>
<p>the prefix is case insensitive and may be followed by any amount of white 
space, including none, before the <span class="placeholder">file</span>,
<span class="placeholder">libid</span> or <span class="placeholder">progid</span>.
</p>
<h2>Attributes </h2>
<p>In the following list of syntactically valid attributes for the
<span class="directive">#import</span> directive in Microsoft Visual C++ version 
13.00.9466, those that the product documentation omits from the list of
<span class="citation">#import Attributes</span> on the page titled
<span class="citation">The #import Directive</span> are highlighted yellow. </p>
<p>Some of the product documentation’s omissions are clearly accidents: for 
instance,
<span class="attribute">lcid</span> and <span class="attribute">version</span> 
are shown in two examples on that same page, despite being then omitted from the 
list. Some are just as plainly deliberate: for instance, it is nothing but 
consistent that <span class="attribute">function_mapping</span> should be 
undocumented, given its relationship to other undocumented constructions such as
<span class="directive">#pragma start_map_region</span>. </p>
<ul>
  <li><span class="undocumented attribute"><a href="auto_rename.htm">auto_rename</a></span>
  </li>
  <li><span class="undocumented attribute"><a href="auto_search.htm">auto_search</a></span>
  </li>
  <li><span class="undocumented attribute"><a href="demand_load.htm">demand_load</a></span>
  </li>
  <li><span class="undocumented attribute"><a href="dual_interfaces.htm">
  dual_interfaces</a></span>
  </li>
  <li><span class="attribute"><a href="embedded_idl.htm">embedded_idl</a></span>
  </li>
  <li><span class="attribute"><a href="exclude.htm">exclude</a></span> </li>
  <li><span class="undocumented attribute"><a href="function_mapping.htm">
  function_mapping</a></span>
  </li>
  <li><span class="undocumented attribute"><a href="guess_ptrsize.htm">
  guess_ptrsize</a></span>
  </li>
  <li><span class="attribute"><a href="high_method_prefix.htm">
  high_method_prefix</a></span>
  </li>
  <li><span class="attribute"><a href="high_property_prefixes.htm">
  high_property_prefixes</a></span>
  </li>
  <li><span class="attribute"><a href="implementation_only.htm">
  implementation_only</a></span>
  </li>
  <li><span class="attribute"><a href="include.htm">include</a></span> </li>
  <li><span class="attribute"><a href="inject_statement.htm">inject_statement</a></span>
  </li>
  <li><span class="undocumented attribute"><a href="lcid.htm">lcid</a></span>
  </li>
  <li><span class="attribute"><a href="named_guids.htm">named_guids</a></span>
  </li>
  <li><span class="attribute"><a href="no_auto_exclude.htm">no_auto_exclude</a></span>
  </li>
  <li><span class="attribute"><a href="no_dual_interfaces.htm">
  no_dual_interfaces</a></span>
  </li>
  <li><span class="undocumented attribute"><a href="no_function_mapping.htm">
  no_function_mapping</a></span>
  </li>
  <li><span class="attribute"><a href="no_implementation.htm">no_implementation</a></span>
  </li>
  <li><span class="attribute"><a href="no_namespace.htm">no_namespace</a></span>
  </li>
  <li><span class="undocumented attribute"><a href="no_search_namespace.htm">
  no_search_namespace</a></span>
  </li>
  <li><span class="attribute"><a href="no_smart_pointers.htm">no_smart_pointers</a></span>
  </li>
  <li><span class="undocumented attribute"><a href="ptrsize.htm">ptrsize</a></span>
  </li>
  <li><span class="attribute"><a href="raw_dispinterfaces.htm">
  raw_dispinterfaces</a></span>
  </li>
  <li><span class="attribute"><a href="raw_interfaces_only.htm">
  raw_interfaces_only</a></span>
  </li>
  <li><span class="attribute"><a href="raw_method_prefix.htm">raw_method_prefix</a></span>
  </li>
  <li><span class="attribute"><a href="raw_native_types.htm">raw_native_types</a></span>
  </li>
  <li><span class="attribute"><a href="raw_property_prefixes.htm">
  raw_property_prefixes</a></span>
  </li>
  <li><span class="attribute"><a href="rename.htm">rename</a></span> </li>
  <li><span class="attribute"><a href="rename_namespace.htm">rename_namespace</a></span>
  </li>
  <li><span class="undocumented attribute">
  <a href="rename_search_namespace.htm">rename_search_namespace</a></span> </li>
  <li><span class="undocumented attribute"><a href="tlbid.htm">tlbid</a></span>
  </li>
  <li><span class="undocumented attribute"><a href="version.htm">version</a></span>
  </li>
</ul>
<p>Anything else causes a warning (C4185) about being an unknown
<span class="directive">#import</span> attribute. Failure to supply the expected 
number of arguments for an attribute, including to supply arguments when none 
are expected, causes a warning (C4186). </p>
<p>Some attributes form incompatible pairs:</p>
<ul>
  <li><span class="attribute">dual_interfaces</span> and <span class="attribute">
  no_dual_interfaces</span> </li>
  <li><span class="attribute">function_mapping</span> and
  <span class="attribute">no_function_mapping</span> </li>
  <li><span class="attribute">implementation_only</span> and
  <span class="attribute">no_implementation</span>. </li>
</ul>
<p>To give both of a pair causes a warning (C4187). </p>
<div class="Footer">
  <!--webbot bot="Include" U-Include="../../../../_include/c0610.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2006-2010. Geoff Chappell. All rights reserved.
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="4055" endspan -->
</div>

</body>

</html>