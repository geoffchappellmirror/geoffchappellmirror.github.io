<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SHPropertyBag_ReadGUID</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js">
</script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>SHPropertyBag_ReadGUID </h1>
<p>This function asks a property bag to read a named property as a GUID. </p>
<h2>Declaration </h2>
<pre class="source">HRESULT
SHPropertyBag_ReadGUID (
    IPropertyBag *ppb,
    LPCWSTR pszPropName,
    LPGUID pGuid);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">ppb</span> argument provides the address of an
<span class="interface">IPropertyBag</span> interface. </p>
<p>The <span class="argument">pszPropName</span> argument provides the address 
of a null-terminated Unicode string that names the property. </p>
<p>The <span class="argument">pGuid</span> argument provides the address of a 
16-byte buffer that is to receive the property value as a GUID. </p>
<h3>Return Value </h3>
<!--webbot bot="Include" U-Include="../_include/hresult.htm" TAG="BODY" startspan -->

<p>The function returns zero for success, else an error code. </p>

<!--webbot bot="Include" i-checksum="1551" endspan -->
<h2>Behaviour </h2>
<p>If any of the <span class="argument">ppb</span>, <span class="argument">
pszPropName</span> 
and <span class="argument">pszBuffer</span> arguments are NULL, the function 
fails, with <span class="constant">E_INVALIDARG</span> as the error code. If the 
function cannot read the named property as a <span class="constant">VT_EMPTY</span> 
type (using <span class="function"><a href="readtype.htm">SHPropertyBag_ReadType</a></span>), 
it fails. </p>
<p>If the value is obtained as an array of <span class="constant">VT_UI1</span> 
types, then the function copies the first 16 bytes of the array as the GUID 
(without checking that the array has as many as 16 bytes). If the value is 
obtained as a
<span class="constant">VT_BSTR</span> type, the function attempts to convert 
from the usual string representation in braces. If the string is not in this 
form, the function fails, with <span class="constant">E_FAIL</span> as the error 
code. If the value is obtained as any other type, the function succeeds, but 
without obtaining a GUID. </p>
<h2>Availability </h2>
<p>The <span class="function">SHPropertyBag_ReadGUID</span> function is exported 
from SHLWAPI as ordinal 505 in version 6.00. </p>
<!--webbot bot="Include" U-Include="../_include/undoc600.htm" TAG="BODY" startspan -->

<p>Though this function dates from 2001, it was still not documented by 
Microsoft in the MSDN Library at least as late as the CD edition dated January 
2004. </p>

<!--webbot bot="Include" i-checksum="12777" endspan -->
<div class="Footer">
  <p class="Dates">This page was created on 29th September 2004 and was last 
  modified on 15th March 2007. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c0407.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2004-2007. Geoff Chappell. All rights reserved. 
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="54855" endspan -->
</div>

</body>

</html>