<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>POP_POWER_ACTION</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <h1>POP_POWER_ACTION </h1>
  <p>The <span class="struct">POP_POWER_ACTION</span> structure (formally
  <span class="struct">_POP_POWER_ACTION</span>) is the type of the kernel’s internal 
  variable <span class="internal variable">PopAction</span>. This can be helpful 
  to know when debugging problems with power management. </p>
  <h2>Documentation Status </h2>
  <p>As merely the type of an internal variable, the <span class="struct">POP_POWER_ACTION</span> 
  is not documented. </p>
  <h2>Variability </h2>
  <p>Also because the <span class="struct">POP_POWER_ACTION</span> is used only 
  as the type of a variable that the kernel does not expose even to other kernel-mode 
  software, it is highly susceptible to changing between builds: </p>
  <table class="Sizes">
    <colgroup>
      <col class="Version"><col class="Size" span="2">
    </colgroup>
    <thead>
      <tr>
        <th>Version </th>
        <th>Size (x86) </th>
        <th>Size (x64) </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>5.0 </td>
        <td>0x38 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>5.1 to 5.2 </td>
        <td>0x40 </td>
        <td>0x50 </td>
      </tr>
      <tr>
        <td>6.0 </td>
        <td>0xA0 </td>
        <td>0xB0 </td>
      </tr>
      <tr>
        <td>6.1 </td>
        <td>0xB0 </td>
        <td>0xC0 </td>
      </tr>
      <tr>
        <td>6.2 to 6.3 </td>
        <td>0xD8 </td>
        <td>0xE0 </td>
      </tr>
      <tr>
        <td>10.0 </td>
        <td>0x0100 </td>
        <td>0x0108 </td>
      </tr>
      <tr>
        <td>1511 to 1703 </td>
        <td>0x0108 </td>
        <td>0x0110 </td>
      </tr>
      <tr>
        <td>1709 to 1809 </td>
        <td>0x0110 </td>
        <td>0x0118 </td>
      </tr>
      <tr>
        <td>1903 </td>
        <td>0x0178 </td>
        <td>0x01C0 </td>
      </tr>
      <tr>
        <td>2004 </td>
        <td>0x0178 </td>
        <td>0x01C8 </td>
      </tr>
    </tbody>
  </table>
  <h2>Layout </h2>
  <p>The sizes in the preceding table and the offsets, names and types in the next 
  are from type information in public symbol files for the kernel, starting with 
  Windows XP. What’s known of it for Windows 2000 is inferred from comparing this 
  version’s use of the <span class="internal variable">PopAction</span> variable 
  with that of later versions. </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00 </td>
        <td>0x00 </td>
        <td>
        <pre class="source">UCHAR Updates;</pre>
        </td>
        <td>5.0 and higher </td>
      </tr>
      <tr>
        <td>0x01 </td>
        <td>0x01 </td>
        <td>
        <pre class="source">UCHAR State;</pre>
        </td>
        <td>5.0 and higher </td>
      </tr>
      <tr>
        <td>0x02 </td>
        <td>0x02 </td>
        <td>
        <pre class="source">UCHAR Shutdown;</pre>
        </td>
        <td>5.0 and higher </td>
      </tr>
      <tr>
        <td>0x04 </td>
        <td>0x04 </td>
        <td>
        <pre class="source">POWER_ACTION Action;</pre>
        </td>
        <td>5.0 and higher </td>
      </tr>
      <tr>
        <td>0x08 </td>
        <td>0x08 </td>
        <td>
        <pre class="source">SYSTEM_POWER_STATE LightestState;</pre>
        </td>
        <td>5.0 and higher </td>
      </tr>
      <tr>
        <td>0x0C </td>
        <td>0x0C </td>
        <td>
        <pre class="source">ULONG Flags;</pre>
        </td>
        <td>5.0 and higher </td>
      </tr>
      <tr>
        <td>0x10 </td>
        <td>0x10 </td>
        <td>
        <pre class="source">NTSTATUS Status;</pre>
        </td>
        <td>5.0 and higher </td>
      </tr>
      <tr>
        <td>0x14 </td>
        <td>0x14 </td>
        <td>
        <pre class="source">POWER_POLICY_DEVICE_TYPE DeviceType;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x18 </td>
        <td>0x18 </td>
        <td>
        <pre class="source">ULONG DeviceTypeFlags;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x14 (5.1 to 5.2); <br>
        0x1C </td>
        <td>0x14 (5.1 to 5.2); <br>
        0x1C </td>
        <td>
        <pre class="source">UCHAR IrpMinor;</pre>
        </td>
        <td>5.0 and higher </td>
      </tr>
      <tr>
        <td>0x1D </td>
        <td>0x1D </td>
        <td>
        <pre class="source">UCHAR Waking;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x18 (5.1 to 5.2); <br>
        0x20 </td>
        <td>0x18 (5.2); <br>
        0x20 </td>
        <td>
        <pre class="source">SYSTEM_POWER_STATE SystemState;</pre>
        </td>
        <td>5.0 and higher </td>
      </tr>
      <tr>
        <td>0x1C (5.1 to 5.2); <br>
        0x24 </td>
        <td>0x1C (5.2); <br>
        0x24 </td>
        <td>
        <pre class="source">SYSTEM_POWER_STATE NextSystemState;</pre>
        </td>
        <td>5.0 and higher </td>
      </tr>
      <tr>
        <td>0x28 </td>
        <td>0x28 </td>
        <td>
        <pre class="source">SYSTEM_POWER_STATE EffectiveSystemState;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x2C </td>
        <td>0x2C </td>
        <td>
        <pre class="source">SYSTEM_POWER_STATE CurrentSystemState;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x20 (5.1 to 5.2); <br>
        0x30 </td>
        <td>0x20 (5.2); <br>
        0x30 </td>
        <td>
        <pre class="source">POP_SHUTDOWN_BUG_CHECK *ShutdownBugCode;</pre>
        </td>
        <td>5.0 and higher </td>
      </tr>
      <tr>
        <td>0x24 (5.1 to 5.2); <br>
        0x34 </td>
        <td>0x28 (5.2); <br>
        0x38 </td>
        <td>
        <pre class="source">POP_DEVICE_SYS_STATE *DevState;</pre>
        </td>
        <td>5.0 and higher </td>
      </tr>
      <tr>
        <td>0x38 (6.0) </td>
        <td>0x40 (6.0) </td>
        <td>
        <pre class="source">POP_DISPLAY_RESUME_CONTEXT *DisplayResumeContext;</pre>
        </td>
        <td>6.0 only </td>
      </tr>
      <tr>
        <td>0x28 (5.1 to 5.2); <br>
        0x3C (6.0); <br>
        0x38 </td>
        <td>0x30 (5.2); <br>
        0x48 (6.0); <br>
        0x40 </td>
        <td>
        <pre class="source">POP_HIBER_CONTEXT *HiberContext;</pre>
        </td>
        <td>5.0 and higher </td>
      </tr>
      <tr>
        <td>0x2C (5.1 to 5.2) </td>
        <td>0x38 (5.2) </td>
        <td>
        <pre class="source">SYSTEM_POWER_STATE LastWakeState;</pre>
        </td>
        <td>5.0 to 5.2 </td>
      </tr>
      <tr>
        <td>0x30 (5.1 to 5.2); <br>
        0x40 </td>
        <td>0x40 (5.2); <br>
        0x50 (6.0); <br>
        0x48 </td>
        <td>
        <pre class="source">ULONGLONG WakeTime;</pre>
        </td>
        <td>5.0 and higher </td>
      </tr>
      <tr>
        <td>0x38 (5.1 to 5.2); <br>
        0x48 </td>
        <td>0x48 (5.2); <br>
        0x58 (6.0); <br>
        0x50 </td>
        <td>
        <pre class="source">ULONGLONG SleepTime;</pre>
        </td>
        <td>5.1 and higher </td>
      </tr>
      <tr>
        <td>0x50 (6.1) </td>
        <td>0x58 (6.1) </td>
        <td>
        <pre class="source">ULONGLONG ProgrammedRTCTime;</pre>
        </td>
        <td>6.1 only </td>
      </tr>
      <tr>
        <td>0x50 </td>
        <td>0x58 </td>
        <td>
        <pre class="source">ULONGLONG WakeFirstUnattendedTime;</pre>
        </td>
        <td>1511 and higher </td>
      </tr>
      <tr>
        <td rowspan="2">0x58 (6.1); <br>
        0x50 (6.2 to 10.0); <br>
        0x58 </td>
        <td rowspan="2">0x60 (6.1); <br>
        0x58 (6.2 to 10.0); <br>
        0x60 </td>
        <td>
        <pre class="source">UCHAR WakeOnRTC;</pre>
        </td>
        <td>6.1 only </td>
      </tr>
      <tr>
        <td>
        <pre class="source">SYSTEM_POWER_CONDITION WakeAlarmSignaled;</pre>
        </td>
        <td>6.2 and higher </td>
      </tr>
      <tr>
        <td rowspan="3">0x5C (6.1); <br>
        0x58 (6.2 to 10.0); <br>
        0x60 </td>
        <td rowspan="3">0x68 (6.1); <br>
        0x60 (6.2 to 10.0); <br>
        0x68 </td>
        <td>
        <pre class="source">DIAGNOSTIC_BUFFER *WakeTimerInfo;</pre>
        </td>
        <td>6.1 only </td>
      </tr>
      <tr>
        <td>
        <pre class="source">struct {
    ULONGLONG ProgrammedTime;
    DIAGNOSTIC_BUFFER *TimerInfo;
} WakeAlarm [3];</pre>
        </td>
        <td>6.2 to 6.3 </td>
      </tr>
      <tr>
        <td>
        <pre class="source">struct {
    ULONGLONG RequestedTime;
    ULONGLONG ProgrammedTime;
    DIAGNOSTIC_BUFFER *TimerInfo;
} WakeAlarm [3];</pre>
        </td>
        <td>10.0 and higher </td>
      </tr>
      <tr>
        <td>0xA0 (10.0); <br>
        0xA8 </td>
        <td>0xA8 (10.0); <br>
        0xB0 </td>
        <td>
        <pre class="source">UCHAR WakeAlarmPaused;</pre>
        </td>
        <td>10.0 and higher </td>
      </tr>
      <tr>
        <td>0xA8 (10.0); <br>
        0xB0 </td>
        <td>0xB0 (10.0); <br>
        0xB8 </td>
        <td>
        <pre class="source">ULONGLONG WakeAlarmLastTime;</pre>
        </td>
        <td>10.0 and higher </td>
      </tr>
      <tr>
        <td>0xB8 </td>
        <td>0xC0 </td>
        <td>
        <pre class="source">ULONGLONG DozeDeferralStartTime;</pre>
        </td>
        <td>1709 and higher </td>
      </tr>
      <tr>
        <td>0x50 (6.0) </td>
        <td>0x60 (6.0) </td>
        <td>
        <pre class="source">SYSTEM_POWER_STATE_CONTEXT SystemContext;</pre>
        </td>
        <td>6.0 only </td>
      </tr>
      <tr>
        <td>0x54 (6.0); <br>
        0x60 (6.1); <br>
        0x88 (6.2 to 6.3); <br>
        0xB0 (10.0); <br>
        0xB8 (1511 to 1703); <br>
        0xC0 </td>
        <td>0x64 (6.0); <br>
        0x70 (6.1); <br>
        0x90 (6.2 to 6.3); <br>
        0xB8 (10.0); <br>
        0xC0 (1511 to 1703); <br>
        0xC8 </td>
        <td>
        <pre class="source">SYSTEM_POWER_CAPABILITIES FilteredCapabilities;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x010C </td>
        <td>0x0118 </td>
        <td>
        <pre class="source">KSPIN_LOCK WatchdogLock;</pre>
        </td>
        <td>2004 and higher </td>
      </tr>
      <tr>
        <td>0x010C (1903); <br>
        0x0110 </td>
        <td>0x0118 (1903); <br>
        0x0120 </td>
        <td>
        <pre class="source">KDPC WatchdogDpc;</pre>
        </td>
        <td>1903 and higher </td>
      </tr>
      <tr>
        <td>0x0130 </td>
        <td>0x0158 (1903); <br>
        0x0160 </td>
        <td>
        <pre class="source">KTIMER WatchdogTimer;</pre>
        </td>
        <td>1903 and higher </td>
      </tr>
      <tr>
        <td>0x0158 </td>
        <td>0x0198 (1903); <br>
        0x01A0 </td>
        <td>
        <pre class="source">UCHAR WatchdogInitialized;</pre>
        </td>
        <td>1903 and higher </td>
      </tr>
      <tr>
        <td>0x015C </td>
        <td>0x019C (1903); <br>
        0x01A4 </td>
        <td>
        <pre class="source">POP_POWER_ACTION_WATCHDOG_STATE WatchdogState;</pre>
        </td>
        <td>1903 and higher </td>
      </tr>
      <tr>
        <td>0x0160 </td>
        <td>0x01A0 (1903); <br>
        0x01A8 </td>
        <td>
        <pre class="source">ULONGLONG WatchdogStartTime;</pre>
        </td>
        <td>1903 and higher </td>
      </tr>
      <tr>
        <td>0x0168 </td>
        <td>0x01A8 (1903); <br>
        0x01B0 </td>
        <td>
        <pre class="source">KTHREAD *ActionWorkerThread;</pre>
        </td>
        <td>1903 and higher </td>
      </tr>
      <tr>
        <td>0x016C </td>
        <td>0x01B0 (1903); <br>
        0x01B8 </td>
        <td>
        <pre class="source">KTHREAD *PromoteActionWorkerThread;</pre>
        </td>
        <td>1903 and higher </td>
      </tr>
      <tr>
        <td>0x0170 </td>
        <td>0x01B8 (1903); <br>
        0x01C0 </td>
        <td>
        <pre class="source">KTHREAD *UnlockAfterSleepWorkerThread;</pre>
        </td>
        <td>1903 and higher </td>
      </tr>
    </tbody>
  </table>
  <div class="Footer">
    <p class="Dates">This page was created on 15th September 2022 but was not published 
    until 17th <a href="../../../../../../../new/22/09.htm">September 2022</a>.
    </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c22.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2022. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="5890" -->
  </div>
</div>

</body>

</html>
