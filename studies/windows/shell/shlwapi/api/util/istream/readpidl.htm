<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>IStream_ReadPidl</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js">
</script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js">
</script>
<script type="text/javascript" src="../../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="14798" endspan -->
<h1>IStream_ReadPidl </h1>
<p>This function reads a PIDL from a stream. </p>
<h2>Declaration </h2>
<pre class="source">HRESULT
IStream_ReadPidl (
    IStream *pstm,
    PIDLIST_RELATIVE *ppidlOut);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">pstm</span> argument provides the address of an
<span class="interface">IStream</span> interface to some stream object. </p>
<p>The <span class="argument">ppidlOut</span> argument provides the address of a 
variable that is to receive the address of the PIDL. </p>
<h3>Return Value </h3>
<!--webbot bot="Include" U-Include="../../_include/hresult.htm" TAG="BODY" startspan -->

<p>The function returns zero for success, else an error code. </p>

<!--webbot bot="Include" i-checksum="1551" endspan -->
<h2>Behaviour </h2>
<p>The PIDL is to be introduced by a dword that gives the size of the PIDL in 
bytes. The PIDL follows immediately. It is expected to be a sequence of
<span class="struct">SHITEMID</span> structures. Each structure has its size in 
bytes as its first word. The sequence terminates with a word whose value is 
zero, as if to begin a structure whose size is zero. </p>
<p>If the function cannot read the introductory dword from the stream, it fails. 
If the function cannot get memory for the PIDL, it fails, with
<span class="constant">E_OUTOFMEMORY</span> as the error code. If the function 
cannot read from the stream to fill that memory block, it fails. If the data 
that is read into the memory block is not plausibly a PIDL, the function fails, 
with
<span class="macro">HRESULT_FROM_WIN32 (ERROR_INVALID_DATA)</span> as the error 
code. </p>
<p>The memory block for the PIDL is obtained through <span class="function">
CoTaskMemAlloc</span> 
and may be freed through <span class="function">CoTaskMemFree</span> when the 
caller is done with it. </p>
<h2>Availability </h2>
<p>The <span class="function">IStream_ReadPidl</span> function is exported from 
SHLWAPI as ordinal 512 in version 6.00 and higher. </p>
<!--webbot bot="Include" U-Include="../../_include/undoc600.htm" TAG="BODY" startspan -->

<p>Though this function dates from 2001, it was still not documented by 
Microsoft in the MSDN Library at least as late as the CD edition dated January 
2004. </p>

<!--webbot bot="Include" i-checksum="12777" endspan -->
<!--webbot bot="Include" U-Include="../../_include/doc2006.htm" TAG="BODY" startspan -->

<p>However, the function did eventually get documented, apparently sometime in 
2006. This article now conforms to Microsoft’s nomenclature. </p>

<!--webbot bot="Include" i-checksum="5100" endspan -->
<p>What documentation is provided in the January 2007 edition of the Windows 
SDK, and it really is very little, puts “Windows Vista” as the minimum operating 
system. Whatever the reason that this function remained undocumented, it is 
evidently not that Microsoft was taking its time to be accurate. </p>
<div class="Footer">
  <p class="Dates">This page was created on 3rd October 2004 and was last 
  modified on 29th March 2008. </p>
  <!--webbot bot="Include" U-Include="../../../../_include/c0408.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2004-2008. Geoff Chappell. All rights reserved.
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="1394" endspan -->
</div>

</body>

</html>