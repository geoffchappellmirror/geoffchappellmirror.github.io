<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>KAFFINITY_ENUMERATION_CONTEXT</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell, Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="29544" -->
<h1>KAFFINITY_ENUMERATION_CONTEXT </h1>
<p>The <span class="struct">KAFFINITY_ENUMERATION_CONTEXT</span> structure seems 
to exist for a handful of functions that are exported from the kernel for tidier 
access to a <span class="struct"><a href="kaffinity_ex.htm">KAFFINITY_EX</a></span> 
for the limited purpose of enumerating its set bits: </p>
<ul>
  <li><span class="function">KeEnumerateNextProcessor</span> (6.1 and higher);
  </li>
  <li><span class="function">KeInitializeEnumerationContext</span> (6.1 and higher);
  </li>
  <li><span class="function">KeInitializeEnumerationContextFromAffinity</span> (10.0 
  and higher); </li>
  <li><span class="function">KeInitializeEnumerationContextFromGroup</span> (6.1 
  and higher). </li>
</ul>
<h2>Documentation Status </h2>
<p>The <span class="struct">KAFFINITY_ENUMERATION_CONTEXT</span> structure is not 
documented. Nor is it even declared in any header from a known Windows Driver Kit 
(WDK). </p>
<p>The related functions are not documented either, though they are declared in 
the NTOSP.H from the Enterprise edition of the Windows Driver Kit (WDK) for Windows 
10 Version 1511. Quite what the point is to declaring them there is anyone’s guess, 
however, for the declarations depend on the <span class="type">PKAFFINITY_ENUMERATION_CONTEXT</span> 
type, which is in turn not declared in any header that’s supplied with that WDK.
</p>
<h2>Layout </h2>
<p>The <span class="struct">KAFFINITY_ENUMERATION_CONTEXT</span> is 0x0C or 0x18 
bytes in 32-bit and 64-bit Windows, respectively. </p>
<p>Sizes, offsets, types and names in the table that follows are from Microsoft’s 
symbol files for URLMON.DLL. Yes, this user-mode DLL—not even one that’s vital for 
user-mode interactions with the kernel but is instead a component of Internet Explorer—knows 
this structure that for some years wasn’t even declared for kernel-mode programming 
and still isn’t defined. </p>
<table class="Struct">
  <colgroup>
    <col class="Offset" span="2"><col class="Definition">
  </colgroup>
  <tr>
    <th>Offset (x86) </th>
    <th>Offset (x64) </th>
    <th>Definition </th>
  </tr>
  <tr>
    <td>0x00 </td>
    <td>0x00 </td>
    <td>
    <pre class="source">KAFFINITY_EX *Affinity;</pre>
    </td>
  </tr>
  <tr>
    <td>0x04 </td>
    <td>0x08 </td>
    <td>
    <pre class="source">ULONGLONG CurrentMask;</pre>
    </td>
  </tr>
  <tr>
    <td>0x08 </td>
    <td>0x10 </td>
    <td>
    <pre class="source">USHORT CurrentIndex;</pre>
    </td>
  </tr>
</table>
<div class="Footer">
  <p class="Dates">This page was created on 29th October 2016 and was last modified 
  on 17th December 2019. </p>
  <!--webbot bot="Include" U-Include="../../../../_include/c1619.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2016-2019. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="5029" -->
</div>

</body>

</html>
