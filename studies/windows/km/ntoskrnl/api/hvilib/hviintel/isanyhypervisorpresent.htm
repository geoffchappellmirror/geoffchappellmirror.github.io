<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>HviIsAnyHypervisorPresent</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <h1>HviIsAnyHypervisorPresent </h1>
  <p>The <span class="function">HviIsAnyHypervisorPresent</span> function tells 
  whether the <span class="instruction">
  <a href="../../../../cpu/cpuid/index.htm">cpuid</a></span> instruction is implemented 
  by a hypervisor. </p>
  <h2>Declaration </h2>
  <pre class="source">BOOLEAN HviIsAnyHypervisorPresent (VOID);</pre>
  <h3>Return Value </h3>
  <p>The function returns <span class="constant">TRUE</span> or
  <span class="constant">FALSE</span> according to whether a hypervisor is present.
  </p>
  <h2>Availability </h2>
  <p>The <span class="function">HviIsAnyHypervisorPresent</span> function is exported 
  by name from the kernel in version 10.0 and higher. </p>
  <h3>History </h3>
  <p>The version 6.3 kernel has an inline routine that is coded very similarly to 
  the version 10.0 <span class="function">HviIsAnyHypervisorPresent</span>. Public 
  symbol files for the version 6.3 kernel confirm that this earlier kernel has an 
  inline routine that was already named <span class="inline routine">HviIsAnyHypervisorPresent</span>, 
  took no input and returned a <span class="type">BOOLEAN</span>. That the inline 
  routine in the binary is the same as named in the symbol files which is in turn 
  the origin of the exported function must be all but certain. </p>
  <h2>Documentation Status </h2>
  <p>The <span class="function">HviIsAnyHypervisorPresent</span> function is not 
  documented. </p>
  <h2>Behaviour </h2>
  <p>Before the 1607 release of Windows 10, the function’s whole behaviour was to 
  return <span class="constant">TRUE</span> or <span class="constant">FALSE</span> 
  according to whether the 0x80000000 bit is set or clear in
  <a href="../../../../cpu/cpuid/00000001h/ecx.htm"><span class="register">ecx</span> 
  from <span class="instruction">cpuid</span> leaf 1</a>. Intel’s literature for 
  Intel’s processors assures that this bit is “Not Used” and “Always returns 0”. 
  From a set bit, the function infers that some sort of hypervisor is present.
  </p>
  <p>The 1607 release of Windows 10 introduced a qualification of the answer. Put 
  another way, it extended the question in the function’s name: is any hypervisor 
  present but not the Xbox Nanovisor? After finding that a hypervisor is present, 
  the function executes <span class="instruction">cpuid</span> with 0x40000001 in
  <span class="register">eax</span>, expecting this to load
  <span class="register">eax</span> with an identifier of the hypervisor’s interface. 
  If this is 'vnbX', then the function returns <span class="constant">FALSE</span>.
  </p>
  <div class="Footer">
    <p class="Dates">This page was created on 19th
    <a href="../../../../../../../new/16/11.htm">November 2016</a>. and was last 
    modified on 30th <a href="../../../../../../../new/22/10.htm">November 2022</a>.
    </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c1622.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2016-2022. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="4925" -->
  </div>
</div>

</body>

</html>
