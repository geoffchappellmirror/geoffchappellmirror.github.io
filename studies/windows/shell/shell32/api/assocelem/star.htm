<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>AssocStarElement</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>AssocStarElement </h1>
<p>Instances of the star type of <a href="index.htm">assocation element</a> are 
created by passing the corresponding CLSID to the <span class="function">
<a href="createelement.htm">AssocCreateElement</a></span> function: </p>
<table>
  <tr>
    <td><span class="constant">CLSID_AssocStarElement</span> </td>
    <td><span class="clsid">{0633B720-6926-404C-B6B3-923B1A501743}</span> </td>
  </tr>
</table>
<p>As with all assocation elements, star elements implement the
<span class="interface">
<a href="../../../shlwapi/interfaces/iassociationelement.htm">IAssociationElement</a></span>,
<span class="interface"><a href="../../interfaces/iobjectwithquerysource.htm">IObjectWithQuerySource</a></span> 
and <span class="interface"><a href="../../interfaces/ipersiststring2.htm">IPersistString2</a></span> 
interfaces. However, all the methods of a star element are the same as for the basic
<a href="shell.htm">shell element</a> except for <span class="method">SetString</span>,
<span class="method">QueryString</span> and <span class="method">GetClassID</span>. 
In effect, a star element is just a shell element with a different query source 
and a different handling of one particular query. </p>
<h2>Initialisation String </h2>
<p>When a star element is initialised through its <span class="method">SetString</span> 
method, the registry key that is used as the query source is necessarily: </p>
<table class="Registry">
  <tr>
    <td>Key: </td>
    <td><span class="regkey">HKEY_CLASSES_ROOT\*</span> </td>
  </tr>
</table>
<p>The initialisation string is instead remembered, to help generate the friendly 
type name should it ever be queried. That the initialisation string is meaningful 
seems to have been missed in Microsoft’s documentation of the
<span class="constant">ASSOCCLASS_STAR</span> case of the <span class="function">
<a href="../assoclist/createforclasses.htm">AssocCreateForClasses</a></span> function.
</p>
<h2>The FriendlyTypeName Query </h2>
<p>Star elements have their own handling of <span class="enum">
<a href="query.htm">ASSOCQUERY</a></span> 0x00170000 when put to the
<span class="method">QueryString</span> method. For the basic shell element, this 
query is answered from the <span class="regvalue">FriendlyTypeName</span> value 
in the element’s query source. For a star element, the friendly type name is instead 
generated from the initialisation string with help from the SHELL32 string resources.
</p>
<p>If the initialisation string is a file extension, i.e., is a period followed 
by at least one character, then the friendly type name is generated by placing the 
extension, in upper case and without its leading period, in the %s placeholder in 
string resource 10112. For any other initialisation string, the friendly type name 
is the whole of string resource 4130. In the English-language SHELL32, these resolutions 
are </p>
<ul>
  <li><span class="placeholder">extension</span> File </li>
  <li>File </li>
</ul>
<p>respectively. </p>
<div class="Footer">
  <p class="Dates">This page was created on 7th July 2009 and was last modified 
  on 23rd July 2009. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c09.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2009. Geoff Chappell. All rights reserved.
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="50766" endspan -->
</div>

</body>

</html>
