<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Install Language</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>Install Language </h1>
<p>The install language is what <span class="function"><a href="load.htm">MLLoadLibrary</a></span> 
defaults to when choosing which MUI satellite library to load. </p>
<p>On Windows 2000 and higher, the install language is just the system default UI 
language. Indeed, this identity of the concepts is cemented into the SHLWAPI version 
6.00 from Windows Server 2003 and Windows Vista and higher, such that SHLWAPI no 
longer has its own internal procedure <span class="symbol">GetInstallLanguage</span> 
but simply calls the standard API function <span class="function">GetSystemDefaultUILanguage</span>. 
Builds of version 6.00 from Windows XP and Internet Explorer 6.0, and all earlier 
versions back to 5.00, retain the separation but when they find themselves executing 
on Windows 2000 or higher, they end up evaluating the install language just by calling 
the standard API function <span class="function">GetUserDefaultUILanguage</span>, 
if this is available as an export from KERNEL32. </p>
<h2>Simulation From Registry Settings </h2>
<p>When these earlier builds execute on other operating systems, they make their 
own determination of the install language from the registry. Of course, the install 
language is assumed not to change, and so this discovery is done just the once and 
is then remembered. The defining registry value is: </p>
<table class="Registry">
  <tr>
    <td>Key: </td>
    <td><span class="regkey">HKEY_LOCAL_MACHINE\Software\Microsoft\Active Setup\Installed 
    Components\{89820200-ECBD-11CF-8B85-00AA005B4383}</span> </td>
  </tr>
  <tr>
    <td>Value: </td>
    <td><span class="regvalue">Locale</span> </td>
  </tr>
</table>
<p>Data for this value is a two-character code for the install language. The function 
accepts as many as 3 characters of string data, including a terminating null, or 
3 bytes of data (which the function will interpret as characters). The following 
table shows for each recognised code the language ID as returned by the function 
and the corresponding language name: </p>
<table>
  <tr>
    <th>Code </th>
    <th>Language ID </th>
    <th>RFC 3066 </th>
  </tr>
  <tr>
    <td>AR </td>
    <td>0x0401 </td>
    <td>ar-SA </td>
  </tr>
  <tr>
    <td>BR </td>
    <td>0x0416 </td>
    <td>pt-BR </td>
  </tr>
  <tr>
    <td>CN </td>
    <td>0x0804 </td>
    <td>zh-CN </td>
  </tr>
  <tr>
    <td>CS </td>
    <td>0x0405 </td>
    <td>cs-CZ </td>
  </tr>
  <tr>
    <td>DA </td>
    <td>0x0406 </td>
    <td>da-DK </td>
  </tr>
  <tr>
    <td>DE </td>
    <td>0x0407 </td>
    <td>de-DE </td>
  </tr>
  <tr>
    <td>EL </td>
    <td>0x0408 </td>
    <td>el-GR </td>
  </tr>
  <tr>
    <td>EN </td>
    <td>0x0409 </td>
    <td>en-US </td>
  </tr>
  <tr>
    <td>ES </td>
    <td>0x0C0A </td>
    <td>es-ES </td>
  </tr>
  <tr>
    <td>FI </td>
    <td>0x040B </td>
    <td>fi-FI </td>
  </tr>
  <tr>
    <td>FR </td>
    <td>0x040C </td>
    <td>fr-FR </td>
  </tr>
  <tr>
    <td>HE </td>
    <td>0x040D </td>
    <td>he-IL </td>
  </tr>
  <tr>
    <td>HU </td>
    <td>0x040E </td>
    <td>hu-HU </td>
  </tr>
  <tr>
    <td>IT </td>
    <td>0x0410 </td>
    <td>it-IT </td>
  </tr>
  <tr>
    <td>JA </td>
    <td>0x0411 </td>
    <td>ja-JP </td>
  </tr>
  <tr>
    <td>KO </td>
    <td>0x0412 </td>
    <td>ko-KR </td>
  </tr>
  <tr>
    <td>NL </td>
    <td>0x0413 </td>
    <td>nl-NL </td>
  </tr>
  <tr>
    <td>NO </td>
    <td>0x0414 </td>
    <td>nb-NO </td>
  </tr>
  <tr>
    <td>PL </td>
    <td>0x0415 </td>
    <td>pl-PL </td>
  </tr>
  <tr>
    <td>PT </td>
    <td>0x0816 </td>
    <td>pt-PT </td>
  </tr>
  <tr>
    <td>RU </td>
    <td>0x0419 </td>
    <td>ru-RU </td>
  </tr>
  <tr>
    <td>SK </td>
    <td>0x041B </td>
    <td>sk-SK </td>
  </tr>
  <tr>
    <td>SL </td>
    <td>0x0424 </td>
    <td>sl-SI </td>
  </tr>
  <tr>
    <td>SV </td>
    <td>0x041D </td>
    <td>sv-SE </td>
  </tr>
  <tr>
    <td>TR </td>
    <td>0x041F </td>
    <td>tr-TR </td>
  </tr>
  <tr>
    <td>TW </td>
    <td>0x0404 </td>
    <td>zh-TW </td>
  </tr>
</table>
<div class="Footer">
  <p class="Dates">This page was created on 14th July 2009 and was last modified 
  on 15th July 2009. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c09.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2009. Geoff Chappell. All rights reserved.
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="50766" endspan -->
</div>

</body>

</html>
