<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>The Credibility of NTDLL Export Availability</title>
<link rel="stylesheet" type="text/css" href="../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../_styles/win32.css">
<script type="text/javascript" src="../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../_scripts/win32.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="63592" -->
<div class="Main">
  <!--webbot bot="Include" U-Include="../../_include/workitem.htm" TAG="BODY" startspan -->

<div class="Header">
  <p class="alert">OLD MATERIAL BEING UPDATED OR REWORKED - TAKE CARE </p>
</div>

<!--webbot bot="Include" endspan i-checksum="47525" -->
  <h1>The Credibility of NTDLL Export Availability </h1>
  <p>For the handful of NTDLL exports that are documented explicitly as NTDLL functions 
  and the many more for which a corresponding kernel-mode export is documented in 
  the WDK, Microsoft either lies about the applicable versions or says nothing.
  </p>
  <p>Though saying nothing is unhelpful, it seems the less unethical and it anyway 
  was readily understandable in the early years as natural neglect: the Windows 
  kernel itself didn’t export any sort of function for reporting the Windows version 
  until version 4.0. Early Device Driver Kit (DDK) documentation only rarely mentions 
  any Windows version other than the one the kit was prepared for, so much so that 
  the DDK for Windows XP stood out for its promotion of new functionality as new 
  for Windows XP. </p>
  <p>The first big change from mostly saying nothing was not in the documentation 
  but in the declarations. The Windows Driver Kit (WDK) for Windows Vista, with 
  headers dated 2nd November 2006, wrapped many declarations in conditional compilation 
  blocks such that functions are exposed for programming only if building with an 
  expected value of the <span class="macro">NTDDI_VERSION</span> macro. The lowest 
  defined of these expected values was for Windows 2000. As appropriate as this 
  may have been for a kit that had Windows 2000 as its oldest supported target version 
  for building drivers, conditional blocks were added even for functions that long 
  pre-date Windows 2000. These functions’ declarations might just as well have been 
  left unadorned as far as could affect any programming. </p>
  <p>A second change in 2009 carried this notion of Windows 2000 as the beginning 
  of time into the documentation. The second WDK for Windows 7 (version 7600.16385.1, 
  dated 1st December 2009) added “Available in Windows 2000 and later versions of 
  Windows” to the documentation of nearly every function for which no minimum version 
  was yet specified. This is not unreasonable inasmuch as it means only that Microsoft 
  no longer supports earlier versions of Windows, but of course it will easily be 
  taken by some as accurate history. </p>
  <p>Of course, where Microsoft documents a function as available only in some versions, 
  the intention may just be that those are the versions for which the function is 
  implemented well enough to consider usable by programmers in general. It could 
  be that the function is exported from earlier versions but in an experimental 
  or even defective implementation that Microsoft cannot support. Certainly, a pattern 
  is discernable in which a function is said to be available starting from whatever 
  Windows version was contemporaneous with the function’s introduction to the documentation. 
  This is perhaps how <span class="delayed wdk function">RtlGetDaclSecurityDescriptor</span> 
  is dated to Windows Server 2003 SP1—yes, so precisely—even though it is an original 
  export in both kernel and user modes. </p>
  <p>There is anyway the complication that although the WDK is Microsoft’s only 
  known public reference material for functions that happen to have the same names 
  and types (and often the same implementations too) as a good selection of user-mode 
  exports from NTDLL, it is a kit for writing device drivers, mostly for execution 
  in kernel mode to import the functions not from NTDLL but from the kernel. </p>
  <p>Special mention must be made of a few NTDLL functions that Microsoft documented 
  as Settlement Program Interfaces in late 2002 apparently because they are used 
  by Microsoft Middleware products such as Internet Explorer. There were not many 
  at this low level. A good proportion have become re-undocumented in the years 
  since, at least as exports from NTDLL. It should anyway not go unnoticed that 
  Microsoft’s selection of functions to document for the settlement was very strict, 
  if not grudging and perverse. For instance, <span class="settlement function">
  RtlTimeToSecondsSince1970</span> got documented explicitly as a user-mode function 
  but its inverse <span class="delayed wdk function">RtlSecondsSince1970ToTime</span> 
  did not. </p>
  <div class="Footer">
    <p class="Dates">This page was created on 23rd May 2022 from material first 
    published on 26th July 2016. </p>
    <!--webbot bot="Include" U-Include="../../_include/c1622.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2016-2022. Geoff Chappell. All rights reserved. 
<a href="../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="5315" -->
  </div>
</div>

</body>

</html>
