<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SHIsEmptyStream</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js">
</script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js">
</script>
<script type="text/javascript" src="../../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="14798" endspan -->
<h1>SHIsEmptyStream </h1>
<p>This function tests whether a stream is empty. </p>
<h2>Declaration </h2>
<pre class="source">BOOL SHIsEmptyStream (LPSTREAM pstm);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">pstm</span> argument provides the address of an
<span class="interface">IStream</span> interface to some stream object. </p>
<h3>Return Value </h3>
<p>The function returns TRUE if the stream is empty, else FALSE. </p>
<h2>Behaviour </h2>
<p>If the stream’s <span class="method">Stat</span> method succeeds, the 
function returns TRUE if the size so obtained is zero, else FALSE. </p>
<p>If the <span class="method">Stat</span> method fails, the function tries to 
read 4 bytes from the stream. If the read fails to produce exactly 4 bytes, the 
function infers (surely without ground) that the stream is empty, and returns 
TRUE. If it can read 4 bytes, it resets the stream’s seek pointer to zero and 
returns FALSE.
</p>
<h2>Availability </h2>
<p>The <span class="function">SHIsEmptyStream</span> function is exported from 
SHLWAPI as ordinal 166 in version 5.00 and higher. </p>
<!--webbot bot="Include" U-Include="../../_include/undoc500.htm" TAG="BODY" startspan -->

<p>Though this function dates from as long ago as 1999, it was still not 
documented by Microsoft in the MSDN Library at least as late as the CD edition 
dated January 2004. </p>

<!--webbot bot="Include" i-checksum="43429" endspan -->
<div class="Footer">
  <p class="Dates">This page was created on 3rd October 2004 and was last 
  modified on 16th March 2007. </p>
  <!--webbot bot="Include" U-Include="../../../../_include/c0407.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2004-2007. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="4669" endspan -->
</div>

</body>

</html>