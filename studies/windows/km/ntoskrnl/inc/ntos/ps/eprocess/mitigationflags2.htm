<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>MitigationFlags2 in the EPROCESS</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="33595" -->
<div class="Main">
  <h1>MitigationFlags2 in the EPROCESS </h1>
  <p>Since the introduction of Control Flow Guard for version 6.3, Windows accumulated 
  rather many bit fields for whether this or that security mitigation applies. The 
  1709 release of Windows 10 collected many of these from the
  <span class="member"><a href="flags.htm">Flags</a></span>,
  <span class="member"><a href="flags2.htm">Flags2</a></span> and
  <span class="member"><a href="flags3.htm">Flags3</a></span> members of the
  <span class="struct"><a href="index.htm">EPROCESS</a></span> for a new set in 
  union with a <span class="type">ULONG</span> member named <span class="member">
  <a href="mitigationflags.htm">MitigationFlags</a></span>. New bits for new mitigations 
  are mostly in a second new set in union with a <span class="type">ULONG</span> 
  named <span class="member">MitigationFlags2</span>. </p>
  <table class="Flags">
    <colgroup>
      <col class="Mask"><col class="Definition"><col class="Version">
    </colgroup>
    <thead>
      <tr>
        <th>Mask </th>
        <th>Definition </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00000001 </td>
        <td>
        <pre class="source">ULONG EnableExportAddressFilter : 1;</pre>
        </td>
        <td>1709 and higher </td>
      </tr>
      <tr>
        <td>0x00000002 </td>
        <td>
        <pre class="source">ULONG AuditExportAddressFilter : 1;</pre>
        </td>
        <td>1709 and higher </td>
      </tr>
      <tr>
        <td>0x00000004 </td>
        <td>
        <pre class="source">ULONG EnableExportAddressFilterPlus : 1;</pre>
        </td>
        <td>1709 and higher </td>
      </tr>
      <tr>
        <td>0x00000008 </td>
        <td>
        <pre class="source">ULONG AuditExportAddressFilterPlus : 1;</pre>
        </td>
        <td>1709 and higher </td>
      </tr>
      <tr>
        <td>0x00000010 </td>
        <td>
        <pre class="source">ULONG EnableRopStackPivot : 1;</pre>
        </td>
        <td>1709 and higher </td>
      </tr>
      <tr>
        <td>0x00000020 </td>
        <td>
        <pre class="source">ULONG AuditRopStackPivot : 1;</pre>
        </td>
        <td>1709 and higher </td>
      </tr>
      <tr>
        <td>0x00000040 </td>
        <td>
        <pre class="source">ULONG EnableRopCallerCheck : 1;</pre>
        </td>
        <td>1709 and higher </td>
      </tr>
      <tr>
        <td>0x00000080 </td>
        <td>
        <pre class="source">ULONG AuditRopCallerCheck : 1;</pre>
        </td>
        <td>1709 and higher </td>
      </tr>
      <tr>
        <td>0x00000100 </td>
        <td>
        <pre class="source">ULONG EnableRopSimExec : 1;</pre>
        </td>
        <td>1709 and higher </td>
      </tr>
      <tr>
        <td>0x00000200 </td>
        <td>
        <pre class="source">ULONG AuditRopSimExec : 1;</pre>
        </td>
        <td>1709 and higher </td>
      </tr>
      <tr>
        <td>0x00000400 </td>
        <td>
        <pre class="source">ULONG EnableImportAddressFilter : 1;</pre>
        </td>
        <td>1709 and higher </td>
      </tr>
      <tr>
        <td>0x00000800 </td>
        <td>
        <pre class="source">ULONG AuditImportAddressFilter : 1;</pre>
        </td>
        <td>1709 and higher </td>
      </tr>
      <tr>
        <td>0x00001000 </td>
        <td>
        <pre class="source">ULONG DisablePageCombine : 1;</pre>
        </td>
        <td>1809 and higher </td>
      </tr>
      <tr>
        <td>0x00002000 </td>
        <td>
        <pre class="source">ULONG SpeculativeStoreBypassDisable : 1;</pre>
        </td>
        <td>1809 and higher </td>
      </tr>
      <tr>
        <td rowspan="2">0x00004000 </td>
        <td>
        <pre class="source">ULONG CetShadowStacks : 1;</pre>
        </td>
        <td>1809 only </td>
      </tr>
      <tr>
        <td>
        <pre class="source">ULONG CetUserShadowStacks : 1;</pre>
        </td>
        <td>1903 and higher </td>
      </tr>
      <tr>
        <td>0x00008000 </td>
        <td>
        <pre class="source">ULONG AuditCetUserShadowStacks : 1;</pre>
        </td>
        <td>2004 and higher </td>
      </tr>
      <tr>
        <td>0x00010000 </td>
        <td>
        <pre class="source">ULONG AuditCetUserShadowStacksLogged : 1;</pre>
        </td>
        <td>2004 and higher </td>
      </tr>
      <tr>
        <td>0x00020000 </td>
        <td>
        <pre class="source">ULONG UserCetSetContextIpValidation : 1;</pre>
        </td>
        <td>2004 and higher </td>
      </tr>
      <tr>
        <td>0x00040000 </td>
        <td>
        <pre class="source">ULONG AuditUserCetSetContextIpValidation : 1;</pre>
        </td>
        <td>2004 and higher </td>
      </tr>
      <tr>
        <td>0x00080000 </td>
        <td>
        <pre class="source">ULONG AuditUserCetSetContextIpValidationLogged : 1;</pre>
        </td>
        <td>2004 and higher </td>
      </tr>
    </tbody>
  </table>
  <div class="Footer">
    <p class="Dates">This page was created on 23rd
    <a href="../../../../../../../../new/18/09.htm">September 2018</a>. and was 
    last modified on 31st <a href="../../../../../../../../new/22/07.htm">July 2022</a>.
    </p>
    <!--webbot bot="Include" U-Include="../../../../../_include/c1822.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2018-2022. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="14506" -->
  </div>
</div>

</body>

</html>
