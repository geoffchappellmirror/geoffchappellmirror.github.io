<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>PathGetDriveNumber</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>PathGetDriveNumber </h1>
<p>This function parses a path for its drive component. </p>
<h2>Declaration </h2>
<pre class="source">int PathGetDriveNumber (LPCTSTR lpsz);</pre>
<!--webbot bot="Include" U-Include="../_include/aw.htm" TAG="BODY" startspan -->

<p>The function exists in ANSI and Unicode forms. </p>

<!--webbot bot="Include" i-checksum="40026" endspan -->
<h3>Parameters </h3>
<p>The <span class="argument">lpsz</span> argument provides the address of a drive 
specifier. </p>
<h3>Return Value </h3>
<p>The function returns the 0-based drive number, else -1. </p>
<h2>Behaviour </h2>
<p>The function fails, i.e., returns -1, if <span class="argument">lpsz</span> is 
NULL or the first character at <span class="argument">lpsz</span> is null. </p>
<p>In the Unicode form only, if the characters at <span class="argument">lpsz</span> 
begin as two backslashes, a question mark and another backslash, the function ignores 
these four characters. </p>
<p>A drive specifier is a drive letter and a colon. The function fails if the first 
character is not a drive letter in upper or lower case, or if the second character 
is not a colon. Otherwise, the function returns a 0-based drive number, as in 0 
for drive A, 1 for drive B, etc. </p>
<h3>Variations </h3>
<p>The preceding description is for the version 6.0 from Windows Vista. The following 
variations are known for earlier versions. </p>
<p>Versions before 5.00 simply assume that <span class="argument">lpsz</span> is 
not NULL. </p>
<p>Ignoring a leading \\?\ is new for Windows Vista. So is the explicit defence 
against the first character being null. </p>
<h2>Availability </h2>
<p>The <span class="function">PathGetDriveNumber</span> function is exported by 
name (with ANSI and Unicode suffixes) from SHLWAPI in version 4.70 and higher. It 
is also exported from SHELL32.DLL as ordinal 57 (in ANSI for Windows builds and 
Unicode for NT builds) in version 4.0 and higher. The implementation in SHELL32 
version 5.0 and higher is just to dump to the coding in SHLWAPI. </p>
<!--webbot bot="Include" U-Include="../_include/latedoc471.htm" TAG="BODY" startspan -->

<p>This function has been documented since some time in 1997-98. Though it dates 
from 1996 in SHLWAPI and from 1995 elsewhere, it has always been said to require 
at least SHLWAPI version 4.71. </p>

<!--webbot bot="Include" i-checksum="55748" endspan -->
<p>Microsoft’s documentation hints only vaguely at this function ignoring anything 
(let alone \\?\ particularly) before the drive specifier. </p>
<div class="Footer">
  <p class="Dates">This page was created on 31st May 2009 and was last modified 
  on 18th February 2010. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c0910.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2009-2010. Geoff Chappell. All rights reserved.
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="4439" endspan -->
</div>

</body>

</html>
