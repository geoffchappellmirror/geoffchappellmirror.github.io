<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>OBJECT_INFORMATION_CLASS</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <h1>OBJECT_INFORMATION_CLASS </h1>
  <p>The <span class="enum">OBJECT_INFORMATION_CLASS</span> is an enumeration whose 
  values are intended as input to the <span class="function">ZwQueryObject</span> 
  and <span class="function">ZwSetInformationObject</span> functions. Different 
  values select different types of information to query or set. </p>
  <h2>Availability </h2>
  <p>The user-mode forms of <span class="function">NtQueryObject</span> and
  <span class="function">ZwQueryObject</span> are original exports from NTDLL and 
  the <span class="struct">OBJECT_INFORMATION_CLASS</span> is therefore also original. 
  It, or something exactly like it, is defined in version 3.10 and higher. </p>
  <h2>Documentation Status </h2>
  <p>Microsoft has kept <span class="enum">OBJECT_INFORMATION_CLASS</span> remarkably 
  private. Analogues for information about files, processes, threads, and much else, 
  have all their supported values defined in header files from as far back as the 
  Device Driver Kit (DDK) for Windows NT 3.51. In contrast, Microsoft is not known 
  to have published a C-langauge definition of the information class for objects 
  until Windows 7: in NTIFS.H from the Windows Driver Kit (WDK) and WINTERNL.H from 
  the Software Development Kit (SDK). Even then, the enumeration is of only two 
  values and the corresponding structures for the information are disclosed only 
  in reduced form. </p>
  <p>Microsoft’s names for all the <span class="enum">OBJECT_INFORMATION_CLASS</span> 
  values have slipped out, of course. They are knowable from type information in 
  public symbol files for the kernel, though again only starting with Windows 7.
  </p>
  <p>Do not miss, though, that this same type information is in symbol files that 
  Microsoft has published for URLMON.DLL and other user-mode modules, starting from 
  Windows 8. By any reckoning, including Microsoft’s own once upon a time, URLMON.DLL 
  is a component of Internet Explorer. Its versions from Windows up to but not including 
  the 1803 release of Windows 10 plainly were built with a full definition of
  <span class="struct">OBJECT_INFORMATION_CLASS</span> from the same otherwise unpublished 
  header NTOBAPI_X.H as the kernel’s full definition. This sort of privileged access 
  to the Windows source code was the essence of a large part of the anti-trust case 
  against Microsoft whose settlement prompted the development of WINTERNL.H for 
  the SDK in 2002. Yet the access that Internet Explorer’s programmers had to the
  <span class="struct">OBJECT_INFORMATION_CLASS</span> definition was somehow missed 
  from WINTERNL.H until 2009 and even then was disclosed only grudgingly. There’s 
  a lesson here for any government’s contemplation of anti-trust action against 
  software companies: they will run rings around you. </p>
  <p>Much further back, it turns out that type information for the
  <span class="enum">OBJECT_INFORMATION_CLASS</span> was disclosed in statically 
  linked libraries that Microsoft distributed with early DDKs: a GDISRVL.LIB in 
  the DDK for Windows NT 3.51; and SHELL32.LIB in the DDK for Windows NT 4.0. That 
  the latter is otherwise just an import library for SHELL32.DLL suggests strongly 
  that these disclosures were one-off oversights. Still, published they were.
  </p>
  <h2>Enumeration </h2>
  <p>Some of the <span class="enum">OBJECT_INFORMATION_CLASS</span> values can be 
  used successfully only to query or only to set. The present purpose however is 
  not to show which values are implemented non-trivially in which versions, but 
  which values are defined in which versions, as much as can be known. For Windows 
  7 and higher, the type information in symbol files is surely definitive. The import 
  libraries for versions 3.51 and 4.0 are here taken as definitive also. What names 
  are defined for other versions is something of a guess based largely on what’s 
  implemented. </p>
  <table class="Enum">
    <colgroup>
      <col class="Value"><col class="Name"><col class="Versions">
    </colgroup>
    <thead>
      <tr>
        <th>Value </th>
        <th>Name </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0 </td>
        <td><span class="constant">ObjectBasicInformation</span> </td>
        <td>all </td>
      </tr>
      <tr>
        <td>1 </td>
        <td><span class="undocumented constant">ObjectNameInformation</span>
        </td>
        <td>all </td>
      </tr>
      <tr>
        <td>2 </td>
        <td><span class="constant">ObjectTypeInformation</span> </td>
        <td>all </td>
      </tr>
      <tr>
        <td>3 </td>
        <td><span class="undocumented constant">ObjectTypesInformation</span>
        </td>
        <td>3.50 and higher </td>
      </tr>
      <tr>
        <td>4 </td>
        <td><span class="undocumented constant">ObjectHandleFlagInformation</span>
        </td>
        <td>3.50 and higher </td>
      </tr>
      <tr>
        <td>5 </td>
        <td><span class="undocumented constant">ObjectSessionInformation</span>
        </td>
        <td>5.2 and higher </td>
      </tr>
      <tr>
        <td>6 </td>
        <td><span class="undocumented constant">ObjectSessionObjectInformation</span>
        </td>
        <td>1703 and higher </td>
      </tr>
      <tr>
        <td>6 (6.1 to 1607); <br>
        7 </td>
        <td><span class="undocumented constant">MaxObjectInfoClass</span> </td>
        <td>&nbsp;</td>
      </tr>
    </tbody>
  </table>
  <p>Though <span class="constant">ObjectTypeInformation</span> is shown above as 
  the original name, all that information class 2 tells of an object in version 
  3.10 is the name of the object’s type, not the larger information that later versions 
  report of the object’s type. This is not inconsistent with being an early form 
  of what is known for later versions to be the <span class="struct">
  <a href="../ntobapi/object_type_information.htm">OBJECT_TYPE_INFORMATION</a></span> produced as output 
  for <span class="constant">ObjectTypeInformation</span>, but it’s different enough 
  that the programmers changed the name of the subroutine that does the bulk of 
  the work for querying this information class. Later versions have
  <span class="internal routine">ObQueryTypeInfo</span>, which would be an obvious 
  name when the information class is <span class="constant">ObjectTypeInformation</span>, 
  but version 3.10 has <span class="internal routine">ObQueryTypeNameString</span> 
  (to compare with <span class="function">ObQueryNameString</span> for
  <span class="constant">ObjectNameInformation</span>). That information class 2 
  in version 3.10 is instead named <span class="constant">ObjectTypeNameInformation</span> 
  is at least plausible. </p>
  <p>That Microsoft did not originally end the enumeration with
  <span class="constant">MaxObjectInfoClass</span> is known from the statically 
  linked libraries. Precisely when it was added in versions 5.0 to 6.0, for which 
  type information is unavailable, may never be known. </p>
  <div class="Footer">
    <p class="Dates">This page was created on 27th
    <a href="../../../../../../../new/20/06.htm">June 2020</a> and was last modified 
    on 27th <a href="../../../../../../../new/22/07.htm">August 2022</a>. </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c2022.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2020-2022. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="4221" -->
  </div>
</div>

</body>

</html>
