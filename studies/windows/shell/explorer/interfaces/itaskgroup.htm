<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>ITaskGroup</title>
<link rel="stylesheet" type="text/css" href="../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../_styles/shell.css">
<script type="text/javascript" src="../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="30135" -->
<h1>ITaskGroup </h1>
<p>The <span class="interface">ITaskGroup</span> interface is implemented in EXPLORER.EXE 
by a class that is named internally as <span class="class">CTaskGroup</span>. The 
interface is thought to be used only within EXPLORER. Yet it is certainly no mere 
implementation detail with no effects outside EXPLORER. The class models a group 
of taskbar buttons whose corresponding windows are judged by Microsoft to be so 
similar that they must be grouped together on the taskbar and thereafter kept together 
as a unit whether as separate buttons or combined into one. Any attempt at putting 
users in control of this grouping, whether to disable it altogether or to undo a 
particular group or even just to reorder the buttons within a group, will require 
a good understanding of this class and its interface. </p>
<p>Please note that the interface is not only internal to EXPLORER.EXE but is highly 
variable from one Windows version to another. At least Microsoft has changed the 
IID each time the interface has changed substantively, which has not always been 
its practice with COM interfaces in the shell. Beware, however, that these notes 
have been prepared only from inspection of the original release of each version.
</p>
<table>
  <tr>
    <th>Interface </th>
    <th>IID </th>
    <th>Versions </th>
  </tr>
  <tr>
    <td rowspan="3"><span class="interface">ITaskGroup</span> </td>
    <td><span class="iid">{D2C5AD6A-C4C5-4DE1-AE35-59A809405534}</span> </td>
    <td>6.1 only </td>
  </tr>
  <tr>
    <td><span class="iid">{C499358F-5DF6-4E9A-826C-05B6CAD5BEFD}</span> </td>
    <td>6.2 to 6.3 </td>
  </tr>
  <tr>
    <td><span class="iid">{3AF85589-678F-4FB5-8925-5A134EBF572C}</span> </td>
    <td>10.0 only </td>
  </tr>
</table>
<p>No evidence is known that Microsoft defines the conventional symbol
<span class="symbol">IID_ITaskGroup</span> for this interface’s IID. Microsoft’s 
names and types for the <span class="interface">ITaskGroup</span> methods are known 
from the public symbol files for EXPLORER.EXE. The presentation here follows the 
ordering of the virtual function table after the <span class="interface">IUnknown</span> 
methods. </p>
<table class="Struct">
  <colgroup>
    <col class="Offset" span="2"><col class="Definition"><col class="Versions">
  </colgroup>
  <tr>
    <th>Offset (x86) </th>
    <th>Offset (x64) </th>
    <th>Prototype </th>
    <th>Versions </th>
  </tr>
  <tr>
    <td>0x0C </td>
    <td>0x18 </td>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
Initialize (
    PCIDLIST_ABSOLUTE, 
    PCWSTR, 
    PCWSTR);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x10 </td>
    <td>0x20 </td>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
AddTaskItem (
    <a href="itaskitem.htm">ITaskItem</a> *, 
    ITaskItem *);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x14 </td>
    <td>0x28 </td>
    <td>
    <pre class="source">HRESULT STDMETHODCALLTYPE RemoveTaskItem (ITaskItem *);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x18 </td>
    <td>0x30 </td>
    <td>
    <pre class="source">HRESULT STDMETHODCALLTYPE EnumTaskItems (IEnumTaskItems **);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x1C </td>
    <td>0x38 </td>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
DoesWindowMatch (
    HWND, 
    PCIDLIST_ABSOLUTE, 
    PCWSTR, 
    WINDOWMATCHCONFIDENCE, 
    ITaskItem **);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x20 </td>
    <td>0x40 </td>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
GetItemFromWindow (
    HWND, 
    ITaskItem **);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td rowspan="2">0x24 </td>
    <td rowspan="2">0x48 </td>
    <td>
    <pre class="source">HRESULT STDMETHODCALLTYPE GetNumItems (INT *);</pre>
    </td>
    <td>6.1 only </td>
  </tr>
  <tr>
    <td>
    <pre class="source">INT STDMETHODCALLTYPE GetNumItems (VOID);</pre>
    </td>
    <td>6.2 and higher </td>
  </tr>
  <tr>
    <td>0x28 </td>
    <td>0x50 </td>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
GetNumTabs (
    INT *, 
    INT *);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x2C </td>
    <td>0x58 </td>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
GetTitleText (
    ITaskItem *, 
    PWSTR, 
    INT);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x30 </td>
    <td>0x60 </td>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
GetTooltipText (
    ITaskItem *, 
    PWSTR, 
    INT);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x34 </td>
    <td>0x68 </td>
    <td>
    <pre class="source">HRESULT STDMETHODCALLTYPE GetLauncherName (PWSTR *);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x38 (6.1 to 6.3) </td>
    <td>0x70 (6.1 to 6.3) </td>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
GetIconPref (
    ITaskItem *, 
    INT *);</pre>
    </td>
    <td>6.1 to 6.3 </td>
  </tr>
  <tr>
    <td>0x3C (6.1 to 6.3) </td>
    <td>0x78 (6.1 to 6.3) </td>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
SetIconPref (
    ITaskItem *, 
    INT);</pre>
    </td>
    <td>6.1 to 6.3 </td>
  </tr>
  <tr>
    <td>0x40 (6.1 to 6.3); <br>0x38 </td>
    <td>0x80 (6.1 to 6.3); <br>0x70 </td>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
GetIconId (
    ITaskItem *, 
    INT *);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x44 (6.1 to 6.3); <br>0x3C </td>
    <td>0x88 (6.1 to 6.3); <br>0x78 </td>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
SetIconId (
    ITaskItem *, 
    INT);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x48 (6.1 to 6.3) </td>
    <td>0x90 (6.1 to 6.3) </td>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
GetHotTrackColor (
    ITaskItem *, 
    DWORD *);</pre>
    </td>
    <td>6.1 to 6.3 </td>
  </tr>
  <tr>
    <td>0x4C (6.1 to 6.3) </td>
    <td>0x98 (6.1 to 6.3) </td>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
SetHotTrackColor (
    ITaskItem *, 
    DWORD);</pre>
    </td>
    <td>6.1 to 6.3 </td>
  </tr>
  <tr>
    <td>0x50 (6.1 to 6.2); <br>0x40 </td>
    <td>0xA0 (6.1 to 6.2); <br>0x80 </td>
    <td>
    <pre class="source">PCWSTR STDMETHODCALLTYPE GetExeName (VOID);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x54 (6.1 to 6.2); <br>0x44 </td>
    <td>0xA8 (6.1 to 6.2); <br>0x88 </td>
    <td>
    <pre class="source">HRESULT STDMETHODCALLTYPE SetExeName (PCWSTR);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x58 (6.1 to 6.2); <br>0x48 </td>
    <td>0xB0 (6.1 to 6.2); <br>0x90 </td>
    <td>
    <pre class="source">PCWSTR STDMETHODCALLTYPE GetIconResource (VOID);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x5C (6.1 to 6.2); <br>0x4C </td>
    <td>0xB8 (6.1 to 6.2); <br>0x98 </td>
    <td>
    <pre class="source">PCWSTR STDMETHODCALLTYPE GetAppID (VOID);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x60 (6.1 to 6.2); <br>0x50 </td>
    <td>0xC0 (6.1 to 6.2); <br>0xA0 </td>
    <td>
    <pre class="source">PCWSTR STDMETHODCALLTYPE GetAppIDForSQM (VOID);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x64 (6.1 to 6.2); <br>0x54 </td>
    <td>0xC8 (6.1 to 6.2); <br>0xA8 </td>
    <td>
    <pre class="source">HRESULT STDMETHODCALLTYPE SetAppID (PCWSTR);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x68 (6.1 to 6.2); <br>0x58 </td>
    <td>0xD0 (6.1 to 6.2); <br>0xB0 </td>
    <td>
    <pre class="source">BOOL STDMETHODCALLTYPE ShouldLog (VOID);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td rowspan="2">0x6C (6.1 to 6.3); <br>0x5C </td>
    <td rowspan="2">0xD8 (6.1 to 6.3); <br>0xB8 </td>
    <td>
    <pre class="source">DWORD STDMETHODCALLTYPE GetFlags (VOID);</pre>
    </td>
    <td>6.1 to 6.2 </td>
  </tr>
  <tr>
    <td>
    <pre class="source">DWORD STDMETHODCALLTYPE GetFlags (VOID) const;</pre>
    </td>
    <td>6.3 and higher </td>
  </tr>
  <tr>
    <td>0x70 (6.1 to 6.3); <br>0x60 </td>
    <td>0xE0 (6.1 to 6.3); <br>0xC0 </td>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
UpdateFlags (
    DWORD, 
    DWORD);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x74 (6.1 to 6.3); <br>0x64 </td>
    <td>0xE8 (6.1 to 6.3); <br>0xC8 </td>
    <td>
    <pre class="source">HRESULT STDMETHODCALLTYPE GetLastActiveItem (ITaskItem **);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td rowspan="3">0x78 (6.1 to 6.3); <br>0x68 </td>
    <td rowspan="3">0xF0 (6.1 to 6.3); <br>0xD0 </td>
    <td>
    <pre class="source">HRESULT STDMETHODCALLTYPE GroupMenuCommand (INT);</pre>
    </td>
    <td>6.1 only </td>
  </tr>
  <tr>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
GroupMenuCommand (
    HMONITOR, 
    INT);</pre>
    </td>
    <td>6.2 to 6.3 </td>
  </tr>
  <tr>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
GroupMenuCommand (
    ITaskItemFilter *, 
    INT);</pre>
    </td>
    <td>10.0 and higher </td>
  </tr>
  <tr>
    <td>0x7C (6.1 to 6.3); <br>0x6C </td>
    <td>0xF8 (6.1 to 6.3); <br>0xD8 </td>
    <td>
    <pre class="source">HRESULT STDMETHODCALLTYPE SetTip (PCWSTR);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x70 </td>
    <td>0xE0 </td>
    <td>
    <pre class="source">DWORD STDMETHODCALLTYPE GetFirstOpenedItem (VOID);</pre>
    </td>
    <td>10.0 and higher </td>
  </tr>
  <tr>
    <td>0x80 (6.1 to 6.3) </td>
    <td>0x0100 (6.1 to 6.3) </td>
    <td>
    <pre class="source">PCIDLIST_ABSOLUTE STDMETHODCALLTYPE GetShortcutIDList (VOID);</pre>
    </td>
    <td>6.1 to 6.3 </td>
  </tr>
  <tr>
    <td>0x84 (6.1 to 6.3); <br>0x74 </td>
    <td>0x0108 (6.1 to 6.3); <br>0xE8 </td>
    <td>
    <pre class="source">HRESULT STDMETHODCALLTYPE SetShortcutIDList (PCIDLIST_ABSOLUTE);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x88 (6.1 to 6.3); <br>0x78 </td>
    <td>0x0110 (6.1 to 6.3); <br>0xF0 </td>
    <td>
    <pre class="source">PIDLIST_ABSOLUTE STDMETHODCALLTYPE GetApplicationIDList (VOID);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x8C (6.1 to 6.3); <br>0x7C </td>
    <td>0x0118 (6.1 to 6.3); <br>0xF8 </td>
    <td>
    <pre class="source">HRESULT 
STDMETHODCALLTYPE 
RemoveTabs (
    ITaskItem *, 
    INT, 
    VOID (STDAPICALLTYPE *) (ULONG_PTR, HWND), 
    ULONG_PTR);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x90 (6.1 to 6.3); <br>0x80 </td>
    <td>0x0120 (6.1 to 6.3); <br>0x0100 </td>
    <td>
    <pre class="source">HICON STDMETHODCALLTYPE GetOverlayIcon (VOID);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x94 (6.1 to 6.3); <br>0x84 </td>
    <td>0x0128 (6.1 to 6.3); <br>0x0108 </td>
    <td>
    <pre class="source">PCWSTR STDMETHODCALLTYPE GetOverlayIconDescription (VOID);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x98 (6.1 to 6.3); <br>0x88 </td>
    <td>0x0130 (6.1 to 6.3); <br>0x0110 </td>
    <td>
    <pre class="source">BOOL STDMETHODCALLTYPE IsAppPinnable (VOID);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0x9C (6.1 to 6.3); <br>0x8C </td>
    <td>0x0138 (6.1 to 6.3); <br>0x0118 </td>
    <td>
    <pre class="source">BOOL STDMETHODCALLTYPE IsAppLaunchable (VOID);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0xA0 (6.1 to 6.3); <br>0x90 </td>
    <td>0x0140 (6.1 to 6.3); <br>0x0120 </td>
    <td>
    <pre class="source">BOOL STDMETHODCALLTYPE HasDestinations (VOID);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0xA4 (6.1 to 6.3); <br>0x94 </td>
    <td>0x0148 (6.1 to 6.3); <br>0x0128 </td>
    <td>
    <pre class="source">BOOL STDMETHODCALLTYPE HasDestinationsMenu (VOID);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0xA8 (6.1 to 6.3); <br>0x98 </td>
    <td>0x0150 (6.1 to 6.3); <br>0x0130 </td>
    <td>
    <pre class="source">HRESULT STDMETHODCALLTYPE SetPinnableAndLaunchable (BOOL);</pre>
    </td>
    <td>6.1 and higher </td>
  </tr>
  <tr>
    <td>0xAC (6.2 to 6.3); <br>0x9C </td>
    <td>0x0158 (6.2 to 6.3); <br>0x0138 </td>
    <td>
    <pre class="source">VOID STDMETHODCALLTYPE SetVisualOrder (INT);</pre>
    </td>
    <td>6.2 and higher </td>
  </tr>
  <tr>
    <td>0xB0 (6.2 to 6.3); <br>0xA0 </td>
    <td>0x0160 (6.2 to 6.3); <br>0x0140 </td>
    <td>
    <pre class="source">INT STDMETHODCALLTYPE GetVisualOrder (VOID);</pre>
    </td>
    <td>6.2 and higher </td>
  </tr>
  <tr>
    <td>0xA4 </td>
    <td>0x0148 </td>
    <td>
    <pre class="source">bool STDMETHODCALLTYPE IsImmersiveGroup (VOID);</pre>
    </td>
    <td>10.0 and higher </td>
  </tr>
  <tr>
    <td>0xA8 </td>
    <td>0x0150 </td>
    <td>
    <pre class="source">bool STDMETHODCALLTYPE HasItemsOnCurrentDesktop (VOID);</pre>
    </td>
    <td>10.0 and higher </td>
  </tr>
</table>
<p>Among the types that can be passed as arguments or be produced at addresses that 
are passed as arguments, <span class="interface">IEnumTaskItems</span>,
<span class="interface">ITaskItem</span> and <span class="interface">ITaskItemFilter</span> 
are undocumented COM interfaces and <span class="enum">WINDOWMATCHCONFIDENCE</span> 
is an undocumented enumeration. </p>
<div class="Footer">
  <p class="Dates">This page was created on 10th February 2018 but was not published 
  until 13th June 2018. </p>
  <!--webbot bot="Include" U-Include="../../_include/c18.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2018. Geoff Chappell. All rights reserved.
<a href="../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="53227" -->
</div>

</body>

</html>
