<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>CURDIR</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <!--webbot bot="Include" U-Include="../../../../_include/preview.htm" TAG="BODY" startspan -->

<div class="Header">
  <p class="alert">CURRENT WORK ITEM - PREVIEW ONLY </p>
</div>

<!--webbot bot="Include" endspan i-checksum="8381" -->
  <h1>CURDIR </h1>
  <p>The <span class="struct">CURDIR</span> structure (formally
  <span class="struct">_CURDIR</span>) is a small structure that is known only within 
  the <span class="struct"><a href="rtl_user_process_parameters.htm">RTL_USER_PROCESS_PARAMETERS</a></span>. 
  It there models its process’s notion of a current directory. </p>
  <p>The <span class="struct">CURDIR</span> is 0x0C and 0x18 bytes in 32-bit and 
  64-bit Windows, respectively. </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00 </td>
        <td>0x00 </td>
        <td>
        <pre class="source">UNICODE_STRING DosPath;</pre>
        </td>
        <td>all </td>
      </tr>
      <tr>
        <td>0x08 </td>
        <td>0x10 </td>
        <td>
        <pre class="source">HANDLE Handle;</pre>
        </td>
        <td>all </td>
      </tr>
    </tbody>
  </table>
  <p>The <span class="member">Handle</span> member records that Windows ordinarily 
  keeps an open file handle to a process’s current directory. This is a useful optimisation 
  for programs that are aware of having a current directory and may use relative 
  pathnames when working with files. It can be problematic for programs that have 
  no such awareness or do not provide easy means of changing the current directory. 
  For instance, open a Command Prompt, create a directory, make it the current directory, 
  run a simple program such as Notepad, change the Command Prompt to some other 
  current directory and then try to remove the created directory: </p>
  <pre class="input">md <span class="placeholder">path</span>\test
cd <span class="placeholder">path</span>\test
notepad
cd ..
rd test</pre>
  <p>You can expect to be told something like </p>
  <pre class="output">The process cannot access the file because it is being used by another process.</pre>
  <p>In this case, Notepad has the created directory open as Notepad’s current directory. 
  In real-world use of Windows it can be far from obvious what can be this “another 
  process.” </p>
  <div class="Footer">
    <p class="Dates">This page was created on 4th
    <a href="../../../../../../../new/22/07.htm">August 2022</a>. </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c22.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2022. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="5890" -->
  </div>
</div>

</body>

</html>
