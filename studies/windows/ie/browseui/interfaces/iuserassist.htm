<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>IUserAssist</title>
<link rel="stylesheet" type="text/css" href="../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../_styles/ie.css">
<script type="text/javascript" src="../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../_scripts/ie.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="30135" endspan -->
<h1>IUserAssist </h1>
<table>
  <tr>
    <td rowspan="2"><span class="symbol">IID_IUserAssist</span> </td>
    <td><span class="iid">{DD313E05-FEFF-11D1-8ECD-0000F87A470C}</span> </td>
    <td>original </td>
  </tr>
  <tr>
    <td><span class="iid">{3593D04B-BAD0-4B9C-866E-CC074B2DD44A}</span> </td>
    <td>revised </td>
  </tr>
</table>
<p>The original <span class="interface">IUserAssist</span> methods are (as ordered 
in the virtual function table after the <span class="interface">IUnknown</span> 
methods): </p>
<table class="Struct">
  <colgroup>
    <col class="Offset"><col class="Name">
  </colgroup>
  <tr>
    <th>Offset </th>
    <th>Method </th>
  </tr>
  <tr>
    <td>0x0C </td>
    <td><span class="method">FireEvent</span> </td>
  </tr>
  <tr>
    <td>0x10 </td>
    <td><span class="method">QueryEvent</span> </td>
  </tr>
  <tr>
    <td>0x14 </td>
    <td><span class="method">SetEvent</span> </td>
  </tr>
</table>
<p>with prototypes: </p>
<pre class="source">HRESULT FireEvent (GUID const *, INT, ULONG, WPARAM, LPARAM);</pre>
<pre class="source">HRESULT QueryEvent (GUID const *, INT, WPARAM, LPARAM, UEMINFO *);</pre>
<pre class="source">HRESULT SetEvent (GUID const *, INT, WPARAM, LPARAM, UEMINFO *);</pre>
<p>in which <span class="struct">UEMINFO</span> is an undocumented structure.
</p>
<p>The revision adds one method: </p>
<table class="Struct">
  <colgroup>
    <col class="Offset"><col class="Name">
  </colgroup>
  <tr>
    <th>Offset </th>
    <th>Method </th>
  </tr>
  <tr>
    <td>0x18 </td>
    <td><span class="method">Enable</span> </td>
  </tr>
</table>
<p>It has the prototype: </p>
<pre class="source">HRESULT Enable (BOOL);</pre>
<h2>Implementation </h2>
<p>The only known implementation is in BROWSEUI.DLL (reproduced in IEFRAME.DLL in 
Windows Vista) for the <span class="class">UserAssist</span> class. Instances are 
creatable through the following CLSID: </p>
<table>
  <tr>
    <td rowspan="2"><span class="constant">CLSID_UserAssist</span> </td>
    <td><span class="clsid">{DD313E04-FEFF-11D1-8ECD-0000F87A470C}</span> </td>
    <td>BROWSEUI </td>
  </tr>
  <tr>
    <td><span class="clsid">{FAC3CBF6-8697-43D0-BAB9-DCD1FCE19D75}</span> </td>
    <td>IEFRAME </td>
  </tr>
</table>
<p>As actually implemented, creating an instance through COM just obtains access 
to a single instance which is shared among all clients. </p>
<h2>Availability </h2>
<p>The <span class="interface">IUserAssist</span> interface is implemented in BROWSEUI.DLL 
version 5.0 and higher, and in IEFRAME.DLL version 7.0 and higher. The revision 
begins with the BROWSEUI version 6.0 from Windows Vista and with IEFRAME. </p>
<!--webbot bot="Include" U-Include="_include/undoc500.htm" TAG="BODY" startspan -->

<p>Though this interface dates from as long ago as 1999, it was still not documented 
by Microsoft as late as the January 2004 edition of the MSDN Library on CD. </p>

<!--webbot bot="Include" i-checksum="63350" endspan -->
<p>Since Microsoft feels free to change the IID and methods for
<span class="interface">IUserAssist</span> without changing the name, the suggestion 
is strong that Microsoft regards this interface as internal. But internal to what? 
The first implementation is in BROWSEUI from Internet Explorer 5.0 and the first 
use is by SHDOCVW from that version. Yet beginning with Windows 2000, the interface 
is also used by the Windows Explorer to maintain the list of recently opened programs 
on the simple Start Menu, i.e., for purposes that have nothing to do with the Internet. 
So, is <span class="interface">IUserAssist</span> a Windows interface used by Internet 
Explorer or an Internet Explorer interface used by Windows? Windows Vista separates 
the uses for the Windows Explorer and Internet Explorer, one into BROWSEUI and the 
other into IEFRAME, with a different CLSID for each (though with the one symbol 
for both). </p>
<div class="Footer">
  <p class="Dates">This page was created on 25th June 2009 and was last modified 
  on 28th June 2009. </p>
  <!--webbot bot="Include" U-Include="../../_include/c09.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2009. Geoff Chappell. All rights reserved. 
<a href="../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="47519" endspan -->
</div>

</body>

</html>
