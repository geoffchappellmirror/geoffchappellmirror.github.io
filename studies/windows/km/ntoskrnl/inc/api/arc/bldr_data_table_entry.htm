<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>BLDR_DATA_TABLE_ENTRY</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <h1>BLDR_DATA_TABLE_ENTRY </h1>
  <p>The <span class="struct">BLDR_DATA_TABLE_ENTRY</span> (formally
  <span class="struct">_BLDR_DATA_TABLE_ENTRY</span>) is the boot loader’s description 
  of a binary that it loaded in advance of the kernel’s execution. It is here thought 
  to date from version 6.2. In earlier versions, the boot loader uses the same
  <span class="struct">KLDR_DATA_TABLE_ENTRY</span> as does the kernel. Go far enough 
  back and both the boot loader and kernel use the same <span class="struct">LDR_DATA_TABLE_ENTRY</span> 
  as does NTDLL. </p>
  <h2>Documentation Status </h2>
  <p>Though Microsoft is not known ever to have documented the
  <span class="struct">BLDR_DATA_TABLE_ENTRY</span>, Microsoft has published a C-language 
  definition. This was in a header named <a href="../../../source/inc/arc.htm">arc.h</a> 
  in the Windows Driver Kit (WDK) for the original and 1511 releases of Windows 
  10. It must be noted, however, that this publication looks for all the world like 
  an accidental disclosure. The header is in a subdirectory (named “minwin”) of 
  a directory named “um” as if for user-mode programming, but the
  <span class="struct">BLDR_DATA_TABLE_ENTRY</span>, if not everything else in the 
  header, is long gone by the time any user-mode code gets to execute. Mistake or 
  not, the header then disappeared from the WDK. </p>
  <p>Even while its C-language definitions were published, the
  <span class="struct">BLDR_DATA_TABLE_ENTRY</span> did not appear in public symbol 
  files—not for the kernel, nor in any other symbol files in the downloadable packages 
  of public symbols. </p>
  <h2>Layout </h2>
  <p>The <span class="struct">BLDR_DATA_TABLE_ENTRY</span> seems not to have changed 
  at all, in terms of its members and definitions, since version 6.2 introduced 
  it by appending members to the <span class="struct">KLDR_DATA_TABLE_ENTRY</span>. 
  It is 0x8C and 0xE8 bytes in 32-bit and 64-bit Windows, respectively, at least 
  to the 2004 release of WIndows 10. </p>
  <p>Offsets and Microsoft’s definitions are known from the published ARC.H for 
  two releases of Windows. Confirmation for other versions, starting from Windows 
  8 but ending with the 1903 release of Windows 10, is given by type information 
  in a statically linked library named CLFSMGMT.LIB which Microsoft publishes with 
  the Software Development Kit (SDK). </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00 </td>
        <td>0x00 </td>
        <td>
        <pre class="source">KLDR_DATA_TABLE_ENTRY KldrEntry;</pre>
        </td>
        <td>6.2 and higher </td>
      </tr>
      <tr>
        <td>0x5C </td>
        <td>0xA0 </td>
        <td>
        <pre class="source">UNICODE_STRING CertificatePublisher;</pre>
        </td>
        <td>6.2 and higher </td>
      </tr>
      <tr>
        <td>0x64 </td>
        <td>0xB0 </td>
        <td>
        <pre class="source">UNICODE_STRING CertificateIssuer;</pre>
        </td>
        <td>6.2 and higher </td>
      </tr>
      <tr>
        <td>0x6C </td>
        <td>0xC0 </td>
        <td>
        <pre class="source">PVOID ImageHash;</pre>
        </td>
        <td>6.2 and higher </td>
      </tr>
      <tr>
        <td>0x70 </td>
        <td>0xC8 </td>
        <td>
        <pre class="source">PVOID CertificateThumbprint;</pre>
        </td>
        <td>6.2 and higher </td>
      </tr>
      <tr>
        <td>0x74 </td>
        <td>0xD0 </td>
        <td>
        <pre class="source">ULONG ImageHashAlgorithm;</pre>
        </td>
        <td>6.2 and higher </td>
      </tr>
      <tr>
        <td>0x78 </td>
        <td>0xD4 </td>
        <td>
        <pre class="source">ULONG ThumbprintHashAlgorithm;</pre>
        </td>
        <td>6.2 and higher </td>
      </tr>
      <tr>
        <td>0x7C </td>
        <td>0xD8 </td>
        <td>
        <pre class="source">ULONG ImageHashLength;</pre>
        </td>
        <td>6.2 and higher </td>
      </tr>
      <tr>
        <td>0x80 </td>
        <td>0xDC </td>
        <td>
        <pre class="source">ULONG CertificateThumbprintLength;</pre>
        </td>
        <td>6.2 and higher </td>
      </tr>
      <tr>
        <td>0x84 </td>
        <td>0xE0 </td>
        <td>
        <pre class="source">ULONG LoadInformation;</pre>
        </td>
        <td>6.2 and higher </td>
      </tr>
      <tr>
        <td>0x88 </td>
        <td>0xE4 </td>
        <td>
        <pre class="source">ULONG Flags;</pre>
        </td>
        <td>6.2 and higher </td>
      </tr>
    </tbody>
  </table>
  <p>That the following bits are defined for the <span class="member">Flags</span> 
  is known from the published ARC.H: </p>
  <table class="Flags">
    <colgroup>
      <col class="Mask"><col class="Name"><col class="Versions">
    </colgroup>
    <thead>
      <tr>
        <th>Mask </th>
        <th>Name </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00000001 </td>
        <td><span class="constant">BLDR_FLAGS_CORE_DRIVER_DEPENDENT_DLL</span>
        </td>
        <td>6.2 and higher </td>
      </tr>
      <tr>
        <td>0x00000002 </td>
        <td><span class="constant">BLDR_FLAGS_CORE_EXTENSION_DEPENDENT_DLL</span>
        </td>
        <td>10.0 and higher </td>
      </tr>
    </tbody>
  </table>
  <p>As for which versions have which flags, this is from inspection of binaries. 
  For whether later releases of Windows 10 define more flags (or even use more), 
  further study is required. </p>
  <div class="Footer">
    <p class="Dates">This page was created on 24th December 2022 but was not published 
    until 29th <a href="../../../../../../../new/22/12.htm">January 2023</a>.
    </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c23.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2023. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="6018" -->
  </div>
</div>

</body>

</html>
