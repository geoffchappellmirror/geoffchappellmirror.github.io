<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>IBrowserThreadState</title>
<link rel="stylesheet" type="text/css" href="../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../_styles/ie.css">
<script type="text/javascript" src="../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../_scripts/ie.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="30135" endspan -->
<h1>IBrowserThreadState </h1>
<p>This interface is implemented in IEFRAME and seems new to Windows Vista. 
Closer inspection may reveal it or something similar in some other module in an 
earlier Windows version. The IID is: </p>
<table>
  <tr>
    <td><span class="interface">IBrowserThreadState</span> </td>
    <td><span class="iid">{CCD6F2EB-D12A-40C7-8683-509F1C818EAE}</span> </td>
  </tr>
</table>
<p>This interface is not completely undocumented. It doesn’t get even a 
declaration in any Windows SDK header, but the corresponding <span class="iid">
IID_IBrowserThreadState</span> 
is defined in the UUID.LIB library. </p>
<h2>Methods </h2>
<p>The <span class="interface">IBrowserThreadState</span> methods are: </p>
<table class="Struct">
  <colgroup>
    <col class="Offset"><col class="Name">
  </colgroup>
  <tr>
    <th>Offset </th>
    <th>Method </th>
  </tr>
  <tr>
    <td>0x0C </td>
    <td><span class="method">QueryDownloadPromptAllowed</span> </td>
  </tr>
  <tr>
    <td>0x10 </td>
    <td><span class="method">IncrementUserActionID</span> </td>
  </tr>
  <tr>
    <td>0x14 </td>
    <td><span class="method">GetUserActionID</span> </td>
  </tr>
  <tr>
    <td>0x18 </td>
    <td><span class="method">GetLastHookTime</span> </td>
  </tr>
  <tr>
    <td>0x1C </td>
    <td><span class="method">SetParentThreadID</span> </td>
  </tr>
  <tr>
    <td>0x20 </td>
    <td><span class="method">RegisterHookEvents</span> </td>
  </tr>
</table>
<h3>Prototypes </h3>
<p>The following are known from Microsoft’s symbol file for IEFRAME: </p>
<pre class="source">HRESULT QueryDownloadPromptAllowed (ULONG);</pre>
<pre class="source">HRESULT IncrementUserActionID (VOID);</pre>
<pre class="source">HRESULT GetUserActionID (ULONG *);</pre>
<pre class="source">HRESULT GetLastHookTime (HWND, ULONG *);</pre>
<pre class="source">HRESULT SetParentThreadID (ULONG);</pre>
<pre class="source">HRESULT RegisterHookEvents (IBrowserHookEvents *, ULONG, ULONG, ULONG);</pre>
<p>Of course, the <span class="interface">IBrowserHookEvents</span> interface is 
undocumented also. </p>
<h2>Implementations </h2>
<p>The only known implementation is by the <span class="coclass">
BrowserThreadState</span> 
class, which IEFRAME exposes through its <span class="function">
DllGetClassObject</span> 
function as if for the following IDL declaration: </p>
<pre class="source">[
    uuid (A6B222AB-A5EA-4899-B230-084657EDDC7D)
]
coclass BrowserThreadState
{
    [default] interface IBrowserThreadState;
};</pre>
<p>This too is undocumented, though the <span class="clsid">
CLSID_BrowserThreadState</span> 
symbol is defined in the UUID.LIB library. The only known use is from MSHTML.
</p>
<div class="Footer">
  <p class="Dates">This page was created on 13th March 2008. </p>
  <!--webbot bot="Include" U-Include="../../_include/c08.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2008. Geoff Chappell. All rights reserved. 
<a href="../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="47391" endspan -->
</div>

</body>

</html>