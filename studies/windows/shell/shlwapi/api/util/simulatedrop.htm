<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SHSimulateDrop</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>SHSimulateDrop </h1>
<p>This function performs a drag and drop on a given drop target. </p>
<h2>Declaration </h2>
<pre class="source">HRESULT 
SHSimulateDrop (
    IDropTarget *pDropTarget, 
    IDataObject *pDataObj, 
    DWORD grfKeyState, 
    POINTL *pt, 
    DWORD *pdwEffect);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">pDropTarget</span> argument describes an object that 
receives data in a drag-and-drop operation. </p>
<p>The <span class="argument">pDataObj</span> argument describes the source data.
</p>
<p>The <span class="argument">grfKeyState</span> argument is a set of bit flags 
to describe control keys that modify the drag-and-drop. </p>
<p>The <span class="argument">pt</span> argument is the address of a structure that 
provides the cursor position, measured in screen coordinates. This argument can 
be NULL to represent the screen origin. </p>
<p>The <span class="argument">pdwEffect</span> argument is the address of a variable 
that provides input and receives output. On input, bits in the variable specify 
the permitted drop effects. On output, the variable indicates which effect applied. 
This argument can be NULL to imply the combination of <span class="constant">DROPEFFECT_COPY</span>,
<span class="constant">DROPEFFECT_MOVE</span> and <span class="constant">DROPEFFECT_LINK</span>.
</p>
<h3>Return Value </h3>
<!--webbot bot="Include" U-Include="../_include/hresult.htm" TAG="BODY" startspan -->

<p>The function returns zero for success, else an error code. </p>

<!--webbot bot="Include" i-checksum="1551" endspan -->
<h2>Behaviour </h2>
<p>This function is a utility for calling the drop target’s methods in a reliable 
way to effect a transfer from the data object to the drop target. The arguments 
correspond closely with those of the <span class="method">DragEnter</span> and
<span class="method">Drop</span> methods. For the supported values of the
<span class="argument">grfKeyState</span> argument and of the variable that is addressed 
by the <span class="argument">pdwEffect</span> argument, refer to the documentation 
of those methods. </p>
<p>The function first calls the drop target’s <span class="method">DragEnter</span> 
method. If the <span class="argument">pt</span> or <span class="argument">pdwEffect</span> 
arguments are NULL, the function supplies dummies. </p>
<p>If the <span class="method">DragEnter</span> method selects
<span class="constant">DROPEFFECT_NONE</span> as the effect it can produce, then 
the function abandons the drop. It calls the drop target’s <span class="method">
DragLeave</span> method and returns <span class="constant">S_FALSE</span>. The variable 
at <span class="argument">pdwEffect</span>, if provided, receives
<span class="constant">DROPEFFECT_NONE</span>. </p>
<p>Otherwise, the function proceeds to the drop target’s <span class="method">Drop</span> 
method and returns its results. </p>
<h2>Availability </h2>
<p>The <span class="function">SHSimulateDrop</span> function is exported from SHLWAPI.DLL 
as ordinal 186 in version 5.00 and higher. </p>
<!--webbot bot="Include" U-Include="../_include/undoc500-2007.htm" TAG="BODY" startspan -->

<p>Though this function dates from as long ago as 1999, it was still not documented 
by Microsoft as late as the January 2007 edition of the Windows Vista Software Development 
Kit (SDK). </p>

<!--webbot bot="Include" i-checksum="62277" endspan -->
<div class="Footer">
  <p class="Dates">This page was created on 28th July 2009. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c09.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2009. Geoff Chappell. All rights reserved.
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="50766" endspan -->
</div>

</body>

</html>