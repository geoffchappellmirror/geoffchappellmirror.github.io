<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>HviGetHypervisorFeatures</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <h1>HviGetHypervisorFeatures </h1>
  <p>The <span class="function">HviGetHypervisorFeatures</span> function obtains 
  the output of a Microsoft-compatible hypervisor’s <span class="instruction">
  <a href="../../../../cpu/cpuid/index.htm">cpuid</a></span> leaf 0x40000003.
  </p>
  <h2>Declaration </h2>
  <pre class="source">VOID HviGetHypervisorFeatures (<a href="../../../inc/shared/hvgdk_mini/hv_hypervisor_features.htm">HV_HYPERVISOR_FEATURES</a> *);</pre>
  <h3>Parameters </h3>
  <p>The one argument provides the address of a structure that is to receive the
  <span class="instruction">cpuid</span> output. </p>
  <h3>Platform </h3>
  <p>The <span class="macro">HV_HYPERVISOR_FEATURES</span> in the declaration is 
  hypothesised as Microsoft’s macro that stands for an appropriate processor-specific 
  structure. For both the x86 (i386) and x64 (amd64) processors, this structure 
  is named <span class="struct">
  <a href="../../../inc/shared/hvgdk_mini/hv_x64_hypervisor_features.htm">HV_X64_HYPERVISOR_FEATURES</a></span>. 
  Microsoft is known to define an <span class="struct">HV_ARM64_HYPERVISOR_FEATURES</span> 
  structure when building for other processors, but this lies (far) outside the 
  scope of this website. </p>
  <h2>Availability </h2>
  <p>The <span class="function">HviGetHypervisorFeatures</span> function is exported 
  by name from the kernel in version 10.0 and higher. </p>
  <h3>History </h3>
  <p>The version 6.3 kernel has an inline routine that is coded very similarly to 
  the version 10.0 <span class="function">HviGetHypervisorFeatures</span>. Public 
  symbol files for the version 6.3 kernel confirm that this earlier kernel has an 
  inline routine that was already named <span class="inline routine">HviGetHypervisorFeatures</span> 
  and had as its one argument a pointer to what was then the
  <span class="struct">HV_HYPERVISOR_FEATURES</span> structure. That the inline 
  routine in the binary is the same as named in the symbol files which is in turn 
  the origin of the exported function must be all but certain. </p>
  <h2>Documentation Status </h2>
  <p>The <span class="function">HviGetHypervisorFeatures</span> function is not 
  documented. </p>
  <h2>Behaviour </h2>
  <p>If a hypervisor is present and implements Microsoft’s interface—see
  <span class="function"><a href="ishypervisormicrosoftcompatible.htm">HviIsHypervisorMicrosoftCompatible</a></span>—then 
  the function copies to the given address whatever <span class="instruction">cpuid</span> 
  leaf 0x40000003 produces in the <span class="register">eax</span>,
  <span class="register">ebx</span>, <span class="register">ecx</span> and
  <span class="register">edx</span> registers. </p>
  <p>Otherwise, the structure at the given address is zeroed. This, in effect, is 
  the function’s indication of failure. </p>
  <div class="Footer">
    <p class="Dates">This page was created on 19th
    <a href="../../../../../../../new/16/11.htm">November 2016</a> and was last 
    modified on 29th <a href="../../../../../../../new/22/10.htm">November 2022</a>.
    </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c1622.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2016-2022. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="4925" -->
  </div>
</div>

</body>

</html>
