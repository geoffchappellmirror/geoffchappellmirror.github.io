<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>FrontPage Uninstalls File Types</title>
<link rel="stylesheet" type="text/css" href="../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../_styles/notes.css">
<script type="text/javascript" src="../../_scripts/master.js"></script>
<script type="text/javascript" src="../../_scripts/document.js"></script>
<script type="text/javascript" src="../_scripts/notes.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript Header" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="44630" -->
<div class="Main">
  <h1>FrontPage Uninstalls File Types </h1>
  <p>That software can be installed and uninstalled, over and over, often with no 
  apparent harm, seems miraculous to me. Indeed, I don’t believe it. The exercise 
  is straightforward enough when a program installs its own files and registry entries, 
  etc, that are no other software’s business. Where things get complicated, possibly 
  without a well-defined solution, is with resources that are potentially of interest 
  to multiple programs. </p>
  <h2>Problem </h2>
  <p>Uninstalling Microsoft FrontPage 2002 from Windows Vista deletes registry keys 
  for the following file types: </p>
  <ul>
    <li>.asp </li>
    <li>.gif </li>
    <li>.htx </li>
    <li>.jpg </li>
    <li>.png </li>
  </ul>
  <p>With these file types unregistered, you may notice odd behaviour in any number 
  of programs. Perhaps most readily noticed will be that the Windows Explorer and 
  the common dialogs for browsing files and folders will show the plain file icon
  <img class="icon" alt="File Icon" src="_images/fileicon.gif" width="16" height="16"> 
  for GIF, JPG and PNG files instead of the more helpful
  <img class="icon" alt="GIF Icon" src="_images/gificon.png" width="16" height="14">,
  <img class="icon" alt="JPG Icon" src="_images/jpgicon.png" width="16" height="14"> 
  and
  <img class="icon" alt="PNG Icon" src="_images/pngicon.png" width="16" height="14">. 
  Another example is that <a href="../windows/help/lostimages.htm">pictures are 
  missing in Windows Help and Support</a>. </p>
  <h2>Cause </h2>
  <p>When installing, FrontPage sets its own values in the registry keys associated 
  with each of these file types. When uninstalling, FrontPage deletes each key, 
  apparently not aware or not caring that the key existed before FrontPage’s installation 
  or may have been modified by other software since. It’s hard to escape the notion 
  that FrontPage’s programmers thought to treat these file types as FrontPage’s 
  own to configure however FrontPage wants. This is at least a little odd, on top 
  of being presumptuous, given that each of these file types has at least some registry 
  entries even in a clean Windows installation, in all versions from at least Windows 
  2000. </p>
  <p>Incidentally, installing and uninstalling FrontPage exposes two other types 
  of potential error. First, registry keys for the following file types are deleted 
  when installing FrontPage but are not restored when uninstalling: </p>
  <ul>
    <li>.csv </li>
    <li>.pps </li>
    <li>.scd </li>
    <li>.sch </li>
  </ul>
  <p>Second, installing FrontPage adds registry keys for the following file types, 
  which remain after uninstalling: </p>
  <ul>
    <li>.dcs </li>
    <li>.ecs </li>
    <li>.fcs </li>
    <li>.ncs </li>
    <li>.tcs </li>
    <li>.wcs </li>
  </ul>
  <p>As if to prove that none of this got much thought, the left-over registry entries 
  for these types are only partly valid: each has a <span class="regkey">DefaultIcon</span> 
  subkey that names a DLL as providing the default icon for the file type, but the 
  uninstaller has deleted the DLL. </p>
  <h2>Solution </h2>
  <p>Unfortunately, no simple solution exists that is certain for all cases. If 
  the registry keys for a file type are gone completely, then at least some solution 
  is obtained by restoring the keys as if Windows were freshly installed. Of course, 
  this can do nothing for registry entries that were added by other programs.
  </p>
  <p>The following table provides links to Registration Entries (REG) files that 
  arrange a clean refresh for each file type and show which registry keys are affected. 
  Before downloading any of these settings files, much less attempting to use them, 
  start the Registry Editor, browse for the applicable keys and verify their absence. 
  Otherwise, the effect of restoring their initial settings depends on what is now 
  in the keys and is not generally predictable. </p>
  <p>If you are concerned for the security implications of downloading a file that 
  may change your computer’s configuration, and I suggest strongly that you should 
  be, then save the settings file instead of opening it, and inspect it using Notepad 
  to check that all it does is specify entries for the applicable keys. Note anyway 
  that you need administrative privilege to install these registry settings. </p>
  <table>
    <tr>
      <td><a href="_download/asp.reg">Clean Registration Entries for the ASP File 
      Type</a> </td>
      <td><span class="regkey">HKEY_CLASSES_ROOT\.asp</span> <br>
      <span class="regkey">HKEY_CLASSES_ROOT\aspfile</span> </td>
    </tr>
    <tr>
      <td><a href="_download/gif.reg">Clean Registration Entries for the GIF File 
      Type</a> </td>
      <td><span class="regkey">HKEY_CLASSES_ROOT\.gif</span> <br>
      <span class="regkey">HKEY_CLASSES_ROOT\giffile</span> </td>
    </tr>
    <tr>
      <td><a href="_download/htx.reg">Clean Registration Entries for the HTX File 
      Type</a> </td>
      <td><span class="regkey">HKEY_CLASSES_ROOT\.htx</span> </td>
    </tr>
    <tr>
      <td><a href="_download/jpg.reg">Clean Registration Entries for the JPG File 
      Type</a> </td>
      <td><span class="regkey">HKEY_CLASSES_ROOT\.jpg</span> <br>
      <span class="regkey">HKEY_CLASSES_ROOT\jpegfile</span> </td>
    </tr>
    <tr>
      <td><a href="_download/png.reg">Clean Registration Entries for the PNG File 
      Type</a> </td>
      <td><span class="regkey">HKEY_CLASSES_ROOT\.png</span> <br>
      <span class="regkey">HKEY_CLASSES_ROOT\pngfile</span> </td>
    </tr>
  </table>
  <p>All these REG files are prepared for Windows Vista. Clean settings for earlier 
  Windows versions would differ, e.g., for the location of each file type’s default 
  icon, but the differences are beyond my interest for this note. </p>
  <p>The REG file for GIF files sets Internet Explorer as the default program for 
  opening GIF files. If your Internet Explorer is not installed in “C:\Program Files\Internet 
  Explorer”, you will have to edit either the REG file before using it or the default 
  value of <span class="regkey">HKEY_CLASSES_ROOT\giffile\shell\Open\command</span> 
  afterwards. </p>
  <p>If you want to refresh the keys for all the file types, then use
  <a href="_download/all.reg">Clean Registration Entries for File Types Uninstalled 
  by FrontPage 2002</a> (which is all the table’s REG files rolled into one).
  </p>
  <p>Note that Windows programs will typically not use the new settings immediately. 
  You may see mixed effects, possibly until your next logon. </p>
  <div class="Footer">
    <p class="Dates">This page was created on 10th December 2008 and was last modified 
    on 13th January 2010. </p>
    <!--webbot bot="Include" U-Include="../_include/c0810.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2008-2010. Geoff Chappell. All rights reserved. 
<a href="../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="44478" -->
  </div>
</div>

</body>

</html>
