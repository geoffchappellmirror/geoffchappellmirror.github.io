<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>IAssociationArray</title>
<link rel="stylesheet" type="text/css" href="../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../_styles/shell.css">
<script type="text/javascript" src="../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="30135" endspan -->
<h1>IAssociationArray </h1>
<table>
  <tr>
    <td rowspan="2"><span class="constant">IID_IAssociationArray</span> </td>
    <td><span class="iid">{3B877E3C-67DE-4F9A-B29B-17D0A1521C6A}</span> </td>
    <td>original </td>
  </tr>
  <tr>
    <td><span class="iid">{19ADBAFD-1C5F-4FC7-94EE-846702DFB58B}</span> </td>
    <td>revised </td>
  </tr>
</table>
<p>The original <span class="interface">IAssociationArray</span> methods are (as 
ordered in the virtual function table after the <span class="interface">IUnknown</span> 
methods): </p>
<table class="Struct">
  <colgroup>
    <col class="Offset"><col class="Name">
  </colgroup>
  <tr>
    <th>Offset </th>
    <th>Method </th>
  </tr>
  <tr>
    <td>0x0C </td>
    <td><span class="method">EnumElements</span> </td>
  </tr>
  <tr>
    <td>0x10 </td>
    <td><span class="method">QueryString</span> </td>
  </tr>
  <tr>
    <td>0x14 </td>
    <td><span class="method">QueryDword</span> </td>
  </tr>
  <tr>
    <td>0x18 </td>
    <td><span class="method">QueryExists</span> </td>
  </tr>
  <tr>
    <td>0x1C </td>
    <td><span class="method">QueryDirect</span> </td>
  </tr>
  <tr>
    <td>0x20 </td>
    <td><span class="method">QueryObject</span> </td>
  </tr>
</table>
<p>with prototypes; </p>
<pre class="source">HRESULT EnumElements (ULONG, IEnumAssociationElements **);</pre>
<pre class="source">HRESULT QueryString (ULONG, ASSOCQUERY, PCWSTR, PWSTR *);</pre>
<pre class="source">HRESULT QueryDword (ULONG, ASSOCQUERY, PCWSTR, DWORD *);</pre>
<pre class="source">HRESULT QueryExists (ULONG, ASSOCQUERY, PCWSTR);</pre>
<pre class="source">HRESULT QueryDirect (ULONG, ASSOCQUERY, PCWSTR, FLAGGED_BYTE_BLOB **);</pre>
<pre class="source">HRESULT QueryObject (ULONG, ASSOCQUERY, PCWSTR, REFIID, PVOID *);</pre>
<p>in which <span class="interface"><a href="ienumassociationelements.htm">IEnumAssociationElements</a></span> 
is an undocumented interface and <span class="enum">
<a href="../api/assocelem/query.htm">ASSOCQUERY</a></span> is invented as a
<span class="keyword">typedef</span> for an undocumented enumeration: </p>
<pre class="source">typedef enum tagASSOCQUERY ASSOCQUERY; </pre>
<p>The revision deletes one method, inserts another, and removes the first argument 
from each of the remaining methods. </p>
<table class="Struct">
  <colgroup>
    <col class="Offset"><col class="Name">
  </colgroup>
  <tr>
    <th>Offset </th>
    <th>Method </th>
  </tr>
  <tr>
    <td>0x0C </td>
    <td><span class="method">QueryString</span> </td>
  </tr>
  <tr>
    <td>0x10 </td>
    <td><span class="method">QueryDword</span> </td>
  </tr>
  <tr>
    <td>0x14 </td>
    <td><span class="method">QueryGuid</span> </td>
  </tr>
  <tr>
    <td>0x18 </td>
    <td><span class="method">QueryExists</span> </td>
  </tr>
  <tr>
    <td>0x1C </td>
    <td><span class="method">QueryDirect</span> </td>
  </tr>
  <tr>
    <td>0x20 </td>
    <td><span class="method">QueryObject</span> </td>
  </tr>
</table>
<p>with prototypes: </p>
<pre class="source">HRESULT QueryString (ASSOCQUERY, PCWSTR, PWSTR *);</pre>
<pre class="source">HRESULT QueryDword (ASSOCQUERY, PCWSTR, DWORD *);</pre>
<pre class="source">HRESULT QueryGuid (ASSOCQUERY, PCWSTR, GUID *);</pre>
<pre class="source">HRESULT QueryExists (ASSOCQUERY, PCWSTR);</pre>
<pre class="source">HRESULT QueryDirect (ASSOCQUERY, PCWSTR, FLAGGED_BYTE_BLOB **);</pre>
<pre class="source">HRESULT QueryObject (ASSOCQUERY, PCWSTR, REFIID, PVOID *);</pre>
<p>Note that the revision leaves <span class="interface">IAssociationArray</span> 
having exactly the same methods as the (revised) <span class="interface">
<a href="../../shlwapi/interfaces/iassociationelement.htm">IAssociationElement</a></span> 
interface which was simultaneously brought to SHELL32 from SHLWAPI. This is much 
the better design since it models well that to query the association array is just 
to query multiple elements as if to have queried whichever one element happens to 
provide the answer. </p>
<h2>Availability </h2>
<p>The <span class="interface">IAssociationArray</span> interface is implemented 
in SHELL32.DLL version 6.00 and higher. The revision begins with the version 6.00 
from Windows Vista. </p>
<!--webbot bot="Include" U-Include="_include/undoc600.htm" TAG="BODY" startspan -->

<p>Though this interface dates from 2001, it was still not documented by 
Microsoft as late as the January 2007 edition of the Windows Vista Software 
Development Kit (SDK). </p>

<!--webbot bot="Include" i-checksum="55133" endspan -->
<div class="Footer">
  <p class="Dates">This page was created on 20th July 2009 and was last modified 
  on 21st July 2009. </p>
  <!--webbot bot="Include" U-Include="../../_include/c09.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2009. Geoff Chappell. All rights reserved.
<a href="../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="53291" endspan -->
</div>

</body>

</html>
