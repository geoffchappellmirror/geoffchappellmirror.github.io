<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Restrictions</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" u-include="../../../../_include/noscript.htm" tag="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="14798" endspan -->
<h1>Restrictions </h1>
<p>From version 5.00 onwards, SHLWAPI provides a set of functions for supporting 
a common type of registry setting that appears to be called a
<span class="definition">restriction</span>. </p>
<ul>
  <li><span class="undocumented function"><a href="get.htm">SHGetRestriction</a></span>
  </li>
  <li><span class="undocumented function"><a href="messagebox.htm">SHRestrictedMessageBox</a></span> 
  (not in early builds of version 5.00) </li>
  <li><span class="undocumented function"><a href="lookup.htm">SHRestrictionLookup</a></span>
  </li>
</ul>
<p>Each restriction is implemented in the registry as a DWORD value at the same 
location in either of the <span class="regkey">HKEY_LOCAL_MACHINE</span> or
<span class="regkey">HKEY_CURRENT_USER</span> branches, the former having precedence. 
If the value is not present at either location, the restriction evaluates as zero.
</p>
<p>A registry value with these characteristics is most useful as a restriction if 
a non-zero value is interpreted as restricting some feature that would ordinarily 
be enabled, or even be taken for granted. If the location is one to which ordinary 
users do not have write access, then the restriction has the force of an administrative 
policy. However, it seems to be no business of SHLWAPI’s whether restrictions actually 
are used this way. A non-zero value might just as easily be interpreted as allowing 
some feature that would ordinarily be disabled. </p>
<p>The <span class="function">SHGetRestriction</span> function can get the value 
of any single restriction by naming it as a registry value and saying where to find 
it. </p>
<p>Greater utility comes from defining a set of restrictions. These can be spread 
throughout some registry key, even in different subkeys, with each value in the 
set being represented by an ID so that the names of keys, subkeys and values become 
implementation details. Not only can the <span class="function">SHRestrictionLookup</span> 
function get the value of any restriction in such a set, but it manages the set 
as one, including to cache the values (in memory provided by the caller) rather 
than keep querying the registry. </p>
<p>Should an operation initiated by a user conflict with some restriction, so that 
it cannot be permitted to proceed, then the <span class="function">SHRestrictedMessageBox</span> 
function is available for telling the user why in a standard way. </p>
<div class="Footer">
  <!--webbot bot="Include" u-include="../../../../_include/c0408.htm" tag="BODY" startspan -->

<p class="Copyright">Copyright © 2004-2008. Geoff Chappell. All rights reserved.
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="1394" endspan -->
</div>

</body>

</html>
