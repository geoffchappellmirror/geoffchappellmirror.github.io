<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SHGlobalCounterIncrement</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js">
</script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>SHGlobalCounterIncrement </h1>
<p>This function increments a <a href="index.htm">global counter</a>. </p>
<h2>Declaration </h2>
<pre class="source">LONG SHGlobalCounterIncrement (HANDLE hCounter);</pre>
<h3>Parameters </h3>
<!--webbot bot="Include" U-Include="_include/hcounter.htm" TAG="BODY" startspan -->

<p>The <span class="argument">hCounter</span> argument provides a handle to the 
global counter, as obtained through some earlier call to either
<span class="function"><a href="create.htm">SHGlobalCounterCreate</a></span> 
or <span class="function"><a href="createnamed.htm">
SHGlobalCounterCreateNamed</a></span>.
</p>

<!--webbot bot="Include" i-checksum="25661" endspan -->
<h3>Return Value </h3>
<p>The function returns the value that the counter got incremented to. </p>
<h2>Behaviour </h2>
<p>The global counter is implemented as the release count in a semaphore. The
<span class="function">SHGlobalCounterIncrement</span> function is little more 
than a call to <span class="function">ReleaseSemaphore</span> with one as the 
requested increment of the release count. </p>
<p>For most practical purposes, this function is just like the standard API 
function
<span class="function">InterlockedIncrement</span> except that the 32-bit 
variable to act on is specified indirectly through a handle instead of directly 
through an address. </p>
<p>A significant difference in behaviour arises because the release count of a 
semaphore cannot be negative. If the counter is already <span class="constant">
MAXLONG</span> 
(which, admittedly, is very unlikely in practice), then this function can 
increment the counter no further. There is no wrap around to <span class="constant">
MINLONG</span>. The counter remains at <span class="constant">MAXLONG</span> and 
the function returns one. </p>
<h2>Availability </h2>
<p>The <span class="function">SHGlobalCounterIncrement</span> function is 
exported from SHLWAPI as ordinal 224 in version 5.00 and higher. </p>
<!--webbot bot="Include" U-Include="../_include/undoc500.htm" TAG="BODY" startspan -->

<p>Though this function dates from as long ago as 1999, it was still not 
documented by Microsoft in the MSDN Library at least as late as the CD edition 
dated January 2004. </p>

<!--webbot bot="Include" i-checksum="43429" endspan -->
<div class="Footer">
  <p class="Dates">This page was created on 11th September 2004 and was last 
  modified on 15th March 2007. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c0407.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2004-2007. Geoff Chappell. All rights reserved. 
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="54855" endspan -->
</div>

</body>

</html>