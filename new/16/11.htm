<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>New or Updated in November 2016</title>
<link rel="stylesheet" type="text/css" href="../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../_styles/tree.css">
<script type="text/javascript" src="../../_scripts/master.js"></script>
<script type="text/javascript" src="../../_scripts/document.js"></script>
<script type="text/javascript" src="../../_scripts/tree.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript Header" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="14880" -->
<div class="Main">
  <h1>New or Updated in November 2016 </h1>
  <p>Research and writing has not exactly stopped but is slowed. The last six months 
  of full-time research and writing were a catharsis after five years of full-time 
  employment that permitted external research in theory but frustrated its practice. 
  Now such work goes back to nights and weekends while I use my working week to 
  seek clients for <a href="../../consult/index.htm">consultation</a>. Please recommend 
  to anyone you know who might make good use of an expert Windows programmer: they 
  possibly don’t themselves know. Meanwhile, enjoy what little new work comes this 
  month, and perhaps catch up with what I did in <a href="10.htm">October</a>.
  </p>
  <h2>Notes </h2>
  <p>You might think that basic updating—of user-level features, no less—is ideal 
  for part-time attention. But then you start tracking changes across half a dozen 
  versions and their service packs. Working through it all with reasonable care 
  is no picnic: at least I’m not trying to do it in a ridiculously noisy office!
  </p>
  <div class="Tree">
    <ul>
      <li class="Expanded Branch">Windows
      <ul>
        <li class="Expanded Branch">Startup
        <ul>
          <li class="Expanded Branch">Windows Vista and Higher
          <ul>
            <li class="Expanded Branch">Boot Configuration Data
            <ul>
              <li><a href="../../notes/windows/boot/bcd/objects.htm">BCD Objects</a> (updated) </li>
              <li><a href="../../notes/windows/boot/bcd/elements.htm">BCD Elements</a> (updated) </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
    </ul>
  </div>
  <h2>Kernel-Mode Windows </h2>
  <p>The attempt over the last few months to document the
  <a href="../../studies/windows/km/ntoskrnl/api/ex/sysinfo/query.htm">ZwQuerySystemInformation</a> 
  function and its companions and all their numerous cases and related structures 
  will keep me tidying up for a long while yet. </p>
  <p>And there are inevitably diversions. Like others, I find myself fascinated 
  by the execution of the Windows kernel under a hypervisor not to run multiple 
  installations of Windows on one computer, as for testing, but just so that the 
  one installation can be much more secure by using the processor’s support for 
  virtualisation. The hypervisor functionality that is needed for this Virtual Secure 
  Mode is new for Windows 10 but isn’t yet covered in the
  <a href="https://msdn.microsoft.com/en-us/virtualization/hyperv_on_windows/reference/tlfs">
  Hypervisor Top-Level Functional Specification</a>, which today (12th November 
  2016) offers as its most recent version a PDF that is dated August 2013. If we’re 
  naive about the Microsoft Open Specification Promise, we might soon expect an 
  updated version of that documentation. </p>
  <p>Less like others, I find myself as much fascinated by
  <span class="emphasis">where</span> some hypervisor details leak from Microsoft. 
  The many flags that Microsoft’s hypervisor can produce in response to the CPUID 
  instruction are interpreted by both the loader and the kernel. Both plainly have 
  structural definitions to work from, but no type information for those structures 
  gets into the symbol files for either. Of itself, this is nothing strange: many 
  structures that exist for the kernel’s internal use don’t show in the public symbol 
  files and wouldn’t be expected to. These structures, however, aren’t kept as internal. 
  They do show in some symbol files. What’s bizarre is which ones. In the whole 
  of the symbols packages that Microsoft publishes for 32-bit and 64-bit Windows 
  10, only one symbol file in each has type information for these hypervisor flags—and 
  the corresponding binary is a key component not of Windows but of Internet Explorer! 
  Weren’t these games of building Internet Explorer with programmatic access to 
  internal Windows details supposed to be long done and dusted? </p>
  <div class="Tree">
    <ul>
      <li class="Expanded Branch">Kernel
      <ul>
        <li class="Expanded Branch">API
        <ul>
          <li class="Expanded Branch">Event Tracing for Windows
          <ul>
            <li class="Expanded Branch">Registration
            <ul>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/etw/register/guid_entry.htm">ETW_GUID_ENTRY</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/etw/register/reg_entry/index.htm">ETW_REG_ENTRY</a> </li>
              </ul>
              </li>
            </ul>
            </li>
            <li class="Expanded Branch">Trace Logging
            <ul>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/etw/tracelog/wmi_buffer_header.htm">WMI_BUFFER_HEADER</a> </li>
              </ul>
              </li>
            </ul>
            </li>
            <li class="Expanded Branch">Trace Support
            <ul>
              <li class="Expanded Branch">Enumerations
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/etw/tracesup/class.htm">EVENT_TRACE_INFORMATION_CLASS</a> </li>
              </ul>
              </li>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/etw/tracesup/version.htm">EVENT_TRACE_VERSION_INFORMATION</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/etw/tracesup/groupmask.htm">EVENT_TRACE_GROUPMASK_INFORMATION</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/etw/tracesup/profile_counter.htm">EVENT_TRACE_PROFILE_COUNTER_INFORMATION</a> </li>
              </ul>
              </li>
              <li class="Expanded Branch">Implementation
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/etw/tracesup/etw_pmc_support.htm">ETW_PMC_SUPPORT</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/etw/tracesup/wmi_logger_context/index.htm">WMI_LOGGER_CONTEXT</a> </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li class="Expanded Branch">Executive
          <ul>
            <li class="Expanded Branch">System Information
            <ul>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/sysinfo/acpi_audit.htm">SYSTEM_ACPI_AUDIT_INFORMATION</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/sysinfo/boot_logo.htm">SYSTEM_BOOT_LOGO_INFORMATION</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/sysinfo/hypervisor_detail.htm">SYSTEM_HYPERVISOR_DETAIL_INFORMATION</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/sysinfo/hypervisor_processor_count.htm">SYSTEM_HYPERVISOR_PROCESSOR_COUNT_INFORMATION</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/sysinfo/hypervisor_query.htm">SYSTEM_HYPERVISOR_QUERY_INFORMATION</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/sysinfo/isolated_user_mode.htm">SYSTEM_ISOLATED_USER_MODE_INFORMATION</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/sysinfo/low_priority_io.htm">SYSTEM_LOW_PRIORITY_IO_INFORMATION</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/sysinfo/numa_proximity_map.htm">SYSTEM_NUMA_PROXIMITY_MAP</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/sysinfo/pool.htm">SYSTEM_POOL_INFORMATION</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/sysinfo/vhd_boot.htm">SYSTEM_VHD_BOOT_INFORMATION</a> </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li class="Expanded Branch">Hypervisor Layer
          <ul>
            <li class="Expanded Branch">Functions
            <ul>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvl/hvlproc/getlpindexfromapicid.htm">HvlGetLpIndexFromApicId</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvl/hvlproc/queryactivehypervisorprocessorcount.htm">HvlQueryActiveHypervisorProcessorCount</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvl/hvlproc/queryactiveprocessors.htm">HvlQueryActiveProcessors</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvl/hvlmain/queryconnection.htm">HvlQueryConnection</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvl/hvlproc/queryhypervisorprocessornodenumber.htm">HvlQueryHypervisorProcessorNodeNumber</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvl/hvlproc/querynumadistance.htm">HvlQueryNumaDistance</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvl/hvlproc/queryprocessortopology.htm">HvlQueryProcessorTopology</a> </li>
            </ul>
            </li>
          </ul>
          </li>
          <li class="Expanded Branch">Hypervisor Library
          <ul>
            <li class="Expanded Branch">Functions
            <ul>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/getdebugdeviceoptions.htm">HviGetDebugDeviceOptions</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/getenlightenmentinformation.htm">HviGetEnlightenmentInformation</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/gethardwarefeatures.htm">HviGetHardwareFeatures</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/gethypervisorfeatures.htm">HviGetHypervisorFeatures</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/gethypervisorinterface.htm">HviGetHypervisorInterface</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/gethypervisorvendorandmaxfunction.htm">HviGetHypervisorVendorAndMaxFunction</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/gethypervisorversion.htm">HviGetHypervisorVersion</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/getimplementationlimits.htm">HviGetImplementationLimits</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/isanyhypervisorpresent.htm">HviIsAnyHypervisorPresent</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/ishypervisormicrosoftcompatible.htm">HviIsHypervisorMicrosoftCompatible</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/ishypervisorvendormicrosoft.htm">HviIsHypervisorVendorMicrosoft</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/isiommuinuse.htm">HviIsIommuInUse</a> </li>
            </ul>
            </li>
            <li class="Expanded Branch">Structures
            <ul>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/cpuid_result.htm">HV_CPUID_RESULT</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/enlightenment_information.htm">HV_ENLIGHTENMENT_INFORMATION</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/hypervisor_features.htm">HV_HYPERVISOR_FEATURES</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/hypervisor_hardware_features.htm">HV_HYPERVISOR_HARDWARE_FEATURES</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/hypervisor_interface_info.htm">HV_HYPERVISOR_INTERFACE_INFO</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/hypervisor_svm_features.htm">HV_HYPERVISOR_SVM_FEATURES</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/hypervisor_version_info.htm">HV_HYPERVISOR_VERSION_INFO</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/implementation_limits.htm">HV_IMPLEMENTATION_LIMITS</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/partition_privilege_mask.htm">HV_PARTITION_PRIVILEGE_MASK</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/vendor_and_max_function.htm">HV_VENDOR_AND_MAX_FUNCTION</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/x64_enlightenment_information.htm">HV_X64_ENLIGHTENMENT_INFORMATION</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/x64_hypervisor_cpu_management_features.htm">HV_X64_HYPERVISOR_CPU_MANAGEMENT_FEATURES</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/x64_hypervisor_features.htm">HV_X64_HYPERVISOR_FEATURES</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/x64_hypervisor_hardware_features.htm">HV_X64_HYPERVISOR_HARDWARE_FEATURES</a> </li>
              <li><a href="../../studies/windows/km/ntoskrnl/api/hvilib/hviintel/x64_platform_capabilities.htm">HV_X64_PLATFORM_CAPABILITIES</a> </li>
            </ul>
            </li>
          </ul>
          </li>
          <li class="Expanded Branch">Process and Thread Manager
          <ul>
            <li class="Expanded Branch">Helper
            <ul>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/api/ntpsapi/process_disk_counters.htm">PROCESS_DISK_COUNTERS</a> </li>
              </ul>
              </li>
            </ul>
            </li>
            <li class="Expanded Branch">Query
            <ul>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ps/psquery/energy_values.htm">PROCESS_ENERGY_VALUES</a> </li>
              </ul>
              </li>
            </ul>
            </li>
            <li class="Expanded Branch">Quota
            <ul>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ps/psquota/query.htm">PS_CPU_QUOTA_QUERY_INFORMATION</a> </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li class="Expanded Branch">Run-Time Library
          <ul>
            <li class="Expanded Branch">Loader
            <ul>
              <li class="Expanded Branch">Functions
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/rtl/ldrreloc/querymoduleinformation.htm">RtlQueryModuleInformation</a> </li>
              </ul>
              </li>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/rtl/ldrreloc/module_basic_info.htm">RTL_MODULE_BASIC_INFO</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/rtl/ldrreloc/module_extended_info.htm">RTL_MODULE_EXTENDED_INFO</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/rtl/ldrreloc/process_modules.htm">RTL_PROCESS_MODULES</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/rtl/ldrreloc/process_module_information.htm">RTL_PROCESS_MODULE_INFORMATION</a> </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
        <li class="Expanded Branch">Structures
        <ul>
          <li class="Expanded Branch">KPRCB
          <ul>
            <li><a href="../../studies/windows/km/ntoskrnl/inc/ntos/i386_x/kprcb/index.htm">32-Bit (i386)</a> </li>
            <li><a href="../../studies/windows/km/ntoskrnl/inc/ntos/amd64_x/kprcb/index.htm">64-Bit (amd64)</a> </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
    </ul>
  </div>
  <h2>User-Mode Windows (Win32) </h2>
  <p>You might think there’s nothing much to write about an ancient and generally 
  deprecated function that’s among the most familiar of the thousands of functions 
  in the Windows API. In some versions, it’s only five CPU instructions—including 
  the return. It must be thoroughly picked over by now. And yet… </p>
  <div class="Tree">
    <ul>
      <li class="Expanded Branch">KERNEL32
      <ul>
        <li class="Expanded Branch">Functions
        <ul>
          <li class="Expanded Branch">Date and Time
          <ul>
            <li>GetTickCount (in preparation) </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
    </ul>
    <p>This has been in preparation for months, having been put aside as I found 
    ever more to write and new topics to research. Still, I do mean to finish it.
    </p>
  </div>
  <div class="Footer">
    <!-- webbot bot="Include" U-Include="../../_include/c16.htm" TAG="BODY" -->
  </div>
</div>

</body>

</html>
