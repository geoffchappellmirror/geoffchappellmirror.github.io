<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Shell Language</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>Shell Language </h1>
<p>The shell language is a more-or-less invented name for the language that is 
selected by the <span class="function"><a href="load.htm">MLLoadLibrary</a></span> 
function when the meaningful bits of its <span class="argument">dwCrossCodePage</span> argument 
are <span class="constant">ML_SHELL_LANGUAGE</span>. </p>
<p>When executing on Windows 2000 and higher, the shell language is just the 
user default UI language. Indeed, this identity of the concepts is cemented into the SHLWAPI 
version 6.00 from Windows Server 2003 and Windows Vista and higher, such that 
the <span class="constant">ML_SHELL_LANGUAGE</span> case of <span class="argument">dwCrossCodePage</span> 
gets no special treatment. When builds of version 6.00 from Windows XP and 
Internet Explorer 6.0, and all earlier versions back to 5.00, find themselves 
executing on Windows 2000 or higher, their coding distinguishes the
<span class="constant">ML_SHELL_LANGUAGE</span> case but evaluates the shell 
language just by calling the standard API function <span class="function">
GetUserDefaultUILanguage</span>, if this is available as 
an export from KERNEL32. </p>
<h2>Evaluation From Registry Settings </h2>
<p>When these earlier builds execute on Windows 2000 or higher, they make their 
own determination of the shell language from the registry. The 
defining registry values are: </p>
<table class="Registry">
  <tr>
    <td>Key: </td>
    <td><span class="regkey">HKEY_USERS\.DEFAULT\Control Panel\International</span>
    </td>
  </tr>
  <tr>
    <td>Value: </td>
    <td><span class="regvalue">Locale</span> </td>
  </tr>
</table>
<p>if running on a Windows NT system, else </p>
<table class="Registry">
  <tr>
    <td>Key: </td>
    <td><span class="regkey">HKEY_USERS\.Default\Control Panel\desktop\ResourceLocale</span>
    </td>
  </tr>
  <tr>
    <td>Value: </td>
    <td>default </td>
  </tr>
</table>
<p>For both, the data is expected to begin with the language ID, represented as 
case-insensitive hexadecimal digits, from the most significant to the least. The 
function accepts as many as 12 characters of data, including a terminating null, 
or 12 bytes of other data (which the function will interpret as characters, provided 
that at least one is null). Characters after the hexadecimal digits are ignored.
</p>
<div class="Footer">
  <p class="Dates">This page was created on 14th July 2009 and was last modified 
  on 15th July 2009. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c09.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2009. Geoff Chappell. All rights reserved.
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="50766" endspan -->
</div>

</body>

</html>
