<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>RunIndirectRegCommand</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js">
</script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>RunIndirectRegCommand </h1>
<p>This function executes a registry command specified indirectly by a key, 
subkey and verb. </p>
<h2>Declaration </h2>
<pre class="source">HRESULT
RunIndirectRegCommand (
    HWND hWnd,
    HKEY hKey,
    LPCWSTR pszSubKey,
    LPCWSTR pszVerb);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">hWnd</span> argument provides the window handle to 
use for message boxes while trying to execute the command. </p>
<p>The <span class="argument">hKey</span> argument provides a handle to an open 
registry key. </p>
<p>The <span class="argument">pszSubKey</span> argument provides the address of 
a null-terminated string that names a subkey for the indirect registry command.
</p>
<p>The <span class="argument">pszVerb</span> argument provides the address of a 
null-terminated string that names a verb under which to find the registry 
command.
</p>
<h3>Return Value </h3>
<!--webbot bot="Include" U-Include="../_include/hresult.htm" TAG="BODY" startspan -->

<p>The function returns zero for success, else an error code. </p>

<!--webbot bot="Include" i-checksum="1551" endspan -->
<h2>Behaviour </h2>
<p>The function uses <span class="function"><a href="runcommand.htm">
RunRegCommand</a></span> 
to execute whatever registry command is found from the key <span class="regkey">
<span class="placeholder">key</span>\<span class="placeholder">subkey</span>\<span class="placeholder">default</span>\shell\<span class="placeholder">verb</span>\command</span>, 
where </p>
<ul>
  <li><span class="regkey"><span class="placeholder">key</span></span> is the 
  open registry key represented by the <span class="argument">hKey</span> 
  argument;
  </li>
  <li><span class="regkey"><span class="placeholder">subkey</span></span> is the 
  subkey named by the <span class="argument">pszSubKey</span> argument; </li>
  <li><span class="placeholder">default</span> is the string data from the 
  default value of <span class="regkey"><span class="placeholder">key</span>\<span class="placeholder">subkey</span></span>;
  </li>
  <li><span class="placeholder">verb</span> is the <span class="argument">
  pszVerb</span> 
  argument. </li>
</ul>
<p>This function generalises <span class="function">
<a href="runindirectclientcommand.htm">SHRunIndirectRegClientCommand</a></span>, 
to allow a <span class="regkey"><span class="placeholder">key</span>\<span class="placeholder">subkey</span></span> 
pattern other than <span class="regkey">HKEY_LOCAL_MACHINE\Software\Clients\<span class="placeholder">ClientType</span></span> 
and a <span class="placeholder">verb</span> other than <span class="verb">Open</span>.
</p>
<h2>Availability </h2>
<p>The <span class="function">RunIndirectRegCommand</span> function is exported 
from SHLWAPI as ordinal 468 in late builds of version 5.00 and then in all 
higher versions. </p>
<!--webbot bot="Include" U-Include="../_include/undoc501.htm" TAG="BODY" startspan -->

<p>Though this function dates from as long ago as 2000, it was still not 
documented by Microsoft in the MSDN Library at least as late as the CD edition 
dated January 2004. </p>

<!--webbot bot="Include" i-checksum="41429" endspan -->
<div class="Footer">
  <p class="Dates">This page was created on 3rd October 2004 and was last 
  modified on 15th March 2007. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c0407.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2004-2007. Geoff Chappell. All rights reserved. 
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="54855" endspan -->
</div>

</body>

</html>