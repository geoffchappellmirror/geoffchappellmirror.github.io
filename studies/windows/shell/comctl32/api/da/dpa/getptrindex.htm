<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>DPA_GetPtrIndex</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="14798" endspan -->
<h1>DPA_GetPtrIndex </h1>
<p>This function finds the index for a given item in a given DPA. </p>
<h2>Declaration </h2>
<pre class="source">int
DPA_GetPtrIndex (
    HDPA pdpa,
    const void *p);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">pdpa</span> argument provides a handle to the DPA.
</p>
<p>The <span class="argument">p</span> argument provides a pointer to the item, 
or is NULL for an empty item. </p>
<h3>Return Value </h3>
<p>The function returns a 0-based index for the given item if successful, else
<span class="constant">DPA_ERR</span> (-1). </p>
<h2>Behaviour </h2>
<p>The function fails if the DPA handle is NULL or if the DPA has no pointer array. 
Otherwise, it searches the pointer array for the first occurrence of the given pointer. 
It returns the corresponding 0-based index. </p>
<h3>Variations </h3>
<!--webbot bot="Include" U-Include="_include/null40.htm" TAG="BODY" startspan -->

<p>Defence against a NULL <span class="argument">pdpa</span> argument begins in 
a build of version 4.0. Specifically, there is no defence in the version 4.0 from 
Windows 95, or in any earlier version, but there is in the version 4.0 for Internet 
Explorer 3.00 for Windows NT. (I have no copy of an Internet Explorer 3.00 for Windows 
95. See the list of <a href="../../../history/index.htm">COMCTL32 versions</a> 
found for this survey.) </p>

<!--webbot bot="Include" i-checksum="61182" endspan -->
<h2>Availability </h2>
<p>The <span class="function">DPA_GetPtrIndex</span> function is exported from COMCTL32.DLL 
as ordinal 333 in version 3.50 and higher. The implementation for version 6.10 
and higher is built into a statically linked library and thence is also exported 
from the Internet Explorer module IERTUTIL.DLL as ordinal 82 in version 7.0 and 
higher. </p>
<!--webbot bot="Include" U-Include="../../_include/undoc400.htm" TAG="BODY" startspan -->

<p>Though this function dates from as long ago as 1995, it was still not 
documented by Microsoft in the MSDN Library at least as late as the CD edition 
dated January 2004. </p>

<!--webbot bot="Include" i-checksum="42917" endspan -->
<!--webbot bot="Include" U-Include="../../_include/doc0506.htm" TAG="BODY" startspan -->

<p>This function has, however, got documented since then (in 2006 or perhaps 
some time during 2005). This article now uses Microsoft’s nomenclature. </p>

<!--webbot bot="Include" i-checksum="58210" endspan -->
<div class="Footer">
  <p class="Dates">This page was created on 9th April 2005 (from material first 
  published in 1997) and was last modified 
  on 15th March 2010. </p>
  <!--webbot bot="Include" U-Include="../../../../_include/c9710.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 1997-2010. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="5797" endspan -->
</div>

</body>

</html>