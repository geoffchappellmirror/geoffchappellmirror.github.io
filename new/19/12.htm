<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>New and Updated in December 2019 and January 2020</title>
<link rel="stylesheet" type="text/css" href="../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../_styles/tree.css">
<script type="text/javascript" src="../../_scripts/master.js"></script>
<script type="text/javascript" src="../../_scripts/document.js"></script>
<script type="text/javascript" src="../../_scripts/tree.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript Header" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="14880" -->
<div class="Main">
  <h1>New and Updated in December 2019 and January 2020 </h1>
  <p>New to <a href="11.htm">November</a>, but tacked on without explanation, was 
  a page I collected from age-old observations about
  <a href="../../studies/windows/km/ntoskrnl/api/ke/spinlock/index.htm">Spin Locks</a>. 
  I have, of course, tried collecting many such things into publishable material 
  many, many times over the 15 years or so that I’ve been writing pretty much exclusively 
  to this website. That the basics are widely neglected is a recurring theme for 
  me in my assessment of the reverse engineering of Windows as practised (and funded) 
  for computer security, but my own thoughts a few months ago to revisit memory 
  management show too that my own work at systematically covering the basics is 
  pretty thin. </p>
  <p>But, really, where’s the surprise? It’s hard work, not just for the research 
  but for how to present it. If only in my head, much of the material that is linked 
  to below is very much inter-linked, so much so that I’m not going to try distinguishing 
  what was done in December and what in January. And even more than usually, all 
  new pages and even some old are in highly varying states of disarray, which I 
  likely won’t review for a while. </p>
  <p>Two things intrigue me about where my choice of topics ran to. See first that 
  I have wandered into the minefield of processor feature detection. I know this 
  to be a minefield from previous wanderings ten years ago for this website and 
  over a quarter-century ago for <span class="citation">
  <a href="../../notes/dos/internals/index.htm">DOS Internals</a></span>. But now 
  I’m determined to do it better! Some of those old pages will get retired. </p>
  <p>Second, and I just don’t know how this can keep surprising me, but see that 
  Event Tracing for Windows (ETW) is never far away. I understand I’m writing to 
  a world that is only just discovering at scale what sorts of things can get traced, 
  as if the be all and end all of practical interest is what ETW can do for you 
  to help with programming and even with basic operation. But ETW has been around, 
  and hugely useful all the while, for two decades. I can’t help wondering if the 
  reason that wide interest in it has take so long to develop, it’s because the 
  field has not been open to independent tools for collection and analysis. So much 
  of the mechanism is undocumented. You start looking into how Windows might let 
  someone use a processor feature such as Branch Trace Storage and next thing it 
  turns out that not only would you need some undocumented API but it ties into 
  ETW. Sometimes I think there’s no end to this. </p>
  <h2>Notes </h2>
  <div class="Tree">
    <ul>
      <li class="Expanded Branch">Windows
      <ul>
        <li class="Expanded Branch">Startup
        <ul>
          <li class="Expanded Branch">Windows Vista and Higher
          <ul>
            <li class="Expanded Branch">BCD Elements
            <ul>
              <li><a href="../../notes/windows/boot/bcd/osloader/detecthal.htm">detecthal</a> </li>
              <li><a href="../../notes/windows/boot/bcd/osloader/hal.htm">hal</a> </li>
              <li><a href="../../notes/windows/boot/bcd/osloader/kernel.htm">kernel</a> </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
    </ul>
  </div>
  <h2>Kernel </h2>
  <div class="Tree">
    <ul>
      <li class="Expanded Branch">HAL
      <ul>
        <li><a href="../../studies/windows/km/hal/history/index.htm">Versions</a> </li>
        <li class="Expanded Branch">Functions
        <ul>
          <li class="Expanded Branch"><a href="../../studies/windows/km/hal/api/mpspin/index.htm">Spin Locks</a> (new)
          <ul>
            <li class="Expanded Branch">Functions
            <ul>
              <li><a href="../../studies/windows/km/hal/api/mpspin/acquireinstack.htm">KeAcquireInStackQueuedSpinLock</a> (new) </li>
              <li><a href="../../studies/windows/km/hal/api/mpspin/acquireinstackraisetosynch.htm">KeAcquireInStackQueuedSpinLockRaiseToSynch</a> (new) </li>
              <!-- li><a href="../../studies/windows/km/hal/api/mpspin/acquirequeued.htm">KeAcquireQueuedSpinLock</a> (new) </li>
              <li><a href="../../studies/windows/km/hal/api/mpspin/acquirequeuedraisetosynch.htm">KeAcquireQueuedSpinLockRaiseToSynch</a> (new) </li>
              <li><a href="../../studies/windows/km/hal/api/mpspin/releaseinstack.htm">KeReleaseInStackQueuedSpinLock</a> (new) </li>
              <li><a href="../../studies/windows/km/hal/api/mpspin/releasequeued.htm">KeReleaseQueuedSpinLock</a> (new) </li>
              <li><a href="../../studies/windows/km/hal/api/mpspin/trytoacquirequeued.htm">KeTryToAcquireQueuedSpinLock</a> (new) </li>
              <li><a href="../../studies/windows/km/hal/api/mpspin/trytoacquirequeuedraisetosynch.htm">KeTryToAcquireQueuedSpinLockRaiseToSynch</a> (new) </li -->
              <li><a href="../../studies/windows/km/hal/api/mpspin/acquire.htm">KfAcquireSpinLock</a> (new) </li>
              <li><a href="../../studies/windows/km/hal/api/mpspin/release.htm">KfAcquireSpinLock</a> (new) </li>
            </ul>
            </li>
          </ul>
          </li>
          <li class="Expanded Branch"><a href="../../studies/windows/km/hal/api/thunk/index.htm">Thunks</a> (new)
          <ul>
            <li class="Expanded Branch">Functions
            <ul>
              <li><a href="../../studies/windows/km/hal/api/thunk/acquire.htm">KeAcquireSpinLock</a> (new) </li>
              <li><a href="../../studies/windows/km/hal/api/thunk/release.htm">KeAcquireSpinLock</a> (new) </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li class="Expanded Branch">Kernel
      <ul>
        <li class="Expanded Branch">API
        <ul>
          <li class="Expanded Branch">Event Tracing for Windows
          <ul>
            <li class="Expanded Branch">Callouts
            <ul>
              <li><a href="../../studies/windows/km/ntoskrnl/inc/api/ntwmi/wmi_trace_packet/hookid.htm">Hook IDs</a> </li>
            </ul>
            </li>
            <li class="Expanded Branch">Lock Tracing
            <ul>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/etw/locktrace/wmi_spinlock.htm">WMI_SPINLOCK</a> </li>
              </ul>
              </li>
            </ul>
            </li>
            <li class="Expanded Branch">Trace Support
            <ul>
              <li class="Expanded Branch">Enumerations
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/api/ntetw/event_trace_information_class.htm">EVENT_TRACE_INFORMATION_CLASS</a> </li>
              </ul>
              </li>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/api/ntetw/event_trace_groupmask_information.htm">EVENT_TRACE_GROUPMASK_INFORMATION</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/api/ntetw/event_trace_spinlock_information.htm">EVENT_TRACE_SPINLOCK_INFORMATION</a> (new) </li>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/api/ntetw/event_trace_version_information.htm">EVENT_TRACE_VERSION_INFORMATION</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/api/ntwmi/perfinfo_groupmask.htm">PERFINFO_GROUPMASK</a> </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li class="Expanded Branch">Executive
          <ul>
            <li class="Expanded Branch">System Information
            <ul>
              <li class="Expanded Branch">Functions
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/sysinfo/isprocessorfeaturepresent.htm">ExIsProcessorFeaturePresent</a> (new) </li>
              </ul>
              </li>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/sysinfo/processor_features.htm">SYSTEM_PROCESSOR_FEATURES_INFORMATION</a> (new) </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/sysinfo/processor_profile_control_area.htm">SYSTEM_PROCESSOR_PROFILE_CONTROL_AREA</a> </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li class="Expanded Branch">Kernel
          <ul>
            <li class="Expanded Branch">Interrupt Objects
            <ul>
              <li class="Expanded Branch">Functions
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ke/intobj/initialize.htm">KeInitializeInterrupt</a> (new) </li>
              </ul>
              </li>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ke/intobj/isrdpcstats.htm">ISRDPCSTATS</a> (new) </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ke/intobj/kinterrupt.htm">KINTERRUPT</a> (new) </li>
              </ul>
              </li>
            </ul>
            </li>
            <li class="Expanded Branch"><a href="../../studies/windows/km/ntoskrnl/api/ke/interobj/index.htm">Interrupt Spin Locks</a> (new)
            <ul>
              <li class="Expanded Branch">Functions
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ke/interobj/acquire.htm">KeAcquireInterruptSpinLock</a> (new) </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ke/interobj/release.htm">KeReleaseInterruptSpinLock</a> (new) </li>
              </ul>
              </li>
            </ul>
            </li>
            <li class="Expanded Branch">Interrupt Support
            <ul>
              <li class="Expanded Branch">Functions
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ke/intsup/synchronize.htm">KeSynchronizeExecution</a> (new) </li>
              </ul>
              </li>
            </ul>
            </li>
            <li class="Expanded Branch">Spin Locks
            <ul>
              <li class="Expanded Branch">Functions
              <ul>
                <!-- li><a href="../../studies/windows/km/ntoskrnl/api/ke/spinlock/acquireatdpclevel.htm">KeAcquireSpinLockAtDpcLevel</a> (new) </li -->
                <li><a href="../../studies/windows/km/ntoskrnl/api/ke/spinlock/acquireraisetodpc.htm">KeAcquireSpinLockRaiseToDpc</a> (new) </li>
                <!-- li><a href="../../studies/windows/km/ntoskrnl/api/ke/spinlock/releasefromdpclevel.htm">KeReleaseSpinLockFromDpcLevel</a> (new) </li -->
                <li><a href="../../studies/windows/km/ntoskrnl/api/ke/spinlock/test.htm">KeTestSpinLock</a> (new) </li>
                <!-- li><a href="../../studies/windows/km/ntoskrnl/api/ke/spinlock/trytoacquireatdpclevel.htm">KeTryToAcquireSpinLockAtDpcLevel</a> (new) </li -->
              </ul>
              </li>
            </ul>
            </li>
            <li class="Expanded Branch"><a href="../../studies/windows/km/ntoskrnl/api/ke/queuelock/index.htm">Queued Spin Locks</a> (new)
            <ul>
              <li class="Expanded Branch">Functions
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ke/queuelock/acquireinstackatdpclevel.htm">KeAcquireInStackQueuedSpinLockAtDpcLevel</a> (new) </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ke/queuelock/releaseinstackfromdpclevel.htm">KeReleaseInStackQueuedSpinLockFromDpcLevel</a> (new) </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
        <li class="Expanded Branch">Structures
        <ul>
          <li class="Expanded Branch">KUSER_SHARED_DATA
          <ul>
            <li><a href="../../studies/windows/km/ntoskrnl/inc/api/ntexapi_x/kuser_shared_data/processorfeatures.htm">ProcessorFeatures</a> (new) </li>
          </ul>
          </li>
          <li class="Expanded Branch">LOADER_PARAMETER_BLOCK
          <ul>
            <li><a href="../../studies/windows/km/ntoskrnl/inc/api/arc/i386_loader_block.htm">I386_LOADER_BLOCK</a> </li>
          </ul>
          </li>
          <li><a href="../../studies/windows/km/ntoskrnl/inc/api/ntexapi/processor_profile_control_area.htm">PROCESSOR_PROFILE_CONTROL_AREA</a> (new) </li>
        </ul>
        </li>
      </ul>
      </li>
      <li class="Expanded Branch">Bug Checks
      <ul>
        <li><a href="../../studies/windows/km/bugchecks/79.htm">Bug Check 0x79: Mismatched HAL</a> </li>
      </ul>
      </li>
      <li class="Expanded Branch">Processor Support
      <ul>
        <li><a href="../../studies/windows/km/cpu/precpuid.htm">CPU Identification Before CPUID</a> (new) </li>
        <li class="Expanded Branch"><a href="../../studies/windows/km/cpu/cpuid/index.htm">The CPUID Instruction</a> (new)
        <ul>
          <li class="Expanded Branch"><a href="../../studies/windows/km/cpu/cpuid/00000001h/index.htm">Leaf 0</a> (new)
          <ul>
            <li><a href="../../studies/windows/km/cpu/cpuid/00000000h/eax.htm">EAX</a> (new) </li>
            <li><a href="../../studies/windows/km/cpu/cpuid/00000000h/vendor.htm">Vendor String</a> (new) </li>
          </ul>
          </li>
          <li class="Expanded Branch"><a href="../../studies/windows/km/cpu/cpuid/00000001h/index.htm">Leaf 1</a> (new)
          <ul>
            <li><a href="../../studies/windows/km/cpu/cpuid/00000001h/eax.htm">EAX</a> (new) </li>
            <!-- li><a href="../../studies/windows/km/cpu/cpuid/00000001h/ebx.htm">EBX</a> (new) </li -->
            <li><a href="../../studies/windows/km/cpu/cpuid/00000001h/ecx.htm">ECX</a> (new) </li>
            <li><a href="../../studies/windows/km/cpu/cpuid/00000001h/edx.htm">EDX</a> (new) </li>
          </ul>
          </li>
          <li><a href="../../studies/windows/km/cpu/cpuid/00000002h/index.htm">Leaf 2</a> (new) </li>
          <!-- li class="Folder">Leaf 0x80000001 
          <ul>
            <li><a href="../../studies/windows/km/cpu/cpuid/80000001h/ecx.htm">ECX</a> (new) </li>
            <li><a href="../../studies/windows/km/cpu/cpuid/80000001h/edx.htm">EDX</a> (new) </li>
          </ul>
          </li -->
        </ul>
        </li>
        <li class="Expanded Branch">Model Specific Registers
        <ul>
          <!-- li><a href="../../studies/windows/km/cpu/msr/efer.htm">IA32_EFER</a> (new) </li -->
          <li><a href="../../studies/windows/km/cpu/msr/misc_enable.htm">IA32_MISC_ENABLE</a> (new) </li>
        </ul>
        </li>
      </ul>
      </li>
    </ul>
  </div>
  <div class="Footer">
    <!--webbot bot="Include" U-Include="../../_include/c1920.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2019-2020. Geoff Chappell. All rights reserved.  
<a href="../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="65160" -->
  </div>
</div>

</body>

</html>
