<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SHIsRestricted</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/ie.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/ie.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>SHIsRestricted </h1>
<p>This function tests the value of a Windows Shell restriction and displays a message 
box if the restriction applies. </p>
<h2>Declaration </h2>
<pre class="source">BOOL
SHIsRestricted (
    HWND hwnd,
    RESTRICTIONS rest);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">hWnd</span> argument provides a handle to the window 
that should own the message box, or is NULL. </p>
<p>The <span class="argument">rest</span> argument selects the restriction whose 
value is wanted. The supported values in the <span class="enum">
<a href="../../../../shell/shell32/api/util/restrictions.htm">RESTRICTIONS</a></span> 
enumeration are listed separately. </p>
<h3>Return Value </h3>
<p>The function returns <span class="constant">TRUE</span> if the selected restriction 
evaluates to anything other than zero. Otherwise, the function returns
<span class="constant">FALSE</span>. </p>
<h2>Behaviour </h2>
<p>This function exists as a convenience for the case where a restriction is a boolean 
indicator of whether some Windows feature is restricted from use, typically as an 
administrative policy. The restriction is evaluated by calling the SHELL32 function
<span class="function">
<a href="../../../../shell/shell32/api/util/shrestricted.htm">SHRestricted</a></span> 
(passing the <span class="argument">rest</span> arguments as given). If the feature 
turns out to be restricted, then the SHLWAPI function <span class="function">
<a href="../../../../shell/shlwapi/api/util/restrictions/messagebox.htm">SHRestrictedMessageBox</a></span> 
is called to alert the user. </p>
<h2>Availability </h2>
<p>The <span class="function">SHIsRestricted</span> function is exported from SHDOCVW 
as ordinal 173 in version 5.0 and higher. </p>
<!--webbot bot="Include" U-Include="../_include/retired601.htm" TAG="BODY" startspan -->

<p>SHDOCVW version 6.1 retires this function: it continues to be exported but only as a forward 
to SHUNIMPL for certain failure. </p>

<!--webbot bot="Include" i-checksum="45730" endspan -->
<!--webbot bot="Include" U-Include="../_include/undoc500.htm" TAG="BODY" startspan -->

<p>Though this function dates from as long ago as 1999, it was still not 
documented by Microsoft as late as the January 2007 edition of the Windows Vista 
Software Development Kit (SDK). </p>

<!--webbot bot="Include" i-checksum="57206" endspan -->
<p>There is a strong suggestion that this function is not used by any executables 
that are distributed as standard with either Windows XP Service Pack 1 or Windows 
Vista. It seems not even to be used within SHDOCVW, i.e., for internal calls.
</p>
<div class="Footer">
  <p class="Dates">This page was created on 20th February 2008 and was last modified 
  on 17th March 2010. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c0810.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2008-2010. Geoff Chappell. All rights reserved. 
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="55263" endspan -->
</div>

</body>

</html>
