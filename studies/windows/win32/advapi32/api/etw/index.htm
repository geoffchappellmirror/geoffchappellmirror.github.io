<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Event Tracing for Windows Functions in ADVAPI32</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/win32.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/win32.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell, Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="54033" endspan -->
<h1>Event Tracing for Windows </h1>
<p>The functional interface that supports Event Tracing for Windows (ETW) in user 
mode began in ADVAPI32.DLL. The exported functions are all documented. They were 
all introduced for version 5.0, i.e., for Windows 2000, unless otherwise noted.
</p>
<ul>
  <li><span class="function">CloseTrace</span> </li>
  <li><span class="function">ControlTrace</span> </li>
  <li><span class="function">EnableTrace</span> </li>
  <li><span class="function">EnableTraceEx</span> (6.0) </li>
  <li><span class="function">EnumerateTraceGuids</span> (5.1) </li>
  <li><span class="function">EnumerateTraceGuidsEx</span> (6.0) </li>
  <li><span class="function">EventAccessControl</span> (6.0) </li>
  <li><span class="function">EventAccessQuery</span> (6.0) </li>
  <li><span class="function">EventAccessRemove</span> (6.0) </li>
  <li><span class="function">FlushTrace</span> (5.1) </li>
  <li><span class="function">OpenTrace</span> </li>
  <li><span class="function">ProcessTrace</span> </li>
  <li><span class="function">QueryAllTraces</span> </li>
  <li><span class="function">QueryTrace</span> (5.1) </li>
  <li><span class="function">RemoveTraceCallback</span> </li>
  <li><span class="function">SetTraceCallback</span> </li>
  <li><span class="function">StartTrace</span> </li>
  <li><span class="function">StopTrace</span> (5.1) </li>
  <li><span class="function">UpdateTrace</span> (5.1) </li>
</ul>
<p>Microsoft’s documentation would have it that <span class="function">QueryTrace</span>,
<span class="function">StopTrace</span> and <span class="function">UpdateTrace</span> 
are originals. They are not. They are, however, supported as macros if the symbol
<span class="symbol">__TRACE_W2K_COMPATIBLE</span> is defined before including EVNTRACE.H.
</p>
<p>ADVAPI32 also exports the following ETW functions as forwards to NTDLL. Some 
of these functions have implementions in ADVAPI32 in early versions. Some have never 
existed except as forwards to NTDLL. The target functions in NTDLL are not documented—few 
NTDLL functions are—but the highlighted functions are not documented even as exports 
from ADVAPI32. </p>
<ul>
  <li><span class="function">CreateTraceInstanceId</span> forwarded to
  <span class="function">EtwCreateTraceInstanceId</span> (5.2 and higher) </li>
  <li><span class="function">EventActivityIdControl</span> (6.0) forwarded to
  <span class="function">EtwEventActivityIdControl</span> </li>
  <li><span class="function">EventEnabled</span> (6.0) forwarded to
  <span class="function">EtwEventEnabled</span> </li>
  <li><span class="function">EventProviderEnabled</span> (6.0) forwarded to
  <span class="function">EtwEventProviderEnabled</span> </li>
  <li><span class="function">EventRegister</span> (6.0) forwarded to
  <span class="function">EtwEventRegister</span> </li>
  <li><span class="function">EventUnregister</span> (6.0) forwarded to
  <span class="function">EtwEventUnregister</span> </li>
  <li><span class="function">EventWrite</span> (6.0) forwarded to
  <span class="function">EtwEventWrite</span> </li>
  <li><span class="undocumented function">EventWriteEndScenario</span> (6.0) forwarded 
  to <span class="function">
  <a href="../../../ntdll/api/etw/eventwriteendscenario.htm">EtwEventWriteEndScenario</a></span>
  </li>
  <li><span class="undocumented function">EventWriteStartScenario</span> (6.0) forwarded 
  to <span class="function">
  <a href="../../../ntdll/api/etw/eventwritestartscenario.htm">EtwEventWriteStartScenario</a></span>
  </li>
  <li><span class="function">EventWriteString</span> (6.0) forwarded to
  <span class="function">EtwEventWriteString</span> </li>
  <li><span class="function">EventWriteTransfer</span> (6.0) forwarded to
  <span class="function">EtwEventWriteTransfer</span> </li>
  <li><span class="function">GetTraceEnableFlags</span> forwarded to
  <span class="function">EtwGetTraceEnableFlags</span> (5.2 and higher) </li>
  <li><span class="function">GetTraceEnableLevel</span> forwarded to
  <span class="function">EtwGetTraceEnableLevel</span> (5.2 and higher) </li>
  <li><span class="function">GetTraceLoggerHandle</span> forwarded to
  <span class="function">EtwGetTraceLoggerHandle</span> (5.2 and higher) </li>
  <li><span class="function">RegisterTraceGuids</span> forwarded to
  <span class="function">EtwRegisterTraceGuids</span> (5.2 and higher) </li>
  <li><span class="function">TraceEvent</span> forwarded to
  <span class="function">EtwTraceEvent</span> (5.2 only) or
  <span class="function">EtwLogTraceEvent</span> (6.0 and higher) </li>
  <li><span class="function">TraceEventInstance</span> forwarded to
  <span class="function">EtwTraceEventInstance</span> (5.2 and higher) </li>
  <li><span class="function">TraceMessage</span> (5.1) forwarded to
  <span class="function">EtwTraceMessage</span> (5.2 and higher) </li>
  <li><span class="function">TraceMessageVa</span> (5.1) forwarded to
  <span class="function">EtwTraceMessageVa</span> (5.2 and higher) </li>
  <li><span class="function">UnregisterTraceGuids</span> forwarded to
  <span class="function">EtwUnregisterTraceGuids</span> (5.2 and higher) </li>
</ul>
<p>Some of the functions that are nowadays implemented in ADVAPI32 are forwarded 
to NTDLL in version 5.2 only. This is here treated as anomalous. The functionality 
was moved to NTDLL and then was restored to ADVAPI32: the target functions do not 
exist in NTDLL version 6.0. </p>
<ul>
  <li><span class="function">ControlTrace</span> forwarded to
  <span class="function">EtwControlTrace</span> (5.2 only) </li>
  <li><span class="function">EnableTrace</span> forwarded to
  <span class="function">EtwEnableTrace</span> (5.2 only) </li>
  <li><span class="function">EnumerateTraceGuids</span> (5.1) forwarded to
  <span class="function">EtwEnumerateTraceGuids</span> (5.2 only) </li>
  <li><span class="function">FlushTrace</span> (5.1) forwarded to
  <span class="function">EtwFlushTrace</span> (5.2 only) </li>
  <li><span class="function">QueryAllTraces</span> forwarded to
  <span class="function">EtwQueryAllTraces</span> (5.2 only) </li>
  <li><span class="function">QueryTrace</span> (5.1) forwarded to
  <span class="function">EtwQueryTrace</span> (5.2 only) </li>
  <li><span class="function">StartTrace</span> forwarded to
  <span class="function">EtwStartTrace</span> (5.2 only) </li>
  <li><span class="function">StopTrace</span> (5.1) forwarded to
  <span class="function">EtwStopTrace</span> (5.2 only) </li>
  <li><span class="function">UpdateTrace</span> (5.1) forwarded to
  <span class="function">EtwUpdateTrace</span> (5.2 only) </li>
</ul>
<div class="Footer">
  <p class="Dates">This page was created on 18th November 2008. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c08.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2008. Geoff Chappell. All rights reserved. 
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="62741" endspan -->
</div>

</body>

</html>
