<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SHGetRestriction</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js">
</script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js">
</script>
<script type="text/javascript" src="../../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="14798" endspan -->
<h1>SHGetRestriction </h1>
<p>This function gets the value of a shell <a href="index.htm">restriction</a> 
given by its name and location within the registry. </p>
<h2>Declaration </h2>
<pre class="source">DWORD
SHGetRestriction (
    LPCWSTR lpKey,
    LPCWSTR lpSubKey,
    LPCWSTR lpValue);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">lpKey</span> argument provides a null-terminated 
string that names a key, to be interpreted relative to <span class="regkey">
HKEY_LOCAL_MACHINE</span> 
or <span class="regkey">HKEY_CURRENT_USER</span>. This argument may be NULL to 
stand for <span class="regkey">Software\Microsoft\Windows\CurrentVersion\Policies</span>.
</p>
<p>The <span class="argument">lpSubKey</span> argument provides a 
null-terminated string that names a subkey of the given key. </p>
<p>The <span class="argument">lpValue</span> argument provides a null-terminated 
string that names a DWORD value in the given subkey. </p>
<h3>Return Value </h3>
<p>The function returns four bytes of data for the given value, if found in the 
given key and subkey, else zero. </p>
<h2>Behaviour </h2>
<p>The function looks for the given key, subkey and value first in
<span class="regkey">HKEY_LOCAL_MACHINE</span>. If unsuccessful there, the 
function looks for the given key, subkey and value in <span class="regkey">
HKEY_CURRENT_USER</span>.
</p>
<p>Note the return of zero on failure. Shell restrictions must be designed so 
that they are zero by default. </p>
<h2>Availability </h2>
<p>The <span class="function">SHGetRestriction</span> function is exported from 
SHLWAPI as ordinal 271 in version 5.00 and higher. </p>
<!--webbot bot="Include" U-Include="../../_include/undoc500.htm" TAG="BODY" startspan -->

<p>Though this function dates from as long ago as 1999, it was still not 
documented by Microsoft in the MSDN Library at least as late as the CD edition 
dated January 2004. </p>

<!--webbot bot="Include" i-checksum="43429" endspan -->
<div class="Footer">
  <p class="Dates">This page was created on 11th September 2004 and was last 
  modified on 16th March 2007. </p>
  <!--webbot bot="Include" U-Include="../../../../_include/c0407.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2004-2007. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="4669" endspan -->
</div>

</body>

</html>