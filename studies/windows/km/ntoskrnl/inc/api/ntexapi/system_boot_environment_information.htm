<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SYSTEM_BOOT_ENVIRONMENT_INFORMATION</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <h1>SYSTEM_BOOT_ENVIRONMENT_INFORMATION </h1>
  <p>The <span class="struct">SYSTEM_BOOT_ENVIRONMENT_INFORMATION</span> structure 
  (formally <span class="struct">_SYSTEM_BOOT_ENVIRONMENT_INFORMATION</span>) is 
  what a successful call to <span class="function">
  <a href="../../../api/ex/sysinfo/query.htm">ZwQuerySystemInformation</a></span> 
  or <span class="function">NtQuerySystemInformation</span> produces in its output 
  buffer when given the information class <span class="constant">SystemBootEnvironmentInformation</span> 
  (0x5A). </p>
  <h2>Documentation Status </h2>
  <p>The <span class="struct">SYSTEM_BOOT_ENVIRONMENT_INFORMATION</span> structure 
  is not documented. </p>
  <!--webbot bot="Include" U-Include="../_include/type_info_urlmon.htm" TAG="BODY" startspan -->

<p>Microsoft does publish the practical equivalent of a C-language definition as 
type information in symbol files—not for the kernel, where the structure is prepared, 
nor even for low-level user-mode DLLs that interpret the structure, but for a handful 
of higher-level DLLs that might ordinarily be thought very distant from any involvement 
with the structure. Perhaps only by oversight, but starting as long ago as Windows 
8, Microsoft’s downloadable packages of public symbols have included a smattering 
of private symbol files and these continue to be available through the public symbol 
server. Precisely which DLLs have the type information varies between versions. 
COMBASE.DLL is among the more reliable nowadays. Disclosure in symbol files for 
URLMON.DLL stopped for the 1803 release of Windows 10 but is specially notable 
because of this DLL’s origins in Internet Explorer and thence for the strong suggestion 
that Microsoft’s programmers of Internet Explorer had access to more details of 
low-level Windows programming than Microsoft publishes for wider use (including 
by the programmers of competing web browsers). </p>

<!--webbot bot="Include" endspan i-checksum="12783" -->
  <h2>Layout </h2>
  <p>The <span class="struct">SYSTEM_BOOT_ENVIRONMENT_INFORMATION</span> is 0x20 
  bytes in both 32-bit and 64-bit Windows 8 and higher, but is only 0x18 bytes in 
  earlier versions. The older, smaller structure is retained in Windows 8 and higher 
  as <span class="struct">SYSTEM_BOOT_ENVIRONMENT_V1</span>. </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset"><col class="Definition"><col class="Versions">
    </colgroup>
    <thead>
      <tr>
        <th>Offset </th>
        <th>Definition </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00 </td>
        <td>
        <pre class="source">GUID BootIdentifier;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x10 </td>
        <td>
        <pre class="source">FIRMWARE_TYPE FirmwareType;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x18 </td>
        <td>
        <pre class="source">ULONGLONG BootFlags;</pre>
        </td>
        <td>6.2 and higher </td>
      </tr>
    </tbody>
  </table>
  <p>The kernel learns the <span class="member">BootIdentifier</span> from the loader 
  via the <span class="member">BootIdentifier</span> member of the
  <span class="struct"><a href="../arc/loader_parameter_extension/index.htm">LOADER_PARAMETER_EXTENSION</a></span>. 
  Its retrieval through the <span class="struct">SYSTEM_BOOT_ENVIRONMENT_INFORMATION</span> 
  is how BCDEDIT knows which of the installed Windows systems actually got booted.
  </p>
  <p>The <span class="enum">FIRMWARE_TYPE</span> enumeration is defined in WINNT.H 
  for user-mode programming. Its retrieval through the <span class="struct">SYSTEM_BOOT_ENVIRONMENT_INFORMATION</span> 
  is how NTDLL supports <span class="env">FIRMWARE_TYPE</span> as a fake environment 
  variable. Programmers who think to use this structure and
  <span class="function">NtQuerySystemInformation</span> just to get the firmware 
  type would better use the documented KERNEL32 function <span class="function">
  GetFirmwareType</span> instead. </p>
  <p>The <span class="member">BootFlags</span> are what the loader passes to the 
  kernel via the <span class="member">
  <a href="../arc/loader_parameter_extension/bootflags.htm">BootFlags</a></span> 
  member of the <span class="struct">LOADER_PARAMETER_EXTENSION</span>. </p>
  <div class="Footer">
    <p class="Dates">This page was created on 9th July 2016 but was not published 
    until 29th <a href="../../../../../../../new/16/10.htm">October 2016</a>. It 
    was last modified on 20th February 2023. </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c1623.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2016-2023. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="4941" -->
  </div>
</div>

</body>

</html>
