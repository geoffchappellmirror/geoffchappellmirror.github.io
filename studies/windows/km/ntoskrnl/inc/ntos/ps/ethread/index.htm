<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>ETHREAD</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="33595" -->
<div class="Main">
  <h1>ETHREAD </h1>
  <p>The <span class="struct">ETHREAD</span> structure is the kernel’s representation 
  of a thread object. For instance, if the <span class="function">ObReferenceObjectByHandle</span> 
  function successfully resolves a handle though directed to do so only if the object 
  type is <span class="variable">PsThreadType</span>, then the pointer that the 
  function produces for the object is a pointer to an <span class="struct">ETHREAD</span>.
  </p>
  <p>Many functions that are exported from the kernel, e.g., for use by drivers, 
  provide for referring to a thread object through a pointer to an
  <span class="struct">ETHREAD</span>. However, the pointer is intended just as 
  an identifier: the structure itself is plainly meant to be opaque outside the 
  kernel. </p>
  <h2>Variability </h2>
  <p>Since the <span class="struct">ETHREAD</span> structure is internal to the 
  kernel, it should not surprise that the layout changes greatly between Windows 
  versions and even between builds. Some sense of the variability can be gained 
  just from the structure’s changing size. In the following table, different builds 
  of the same version are distinguished as early, late and even very late because 
  they are known to vary the structure even if they don’t change the size. These 
  descriptions are then used as a shorthand throughout this article and its companions.
  </p>
  <table class="Sizes">
    <colgroup>
      <col class="Version"><col class="Size" span="2">
    </colgroup>
    <thead>
      <tr>
        <th>Version </th>
        <th>Size (x86) </th>
        <th>Size (x64) </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>3.10 </td>
        <td>0x02E8 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>3.50 to 4.0 </td>
        <td>0x0240 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>5.0 </td>
        <td>0x0248 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>5.1 </td>
        <td>0x0258 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>early 5.2 (before SP1) </td>
        <td>0x0260 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>late 5.2 (SP1) </td>
        <td>0x0250 </td>
        <td>0x0428 </td>
      </tr>
      <tr>
        <td>very late 5.2 (SP2) </td>
        <td>0x0250 </td>
        <td>0x0410 </td>
      </tr>
      <tr>
        <td>early 6.0 (before SP1); <br>
        late 6.0 </td>
        <td>0x0288 </td>
        <td>0x0450 </td>
      </tr>
      <tr>
        <td>6.1 </td>
        <td>0x02B8 </td>
        <td>0x0498 </td>
      </tr>
      <tr>
        <td>6.2 </td>
        <td>0x02C0 </td>
        <td>0x04C8 </td>
      </tr>
      <tr>
        <td>6.3 </td>
        <td>0x0418 </td>
        <td>0x0778 </td>
      </tr>
      <tr>
        <td>10.0 to 1511 </td>
        <td>0x0458 </td>
        <td>0x07C0 </td>
      </tr>
      <tr>
        <td>1607 </td>
        <td>0x0460 </td>
        <td>0x07E0 </td>
      </tr>
      <tr>
        <td>1703 </td>
        <td>0x0480 </td>
        <td>0x0810 </td>
      </tr>
      <tr>
        <td>1709 to 1803 </td>
        <td>0x0480 </td>
        <td>0x0818 </td>
      </tr>
      <tr>
        <td>1809 </td>
        <td>0x0480 </td>
        <td>0x0810 </td>
      </tr>
      <tr>
        <td>1903 </td>
        <td>0x0488 </td>
        <td>0x0820 </td>
      </tr>
      <tr>
        <td>2004 </td>
        <td>0x04E0 </td>
        <td>0x0898 </td>
      </tr>
    </tbody>
  </table>
  <h2>Layout </h2>
  <p>Offsets, types and names in the tables that follow, are from Microsoft’s symbol 
  files for the kernel starting with Windows 2000 SP3. Since symbol files for earlier 
  versions do not contain type information for the <span class="struct">ETHREAD</span>, 
  Microsoft’s names and types are something of a guess from inspection of how the 
  kernel in those versions uses the <span class="struct">ETHREAD</span>. Where use 
  of a member corresponds closely with that of a version for which type information 
  is available in Microsoft’s symbol files, it seems reasonable to suppose continuity. 
  Some use, however, has no correspondence, the code having changed too much. Even 
  where the use hasn’t changed so much, tracking down the correspondence exhaustively 
  would be difficult, if not impossible, even with source code. </p>
  <p>For all versions, it is well known that the <span class="struct">ETHREAD</span> 
  starts with a <span class="struct"><a href="../../ke/kthread/index.htm">KTHREAD</a></span>. 
  The latter is the Kernel Core’s representation of the thread object. It is itself 
  a dispatcher object, which has the useful effect that a handle to an
  <span class="struct">ETHREAD</span> can be waited on. It gets signalled when 
  the thread terminates. </p>
  <p>Almost all the shifting of offsets of <span class="struct">ETHREAD</span> members 
  between versions is explained by the <span class="struct">KTHREAD</span> being 
  even more variable—indeed, much more variable—than the <span class="struct">ETHREAD</span>. 
  The only known difference between Windows Server 2003 SP1 and SP2 for the 64-bit 
  builds is that the <span class="struct">KTHREAD</span> shrank. To save space, 
  “late 5.2” for the 32-bit builds stands for “v. late 5.2” also. </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00 </td>
        <td>0x00 </td>
        <td>
        <pre class="source">KTHREAD Tcb;</pre>
        </td>
        <td>all </td>
      </tr>
      <tr>
        <td rowspan="3">0x01D8 (3.10); <br>
        0x01B0 (3.50 to 5.0); <br>
        0x01C0 (5.1); <br>
        0x01C8 (early 5.2); <br>
        0x01B8 (late 5.2); <br>
        0x01E0 (6.0); <br>
        0x0200 (6.1); <br>
        0x01E8 (6.2); <br>
        0x0338 (6.3); <br>
        0x0348 (10.0 to 1607); <br>
        0x0350 (1703 to 1809); <br>
        0x0358 (1903); <br>
        0x0280 </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">LARGE_INTEGER CreateTime;</pre>
        </td>
        <td>3.10 to 4.0 </td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>
        <pre class="source">union {
    LARGE_INTEGER CreateTime;
    struct { 
        UINT NestedFaultCount : 2;  // 0x00000003
        UINT ApcNeeded : 1;         // 0x00000004
    };
};</pre>
        </td>
        <td>5.0 to early 5.2 </td>
      </tr>
      <tr>
        <td>0x0320 (late 5.2); <br>
        0x0308 (v. late 5.2); <br>
        0x0330 (6.0); <br>
        0x0360 (6.1); <br>
        0x0348 (6.2); <br>
        0x05D0 (6.3); <br>
        0x05D8 (10.0 to 1511); <br>
        0x05E0 (1607); <br>
        0x05E8 (1703); <br>
        0x05F0 (1709 to 1809); <br>
        0x0600 (1903); <br>
        0x0430 </td>
        <td>
        <pre class="source">LARGE_INTEGER CreateTime;</pre>
        </td>
        <td>late 5.2 and higher </td>
      </tr>
    </tbody>
  </table>
  <p>In those builds that have <span class="member">CreateTime</span> share space 
  with bit fields, the <span class="member">CreateTime</span> actually is in bits 
  3 to 63 as if it too is a bit field. It’s not that the low 3 bits are lost, but 
  that the whole is shifted left by 3 bits. </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions"><col class="Remarks">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
        <th>Remarks </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td rowspan="3">0x01E0 (3.10); <br>
        0x01B8 (3.50 to 5.0); <br>
        0x01C8 (5.1); <br>
        0x01D0 (early 5.2); <br>
        0x01C0 (late 5.2); <br>
        0x01E8 (6.0); <br>
        0x0208 (6.1); <br>
        0x01F0 (6.2); <br>
        0x0340 (6.3); <br>
        0x0350 (10.0 to 1607); <br>
        0x0358 (1703 to 1809); <br>
        0x0360 (1903); <br>
        0x0288 </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">union {
    LARGE_INTEGER ExitTime;
    LIST_ENTRY LpcReplyChain;
};</pre>
        </td>
        <td>3.10 to 5.0 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td rowspan="2">0x0328 (late 5.2); <br>
        0x0310 (v. late 5.2); <br>
        0x0338 (6.0); <br>
        0x0368 (6.1); <br>
        0x0350 (6.2); <br>
        0x05D8 (6.3); <br>
        0x05E0 (10.0 to 1511); <br>
        0x05E8 (1607); <br>
        0x05F0 (1703); <br>
        0x05F8 (1709 to 1809); <br>
        0x0608 (1903); <br>
        0x0438 </td>
        <td>
        <pre class="source">union {
    LARGE_INTEGER ExitTime;
    LIST_ENTRY LpcReplyChain;
    LIST_ENTRY KeyedWaitChain;
};</pre>
        </td>
        <td>5.1 to 5.2 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>
        <pre class="source">union {
    LARGE_INTEGER ExitTime;
    LIST_ENTRY KeyedWaitChain;
};</pre>
        </td>
        <td>6.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td rowspan="2">0x01E8 (3.10); <br>
        0x01C0 (3.50 to 5.0); <br>
        0x01D0 (5.1); <br>
        0x01D8 (early 5.2); <br>
        0x01C8 (late 5.2); <br>
        0x01F0 (6.0); <br>
        0x0210 (6.1) </td>
        <td rowspan="2">0x0338 (late 5.2); <br>
        0x0320 (v. late 5.2); <br>
        0x0348 (6.0); <br>
        0x0378 (6.1) </td>
        <td>
        <pre class="source">union {
    LONG ExitStatus;
    PVOID OfsChain;
};</pre>
        </td>
        <td>3.10 to 6.0 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>
        <pre class="source">LONG ExitStatus;</pre>
        </td>
        <td>6.1 only </td>
        <td>next at 0x0280 and 0x0450 </td>
      </tr>
      <tr>
        <td>0x01F8 (6.2); <br>
        0x0348 (6.3); <br>
        0x0358 (10.0 to 1607); <br>
        0x0360 (1703 to 1809); <br>
        0x0368 (1903); <br>
        0x0290 </td>
        <td>0x0360 (6.2); <br>
        0x05E8 (6.3); <br>
        0x05F0 (10.0 to 1511); <br>
        0x05F8 (1607); <br>
        0x0600 (1703) </td>
        <td>
        <pre class="source">PVOID ChargeOnlySession;</pre>
        </td>
        <td>6.2 and higher (x86); <br>
        6.2 to 1703 (x64) </td>
        <td>next at 0x0698 (x64) </td>
      </tr>
      <tr>
        <td>0x01EC (3.10) </td>
        <td>&nbsp;</td>
        <td>unknown dword </td>
        <td>3.10 only </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x01F0 (3.10) </td>
        <td>&nbsp;</td>
        <td>unknown dword </td>
        <td>3.10 only </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td rowspan="2">0x01C4 (3.50 to 5.0); <br>
        0x01D4 (5.1); <br>
        0x01DC (early 5.2); <br>
        0x01CC (late 5.2); <br>
        0x01F4 (6.0); <br>
        0x0214 (6.1); <br>
        0x01FC (6.2); <br>
        0x034C (6.3); <br>
        0x035C (10.0 to 1607); <br>
        0x0364 (1703 to 1809); <br>
        0x036C (1903); <br>
        0x0294 </td>
        <td rowspan="2">0x0340 (late 5.2); <br>
        0x0328 (v. late 5.2); <br>
        0x0350 (6.0); <br>
        0x0380 (6.1); <br>
        0x0368 (6.2); <br>
        0x05F0 (6.3); <br>
        0x05F8 (10.0 to 1511); <br>
        0x0600 (1607); <br>
        0x0608 (1703 to 1809); <br>
        0x0618 (1903); <br>
        0x0448 </td>
        <td>
        <pre class="source">LIST_ENTRY PostBlockList;</pre>
        </td>
        <td>3.50 to 5.2 </td>
        <td>previously at 0x02C4 </td>
      </tr>
      <tr>
        <td>
        <pre class="source">union {
    LIST_ENTRY PostBlockList;
    struct {
        /*  packed members, see below  */
    };
};</pre>
        </td>
        <td>6.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
    </tbody>
  </table>
  <p>Take away the construction, and these are the members that are packed with
  <span class="member">PostBlockList</span>: </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions"><col class="Remarks">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
        <th>Remarks </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x01F4 (6.0); <br>
        0x0214 (6.1); <br>
        0x01FC (6.2); <br>
        0x034C (6.3); <br>
        0x035C (10.0 to 1607); <br>
        0x0364 (1703 to 1809); <br>
        0x036C (1903); <br>
        0x0294 </td>
        <td>0x0350 (6.0); <br>
        0x0380 (6.1); <br>
        0x0368 (6.2); <br>
        0x05F0 (6.3); <br>
        0x05F8 (10.0 to 1511); <br>
        0x0600 (1607); <br>
        0x0608 (1703 to 1809); <br>
        0x0618 (1903); <br>
        0x0448 </td>
        <td>
        <pre class="source">PVOID ForwardLinkShadow;</pre>
        </td>
        <td>6.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x01F8 (6.0); <br>
        0x0218 (6.1); <br>
        0x0200 (6.2); <br>
        0x0350 (6.3); <br>
        0x0360 (10.0 to 1607); <br>
        0x0368 (1703 to 1809); <br>
        0x0370 (1903); <br>
        0x0298 </td>
        <td>0x0358 (6.0); <br>
        0x0388 (6.1); <br>
        0x0370 (6.2); <br>
        0x05F8 (6.3); <br>
        0x0600 (10.0 to 1511); <br>
        0x0608 (1607); <br>
        0x0610 (1703 to 1809); <br>
        0x0620 (1903); <br>
        0x0450 </td>
        <td>
        <pre class="source">PVOID StartAddress;</pre>
        </td>
        <td>6.0 and higher </td>
        <td>previously at 0x021C and 0x03D8 </td>
      </tr>
    </tbody>
  </table>
  <p><span class="alert">Yes, there is a plan to write something here.</span>
  </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td rowspan="4">0x01F4 (3.10); <br>
        0x01CC (3.50 to 5.0); <br>
        0x01DC (5.1); <br>
        0x01E4 (early 5.2); <br>
        0x01D4 (late 5.2); <br>
        0x01FC (6.0); <br>
        0x021C (6.1); <br>
        0x0204 (6.2); <br>
        0x0354 (6.3); <br>
        0x0364 (10.0 to 1607); <br>
        0x036C (1703 to 1809); <br>
        0x0374 (1903); <br>
        0x029C </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">LIST_ENTRY TerminationPortList;</pre>
        </td>
        <td>3.10 to 5.0 </td>
      </tr>
      <tr>
        <td rowspan="3">0x0350 (late 5.2); <br>
        0x0338 (v. late 5.2); <br>
        0x0360 (6.0); <br>
        0x0390 (6.1); <br>
        0x0378 (6.2); <br>
        0x0600 (6.3); <br>
        0x0608 (10.0 to 1511); <br>
        0x0610 (1607); <br>
        0x0618 (1703 to 1809); <br>
        0x0628 (1903); <br>
        0x0458 </td>
        <td>
        <pre class="source">union {
    TERMINATION_PORT *TerminationPort;
    ETHREAD *ReaperLink;
    PVOID KeyedWaitValue;
};</pre>
        </td>
        <td>5.1 to 5.2 </td>
      </tr>
      <tr>
        <td>
        <pre class="source">union {
    TERMINATION_PORT *TerminationPort;
    ETHREAD *ReaperLink;
    PVOID KeyedWaitValue;
    PVOID Win32StartParameter;
};</pre>
        </td>
        <td>6.0 only </td>
      </tr>
      <tr>
        <td>
        <pre class="source">union {
    TERMINATION_PORT *TerminationPort;
    ETHREAD *ReaperLink;
    PVOID KeyedWaitValue;
};</pre>
        </td>
        <td>6.1 and higher </td>
      </tr>
      <tr>
        <td>0x01FC (3.10); <br>
        0x01D4 (3.50 to 5.0); <br>
        0x01E0 (5.1); <br>
        0x01E8 (early 5.2); <br>
        0x01D8 (late 5.2); <br>
        0x0200 (6.0); <br>
        0x0220 (6.1); <br>
        0x0208 (6.2); <br>
        0x0358 (6.3); <br>
        0x0368 (10.0 to 1607); <br>
        0x0370 (1703 to 1809); <br>
        0x0378 (1903); <br>
        0x02A0 </td>
        <td>0x0358 (late 5.2); <br>
        0x0340 (v. late 5.2); <br>
        0x0368 (6.0); <br>
        0x0398 (6.1); <br>
        0x0380 (6.2); <br>
        0x0608 (6.3); <br>
        0x0610 (10.0 to 1511); <br>
        0x0618 (1607); <br>
        0x0620 (1703 to 1809); <br>
        0x0630 (1903); <br>
        0x0460 </td>
        <td>
        <pre class="source">KSPIN_LOCK ActiveTimerListLock;</pre>
        </td>
        <td>all </td>
      </tr>
      <tr>
        <td>0x0200 (3.10); <br>
        0x01D8 (3.50 to 5.0); <br>
        0x01E4 (5.1); <br>
        0x01EC (early 5.2); <br>
        0x01DC (late 5.2); <br>
        0x0204 (6.0); <br>
        0x0224 (6.1); <br>
        0x020C (6.2); <br>
        0x035C (6.3); <br>
        0x036C (10.0 to 1607); <br>
        0x0374 (1703 to 1809); <br>
        0x037C (1903); <br>
        0x02A4 </td>
        <td>0x0360 (late 5.2); <br>
        0x0348 (v. late 5.2); <br>
        0x0370 (6.0); <br>
        0x03A0 (6.1); <br>
        0x0388 (6.2); <br>
        0x0610 (6.3); <br>
        0x0618 (10.0 to 1511); <br>
        0x0620 (1607); <br>
        0x0628 (1703 to 1809); <br>
        0x0638 (1903); <br>
        0x0468 </td>
        <td>
        <pre class="source">LIST_ENTRY ActiveTimerListHead;</pre>
        </td>
        <td>all </td>
      </tr>
      <tr>
        <td>0x0208 (3.10); <br>
        0x01E0 (3.50 to 5.0); <br>
        0x01EC (5.1); <br>
        0x01F4 (early 5.2); <br>
        0x01E4 (late 5.2); <br>
        0x020C (6.0); <br>
        0x022C (6.1); <br>
        0x0214 (6.2); <br>
        0x0364 (6.3); <br>
        0x0374 (10.0 to 1607); <br>
        0x037C (1703 to 1809); <br>
        0x0384 (1903); <br>
        0x02AC </td>
        <td>0x0370 (late 5.2); <br>
        0x0358 (v. late 5.2); <br>
        0x0380 (6.0); <br>
        0x03B0 (6.1); <br>
        0x0398 (6.2); <br>
        0x0620 (6.3); <br>
        0x0628 (10.0 to 1511); <br>
        0x0630 (1607); <br>
        0x0638 (1703 to 1809); <br>
        0x0648 (1903); <br>
        0x0478 </td>
        <td>
        <pre class="source">CLIENT_ID Cid;</pre>
        </td>
        <td>all </td>
      </tr>
    </tbody>
  </table>
  <p>The <span class="member">Cid</span> holds the process and thread IDs that represent 
  the thread in user mode, notably for API functions that let user-mode clients 
  open a handle to a thread. For some measure of how these IDs were at least originally 
  intended solely for client-level identification, consider that the kernel did 
  not originally export functions that allow kernel-mode software to gets these 
  IDs even for the current thread. The <span class="function">PsGetCurrentProcessId</span> 
  and <span class="function">PsGetCurrentThreadId</span> functions do nothing but 
  extract the IDs from the <span class="member">Cid</span> for the current thread, 
  but they are not exported until version 4.0 (and were not immediately documented). 
  The same straightforward extraction but for an arbitrary thread is done by the
  <span class="function">PsGetThreadProcessId</span> and <span class="function">
  PsGetThreadId</span> functions, but these aren’t exported until version 5.1 (apparently 
  still without documentation). </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions"><col class="Remarks">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
        <th>Remarks </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td rowspan="3">0x0210 (3.10); <br>
        0x01E8 (3.50 to 5.0); <br>
        0x01F4 (5.1); <br>
        0x01FC (early 5.2); <br>
        0x01EC (late 5.2); <br>
        0x0214 (6.0); <br>
        0x0234 (6.1); <br>
        0x021C (6.2); <br>
        0x036C (6.3); <br>
        0x037C (10.0 to 1607); <br>
        0x0384 (1703 to 1809); <br>
        0x038C (1903); <br>
        0x0284 </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">KSEMAPHORE LpcReplySemaphore;</pre>
        </td>
        <td>3.10 to 5.0 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td rowspan="2">0x0380 (late 5.2); <br>
        0x0368 (v. late 5.2); <br>
        0x0390 (6.0); <br>
        0x03C0 (6.1); <br>
        0x03A8 (6.2); <br>
        0x0630 (6.3); <br>
        0x0638 (10.0 to 1511); <br>
        0x0640 (1607); <br>
        0x0648 (1703 to 1809); <br>
        0x0658 (1903); <br>
        0x0488 </td>
        <td>
        <pre class="source">union {
    KSEMAPHORE LpcReplySemaphore;
    KSEMAPHORE KeyedWaitSemaphore;
};</pre>
        </td>
        <td>5.1 to 5.2 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>
        <pre class="source">union {
    KSEMAPHORE KeyedWaitSemaphore;
    KSEMAPHORE AlpcWaitSemaphore;
};</pre>
        </td>
        <td>6.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0224 (3.10); <br>
        0x01FC (3.51 to 5.0); <br>
        0x0208 (5.1); <br>
        0x0210 (early 5.2); <br>
        0x0200 (late 5.2) </td>
        <td>0x03A0 (late 5.2); <br>
        0x0388 (v. late 5.2) </td>
        <td>
        <pre class="source">union {
    PVOID LpcReplyMessage;
    PVOID LpcWaitingOnPort;
};</pre>
        </td>
        <td>3.10 to 5.2 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0200 (3.51 to 5.0) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">ULONG LpcReplyMessageId;</pre>
        </td>
        <td>3.51 to 5.0 </td>
        <td>next at 0x023C </td>
      </tr>
      <tr>
        <td>0x0204 (3.51 to 5.0) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">ULONG PerformanceCountLow;</pre>
        </td>
        <td>3.51 to 5.0 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0228 (3.10) </td>
        <td>&nbsp;</td>
        <td>unknown <span class="struct">KMUTEX</span> </td>
        <td>3.10 only </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0248 (3.10) </td>
        <td>&nbsp;</td>
        <td>unknown <span class="struct">TOKEN</span> pointer </td>
        <td>3.10 only </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x024C (3.10) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">TOKEN *Token;</pre>
        </td>
        <td>3.10 only </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0250 (3.10) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">BOOLEAN CopyOnOpen;</pre>
        </td>
        <td>3.10 only </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0251 (3.10) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">BOOLEAN EffectiveOnly;</pre>
        </td>
        <td>3.10 only </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0252 (3.10) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">BOOLEAN LpcExitThreadCalled;</pre>
        </td>
        <td>3.10 only </td>
        <td>next at 0x0238 </td>
      </tr>
      <tr>
        <td>0x0254 (3.10) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">SECURITY_IMPERSONATION_LEVEL ImpersonationLevel;</pre>
        </td>
        <td>3.10 only </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td rowspan="2">0x0208 (3.50 to 5.0); <br>
        0x020C (5.1); <br>
        0x0214 (early 5.2); <br>
        0x0204 (late 5.2); <br>
        0x0228 (6.0); <br>
        0x0248 (6.1); <br>
        0x0230 (6.2); <br>
        0x0380 (6.3); <br>
        0x0390 (10.0 to 1607); <br>
        0x0398 (1703 to 1809); <br>
        0x03A0 (1903); <br>
        0x02C8 </td>
        <td rowspan="2">0x03A8 (late 5.2); <br>
        0x0390 (v. late 5.2); <br>
        0x03B0 (6.0); <br>
        0x03E0 (6.1); <br>
        0x03C8 (6.2); <br>
        0x0650 (6.3); <br>
        0x0658 (10.0 to 1511); <br>
        0x0660 (1607); <br>
        0x0668 (1703 to 1809); <br>
        0x0678 (1903); <br>
        0x04A8 </td>
        <td>
        <pre class="source">PS_IMPERSONATION_INFORMATION *ImpersonationInfo;</pre>
        </td>
        <td>3.50 to 5.2 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>
        <pre class="source">PS_CLIENT_SECURITY_CONTEXT ClientSecurity;</pre>
        </td>
        <td>6.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
    </tbody>
  </table>
  <p>The names for the version 3.10 members <span class="member">Token</span>,
  <span class="member">CopyOnOpen</span>, <span class="member">EffectiveOnly</span> 
  and <span class="member">ImpersonationLevel</span> are here duplicated from the 
  structure that symbol files later name as a <span class="struct">PS_IMPERSONATION_INFORMATION</span>. 
  In effect, version 3.10 has the whole of this structure where later versions have 
  only a pointer to it. See, however, that version 3.10 doesn’t actually have the 
  structure as a member, named or not, due to intrusion of the apparently unrelated
  <span class="member">LpcExitThreadCalled</span> (which soon moves to nearly the 
  end of the <span class="struct">KTHREAD</span>). </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions"><col class="Remarks">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
        <th>Remarks </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x0258 (3.10); <br>
        0x020C (3.50 to 5.0); <br>
        0x0210 (5.1); <br>
        0x0218 (early 5.2); <br>
        0x0208 (late 5.2); <br>
        0x022C (6.0); <br>
        0x024C (6.1); <br>
        0x0234 (6.2); <br>
        0x0384 (6.3); <br>
        0x0394 (10.0 to 1607); <br>
        0x039C (1703 to 1809); <br>
        0x03A4 (1903); <br>
        0x02CC </td>
        <td>0x03B0 (late 5.2); <br>
        0x0398 (v. late 5.2); <br>
        0x03B8 (6.0); <br>
        0x03E8 (6.1); <br>
        0x03D0 (6.2); <br>
        0x0658 (6.3); <br>
        0x0660 (10.0 to 1511); <br>
        0x0668 (1607); <br>
        0x0670 (1703 to 1809); <br>
        0x0680 (1903); <br>
        0x04B0 </td>
        <td>
        <pre class="source">LIST_ENTRY IrpList;</pre>
        </td>
        <td>all </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0260 (3.10); <br>
        0x0214 (3.50 to 5.0); <br>
        0x0218 (5.1); <br>
        0x0220 (early 5.2); <br>
        0x0210 (late 5.2); <br>
        0x0234 (6.0); <br>
        0x0254 (6.1); <br>
        0x023C (6.2); <br>
        0x038C (6.3); <br>
        0x039C (10.0 to 1607); <br>
        0x03A4 (1703 to 1809); <br>
        0x03AC (1903); <br>
        0x02D4 </td>
        <td>0x03C0 (late 5.2); <br>
        0x03A8 (v. late 5.2); <br>
        0x03C8 (6.0); <br>
        0x03F8 (6.1); <br>
        0x03E0 (6.2); <br>
        0x0668 (6.3); <br>
        0x0670 (10.0 to 1511); <br>
        0x0678 (1607); <br>
        0x0680 (1703 to 1809); <br>
        0x0690 (1903); <br>
        0x04C0 </td>
        <td>
        <pre class="source">ULONG_PTR TopLevelIrp;</pre>
        </td>
        <td>all </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0264 (3.10); <br>
        0x0218 (3.50 to 5.0); <br>
        0x021C (5.1); <br>
        0x0224 (early 5.2); <br>
        0x0214 (late 5.2); <br>
        0x0238 (6.0); <br>
        0x0258 (6.1); <br>
        0x0240 (6.2); <br>
        0x0390 (6.3); <br>
        0x03A0 (10.0 to 1607); <br>
        0x03A8 (1703 to 1809); <br>
        0x03B0 (1903); <br>
        0x02D8 </td>
        <td>0x03C8 (late 5.2); <br>
        0x03B0 (v. late 5.2); <br>
        0x03D0 (6.0); <br>
        0x0400 (6.1); <br>
        0x03E8 (6.2); <br>
        0x0670 (6.3); <br>
        0x0678 (10.0 to 1511); <br>
        0x0680 (1607); <br>
        0x0688 (1703 to 1809); <br>
        0x0698 (1903); <br>
        0x04C8 </td>
        <td>
        <pre class="source">DEVICE_OBJECT *DeviceToVerify;</pre>
        </td>
        <td>all </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0268 (3.10) </td>
        <td>&nbsp;</td>
        <td>unknown dword </td>
        <td>3.10 only </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x026C (3.10) </td>
        <td>&nbsp;</td>
        <td>unknown array of two unknown 0x1C-byte structures </td>
        <td>3.10 only </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x02A4 (3.10); <br>
        0x021C (3.50 to 5.0) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">ULONG ReadClusterSize;</pre>
        </td>
        <td>3.10 to 5.0 </td>
        <td>next at 0x0240 </td>
      </tr>
      <tr>
        <td>0x02A8 (3.10); <br>
        0x0220 (3.50 to 5.0) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">BOOLEAN ForwardClusterOnly;</pre>
        </td>
        <td>3.10 to 5.0 </td>
        <td>next at 0x0254 </td>
      </tr>
      <tr>
        <td>0x02A9 (3.10); <br>
        0x0221 (3.50 to 5.0) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">BOOLEAN DisablePageFaultClustering;</pre>
        </td>
        <td>3.10 to 5.0 </td>
        <td>next at 0x0255 </td>
      </tr>
      <tr>
        <td>0x02AA (3.10); <br>
        0x0222 (3.50 to 5.0) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">BOOLEAN DeadThread;</pre>
        </td>
        <td>3.10 to 5.0 </td>
        <td>next as bit in <span class="member">CrossThreadFlags</span> </td>
      </tr>
      <tr>
        <td>0x0223 (5.0) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">BOOLEAN HideFromDebugger;</pre>
        </td>
        <td>5.0 only </td>
        <td>next as bit in <span class="member">CrossThreadFlags</span> </td>
      </tr>
      <tr>
        <td rowspan="2">0x02AB (3.10); <br>
        0x0223 (3.50 to 4.0); <br>
        0x0224 (5.0) </td>
        <td rowspan="2">&nbsp;</td>
        <td>
        <pre class="source">BOOLEAN HasTerminated;</pre>
        </td>
        <td>3.10 to 4.0 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>
        <pre class="source">ULONG HasTerminated;</pre>
        </td>
        <td>5.0 only </td>
        <td>next as bit in <span class="member">CrossThreadFlags</span> </td>
      </tr>
      <tr>
        <td>0x02AC (3.10); <br>
        0x0224 (3.50 to 4.0) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">EEVENT_PAIR *EventPair;</pre>
        </td>
        <td>3.10 to 4.0 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x02B0 (3.10) </td>
        <td>&nbsp;</td>
        <td>unknown <span class="struct">LARGE_INTEGER</span> </td>
        <td>3.10 only </td>
        <td>&nbsp;</td>
      </tr>
    </tbody>
  </table>
  <p>The <span class="member">EventPair</span> is the address of an event-pair object 
  for a user-mode client and server to synchronise their work through the NTDLL 
  functions <span class="function">NtSetLowWaitHighThread</span> and
  <span class="function">NtSetHighWaitLowThread</span>. That Microsoft used the 
  name <span class="member">EventPair</span> for this member is known from the USERKDX.DLL 
  debugger extension for Windows NT 4.0. Type information in CRASHLIB.LIB from an 
  SDK for Windows NT 4.0 not only names the member but its type. </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions"><col class="Remarks">
    </colgroup>
    <tbody>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
        <th>Remarks </th>
      </tr>
      <tr>
        <td>0x02B8 (3.10); <br>
        0x0228 (3.50 to 5.0) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">ACCESS_MASK GrantedAccess;</pre>
        </td>
        <td>3.10 to 5.0 </td>
        <td>next at 0x0244 </td>
      </tr>
      <tr>
        <td>0x02BC (3.10); <br>
        0x022C (3.50 to 5.0); <br>
        0x0220 (5.1); <br>
        0x0228 (early 5.2); <br>
        0x0218 (late 5.2) </td>
        <td>0x03D0 (late 5.2); <br>
        0x03B8 (v. late 5.2) </td>
        <td>
        <pre class="source"><a href="../../ke/kprocess/index.htm">KPROCESS</a> *ThreadsProcess;</pre>
        </td>
        <td>3.10 to 5.2 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x02C0 (3.10); <br>
        0x0230 (3.50 to 5.0); <br>
        0x0224 (5.1); <br>
        0x022C (early 5.2); <br>
        0x021C (late 5.2) </td>
        <td>0x03D8 (late 5.2); <br>
        0x03C0 (v. late 5.2) </td>
        <td>
        <pre class="source">PVOID StartAddress;</pre>
        </td>
        <td>3.10 to 5.2 </td>
        <td>next at 0x01F8 and 0x0358 </td>
      </tr>
      <tr>
        <td>0x02C4 (3.10) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">LIST_ENTRY PostBlockList;</pre>
        </td>
        <td>3.10 only </td>
        <td>next at 0x01C4 </td>
      </tr>
      <tr>
        <td rowspan="2">0x023C (6.0); <br>
        0x025C (6.1) </td>
        <td rowspan="2">0x03D8 (6.0); <br>
        0x0408 (6.1) </td>
        <td>
        <pre class="source">PSP_RATE_APC *RateControlApc;</pre>
        </td>
        <td>6.0 only </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>
        <pre class="source">PSP_CPU_QUOTA_APC *CpuQuotaApc;</pre>
        </td>
        <td>6.1 only </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td rowspan="2">0x02CC (3.10); <br>
        0x0234 (3.50 to 5.0); <br>
        0x0228 (5.1); <br>
        0x0230 (early 5.2); <br>
        0x0220 (late 5.2); <br>
        0x0240 (6.0); <br>
        0x0260 (6.1); <br>
        0x0244 (6.2); <br>
        0x0394 (6.3); <br>
        0x03A4 (10.0 to 1607); <br>
        0x03AC (1703 to 1809); <br>
        0x03B4 (1903); <br>
        0x02DC </td>
        <td rowspan="2">0x03E0 (late 5.2); <br>
        0x03C8 (v. late 5.2); <br>
        0x03E0 (6.0); <br>
        0x0410 (6.1); <br>
        0x03F0 (6.2); <br>
        0x0678 (6.3); <br>
        0x0680 (10.0 to 1511); <br>
        0x0688 (1607); <br>
        0x0690 (1703 to 1809); <br>
        0x06A0 (1903); <br>
        0x04D0 </td>
        <td>
        <pre class="source">union {
    PVOID Win32StartAddress;
    ULONG LpcReceivedMessageId;
};</pre>
        </td>
        <td>3.10 to 5.2 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>
        <pre class="source">PVOID Win32StartAddress;</pre>
        </td>
        <td>6.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x02D0 (3.10) </td>
        <td>&nbsp;</td>
        <td>unknown pointer </td>
        <td>3.10 only </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x02D4 (3.10) </td>
        <td>&nbsp;</td>
        <td>unaccounted 0x14 bytes </td>
        <td>3.10 only </td>
        <td>last member in 3.10 </td>
      </tr>
      <tr>
        <td>0x0238 (3.50 to 5.0) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">BOOLEAN LpcExitThreadCalled;</pre>
        </td>
        <td>3.50 to 5.0 </td>
        <td>previously at 0x0252; <br>
        next as bit in <span class="member">SameThreadApcFlags</span> </td>
      </tr>
      <tr>
        <td>0x0239 (3.50 to 5.0) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">BOOLEAN HardErrorsAreDisabled;</pre>
        </td>
        <td>3.50 to 5.0 </td>
        <td>next as bit in <span class="member">CrossThreadFlags</span> </td>
      </tr>
      <tr>
        <td>0x023A (3.50 to 5.0) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">BOOLEAN LpcReceivedMsgIdValid;</pre>
        </td>
        <td>3.50 to 5.0 </td>
        <td>next as bit in <span class="member">SameThreadApcFlags</span> </td>
      </tr>
      <tr>
        <td>0x023B (4.0 to 5.0) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">BOOLEAN ActiveImpersonationInfo;</pre>
        </td>
        <td>4.0 to 5.0 </td>
        <td>next as bit in <span class="member">CrossThreadFlags</span> </td>
      </tr>
      <tr>
        <td>0x023C (3.50 to 5.0) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">LONG PerformanceCountHigh;</pre>
        </td>
        <td>3.50 to 5.0 </td>
        <td>last member in 3.50; <br>
        last member in 3.51; <br>
        last member in 4.0 </td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>0x0698 (1709 to 1809); <br>
        0x06A8 (1903); <br>
        0x04D8 </td>
        <td>
        <pre class="source">PVOID ChargeOnlySession;</pre>
        </td>
        <td>1709 and higher </td>
        <td>previously at 0x0600 </td>
      </tr>
      <tr>
        <td rowspan="2">0x0244 (6.0); <br>
        0x0264 (6.1); <br>
        0x0248 (6.2); <br>
        0x0398 (6.3); <br>
        0x03A8 (10.0 to 1607); <br>
        0x03B0 (1703 to 1809); <br>
        0x03B8 (1903); <br>
        0x02E0 </td>
        <td rowspan="2">0x03E8 (6.0); <br>
        0x0418 (6.1); <br>
        0x03F8 (6.2); <br>
        0x0680 (6.3); <br>
        0x0688 (10.0 to 1511); <br>
        0x0690 (1607); <br>
        0x0698 (1703); <br>
        0x06A0 (1709 to 1809); <br>
        0x06B0 (1903); <br>
        0x04E0 </td>
        <td>
        <pre class="source">PVOID SparePtr0;</pre>
        </td>
        <td>6.0 only </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>
        <pre class="source">PVOID LegacyPowerObject;</pre>
        </td>
        <td>6.1 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0240 (5.0); <br>
        0x022C (5.1); <br>
        0x0234 (early 5.2); <br>
        0x0224 (late 5.2); <br>
        0x0248 (6.0); <br>
        0x0268 (6.1); <br>
        0x024C (6.2); <br>
        0x039C (6.3); <br>
        0x03AC (10.0 to 1607); <br>
        0x03B4 (1703 to 1809); <br>
        0x03BC (1903); <br>
        0x02E4 </td>
        <td>0x03E8 (late 5.2); <br>
        0x03D0 (v. late 5.2); <br>
        0x03F0 (6.0); <br>
        0x0420 (6.1); <br>
        0x0400 (6.2); <br>
        0x0688 (6.3); <br>
        0x0690 (10.0 to 1511); <br>
        0x0698 (1607); <br>
        0x06A0 (1703); <br>
        0x06A8 (1709 to 1809); <br>
        0x06B8 (1903); <br>
        0x04E8 </td>
        <td>
        <pre class="source">LIST_ENTRY ThreadListEntry;</pre>
        </td>
        <td>5.0 and higher </td>
        <td>last member in 5.0 </td>
      </tr>
    </tbody>
  </table>
  <h3>Appended for Windows XP </h3>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions"><col class="Remarks">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
        <th>Remarks </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x0234 (5.1); <br>
        0x023C (early 5.2); <br>
        0x022C (late 5.2); <br>
        0x0250 (6.0); <br>
        0x0270 (6.1); <br>
        0x0254 (6.2); <br>
        0x03A4 (6.3); <br>
        0x03B4 (10.0 to 1607); <br>
        0x03BC (1703 to 1809); <br>
        0x03C4 (1903); <br>
        0x02EC </td>
        <td>0x03F8 (late 5.2); <br>
        0x03E0 (v. late 5.2); <br>
        0x0400 (6.0); <br>
        0x0430 (6.1); <br>
        0x0410 (6.2); <br>
        0x0698 (6.3); <br>
        0x06A0 (10.0 to 1511); <br>
        0x06A8 (1607); <br>
        0x06B0 (1703); <br>
        0x06B8 (1709 to 1809); <br>
        0x06C8 (1903); <br>
        0x04F8 </td>
        <td>
        <pre class="source">EX_RUNDOWN_REF RundownProtect;</pre>
        </td>
        <td>5.1 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0238 (5.1); <br>
        0x0240 (early 5.2); <br>
        0x0230 (late 5.2); <br>
        0x0254 (6.0); <br>
        0x0274 (6.1); <br>
        0x0258 (6.2); <br>
        0x03A8 (6.3); <br>
        0x03B8 (10.0 to 1607); <br>
        0x03C0 (1703 to 1809); <br>
        0x03C8 (1903); <br>
        0x02F0 </td>
        <td>0x0400 (late 5.2); <br>
        0x03E8 (v. late 5.2); <br>
        0x0408 (6.0); <br>
        0x0438 (6.1); <br>
        0x0418 (6.2); <br>
        0x06A0 (6.3); <br>
        0x06A8 (10.0 to 1511); <br>
        0x06B0 (1607); <br>
        0x06B8 (1703); <br>
        0x06C0 (1709 to 1809); <br>
        0x06D0 (1903); <br>
        0x0500 </td>
        <td>
        <pre class="source">EX_PUSH_LOCK ThreadLock;</pre>
        </td>
        <td>5.1 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x023C (5.1); <br>
        0x0244 (early 5.2); <br>
        0x0234 (late 5.2) </td>
        <td>0x0408 (late 5.2); <br>
        0x03F0 (v. late 5.2) </td>
        <td>
        <pre class="source">ULONG LpcReplyMessageId;</pre>
        </td>
        <td>5.1 to 5.2 </td>
        <td>previously at 0x0200 </td>
      </tr>
      <tr>
        <td>0x0240 (5.1); <br>
        0x0248 (early 5.2); <br>
        0x0238 (late 5.2); <br>
        0x0258 (6.0); <br>
        0x0278 (6.1); <br>
        0x025C (6.2); <br>
        0x03AC (6.3); <br>
        0x03BC (10.0 to 1607); <br>
        0x03C4 (1703 to 1809); <br>
        0x03CC (1903); <br>
        0x02F4 </td>
        <td>0x040C (late 5.2); <br>
        0x03F4 (v. late 5.2); <br>
        0x0410 (6.0); <br>
        0x0440 (6.1); <br>
        0x0420 (6.2); <br>
        0x06A8 (6.3); <br>
        0x06B0 (10.0 to 1511); <br>
        0x06B8 (1607); <br>
        0x06C0 (1703); <br>
        0x06C8 (1709 to 1809); <br>
        0x06D8 (1903); <br>
        0x0508 </td>
        <td>
        <pre class="source">ULONG ReadClusterSize;</pre>
        </td>
        <td>5.1 and higher </td>
        <td>previously at 0x021C </td>
      </tr>
      <tr>
        <td>0x0244 (5.1); <br>
        0x024C (early 5.2); <br>
        0x023C (late 5.2) </td>
        <td>0x0410 (late 5.2); <br>
        0x03F8 (v. late 5.2) </td>
        <td>
        <pre class="source">ACCESS_MASK GrantedAccess;</pre>
        </td>
        <td>5.1 to 5.2 </td>
        <td>previously at 0x0228 </td>
      </tr>
      <tr>
        <td>0x025C (6.0); <br>
        0x027C (6.1); <br>
        0x0260 (6.2); <br>
        0x03B0 (6.3); <br>
        0x03C0 (10.0 to 1607); <br>
        0x03C8 (1703 to 1809); <br>
        0x03D0 (1903); <br>
        0x02F8 </td>
        <td>0x0414 (6.0); <br>
        0x0444 (6.1); <br>
        0x0424 (6.2); <br>
        0x06AC (6.3); <br>
        0x06B4 (10.0 to 1511); <br>
        0x06BC (1607); <br>
        0x06C4 (1703); <br>
        0x06CC (1709 to 1809); <br>
        0x06DC (1903); <br>
        0x050C </td>
        <td>
        <pre class="source">LONG volatile MmLockOrdering;</pre>
        </td>
        <td>6.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0264 (6.2); <br>
        0x03B4 (6.3); <br>
        0x03C4 (10.0 to 1511) </td>
        <td>0x0428 (6.2); <br>
        0x06B0 (6.3); <br>
        0x06B8 (10.0 to 1511) </td>
        <td>
        <pre class="source">LONG volatile CmLockOrdering;</pre>
        </td>
        <td>6.2 to 1511 </td>
        <td>&nbsp;</td>
      </tr>
    </tbody>
  </table>
  <p>Windows XP gathered seven booleans into bit fields in three sets, whose assignment 
  of bits to functionality inevitably changes through successive versions: </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x0248 (5.1); <br>
        0x0250 (early 5.2); <br>
        0x0240 (late 5.2); <br>
        0x0260 (6.0); <br>
        0x0280 (6.1); <br>
        0x0268 (6.2); <br>
        0x03B8 (6.3); <br>
        0x03C8 (10.0 to 1511); <br>
        0x03C4 (1607); <br>
        0x03CC (1703 to 1809); <br>
        0x03D4 (1903); <br>
        0x02FC </td>
        <td>0x0414 (late 5.2); <br>
        0x03FC (v. late 5.2); <br>
        0x0418 (6.0); <br>
        0x0448 (6.1); <br>
        0x042C (6.2); <br>
        0x06B4 (6.3); <br>
        0x06BC (10.0 to 1511); <br>
        0x06C0 (1607); <br>
        0x06C8 (1703); <br>
        0x06D0 (1709 to 1809); <br>
        0x06E0 (1903); <br>
        0x0510 </td>
        <td>
        <pre class="source">union {
    ULONG <a href="crossthreadflags.htm">CrossThreadFlags</a>;
    struct {
        /*  bit fields, follow link  */
    };
};</pre>
        </td>
        <td>5.1 and higher </td>
      </tr>
      <tr>
        <td>0x024C (5.1); <br>
        0x0254 (early 5.2); <br>
        0x0244 (late 5.2); <br>
        0x0264 (6.0); <br>
        0x0284 (6.1); <br>
        0x026C (6.2); <br>
        0x03BC (6.3); <br>
        0x03CC (10.0 to 1511); <br>
        0x03C8 (1607); <br>
        0x03D0 (1703 to 1809); <br>
        0x03D8 (1903); <br>
        0x300 <br>
        </td>
        <td>0x0418 (late 5.2); <br>
        0x0400 (v. late 5.2); <br>
        0x041C (6.0); <br>
        0x044C (6.1); <br>
        0x0430 (6.2); <br>
        0x06B8 (6.3); <br>
        0x06C0 (10.0 to 1511); <br>
        0x06C4 (1607); <br>
        0x06CC (1703); <br>
        0x06D4 (1709 to 1809); <br>
        0x6E4 (1903); <br>
        0x514 </td>
        <td>
        <pre class="source">union {
    ULONG <a href="samethreadpassiveflags.htm">SameThreadPassiveFlags</a>;
    struct {
        /*  bit fields, follow link  */
    };
};</pre>
        </td>
        <td>5.1 and higher </td>
      </tr>
      <tr>
        <td>0x0250 (5.1); <br>
        0x0258 (early 5.2); <br>
        0x0248 (late 5.2); <br>
        0x0268 (6.0); <br>
        0x0288 (6.1); <br>
        0x0270 (6.2); <br>
        0x03C0 (6.3); <br>
        0x03D0 (10.0 to 1511); <br>
        0x03CC (1607); <br>
        0x03D4 (1703 to 1809); <br>
        0x03DC (1903); <br>
        0x0304 </td>
        <td>0x041C (late 5.2); <br>
        0x0404 (v. late 5.2); <br>
        0x0420 (6.0); <br>
        0x0450 (6.1); <br>
        0x0434 (6.2); <br>
        0x06BC (6.3); <br>
        0x06C4 (10.0 to 1511); <br>
        0x06C8 (1607); <br>
        0x06D0 (1703); <br>
        0x06D8 (1709 to 1809); <br>
        0x06E8 (1903); <br>
        0x0518 </td>
        <td>
        <pre class="source">union {
    ULONG <a href="samethreadapcflags.htm">SameThreadApcFlags</a>;
    struct {
        /*  bit fields, follow link  */
    };
};</pre>
        </td>
        <td>5.1 and higher </td>
      </tr>
    </tbody>
  </table>
  <p>For who knows what reason, two booleans weren’t changed to bit fields but were 
  merely shifted to the structure’s end. </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions"><col class="Remarks">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
        <th>Remarks </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x0254 (5.1); <br>
        0x025C (early 5.2); <br>
        0x024C (late 5.2) </td>
        <td>0x0420 (late 5.2); <br>
        0x0408 (v. late 5.2) </td>
        <td>
        <pre class="source">BOOLEAN ForwardClusterOnly;</pre>
        </td>
        <td>5.1 to 5.2 </td>
        <td>previously at 0x0220 </td>
      </tr>
      <tr>
        <td>0x026C (6.0); <br>
        0x028C (6.1); <br>
        0x0274 (6.2); <br>
        0x03C4 (6.3); <br>
        0x03D4 (10.0 to 1511); <br>
        0x03D0 (1607); <br>
        0x03D8 (1709 to 1809); <br>
        0x03E0 (1903); <br>
        0x0308 </td>
        <td>0x0424 (6.0); <br>
        0x0454 (6.1); <br>
        0x0438 (6.2); <br>
        0x06C0 (6.3); <br>
        0x06C8 (10.0 to 1511); <br>
        0x06CC (1607); <br>
        0x06D4 (1703); <br>
        0x06DC (1709 to 1809); <br>
        0x06EC (1903); <br>
        0x051C </td>
        <td>
        <pre class="source">BOOLEAN CacheManagerActive;</pre>
        </td>
        <td>6.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0255 (5.1); <br>
        0x0x25D (early 5.2); <br>
        0x024D (late 5.2); <br>
        0x026D (6.0); <br>
        0x028D (6.1); <br>
        0x0275 (6.2); <br>
        0x03C5 (6.3); <br>
        0x03D5 (10.0 to 1511); <br>
        0x03D1 (1607); <br>
        0x03D9 (1709 to 1809); <br>
        0x03E1 (1903); <br>
        0x0309 </td>
        <td>0x0421 (late 5.2); <br>
        0x0409 (v. late 5.2); <br>
        0x0425 (6.0); <br>
        0x0455 (6.1); <br>
        0x0439 (6.2); <br>
        0x06C1 (6.3); <br>
        0x06C9 (10.0 to 1511); <br>
        0x06CD (1607); <br>
        0x06D5 (1703); <br>
        0x06DD (1709 to 1803); <br>
        0x06ED (1903); <br>
        0x051D </td>
        <td>
        <pre class="source">BOOLEAN DisablePageFaultClustering;</pre>
        </td>
        <td>5.1 and higher </td>
        <td>previously at 0x0221; <br>
        last member in 5.1; <br>
        last member in early 5.2 </td>
      </tr>
    </tbody>
  </table>
  <h3>Appended for Windows Server 2003 SP1 </h3>
  <p>For all that the build of version 5.2 for Windows Server 2003 SP1 rearranged 
  the <span class="struct">KTHREAD</span>, it added just one byte beyond in the
  <span class="struct">ETHREAD</span>, and it anyway fits into alignment space. 
  Indeed, through versions 5.1 and 5.2, the <span class="struct">ETHREAD</span> 
  is in some sense very stable: that members shift and that the structure changes 
  size is only because of the <span class="struct">KTHREAD</span>. </p>
  <p>Even after this addition for Windows Server 2003 SP1, one byte of unnamed alignment 
  space remained until Windows 7 found a use for it: </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions"><col class="Remarks">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
        <th>Remarks </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x024E (late 5.2); <br>
        0x026E (6.0); <br>
        0x028E (6.1); <br>
        0x0276 (6.2); <br>
        0x03C6 (6.3); <br>
        0x03D6 (10.0 to 1511); <br>
        0x03D2 (1607); <br>
        0x03DA (1709 to 1809); <br>
        0x03E2 (1903); <br>
        0x030A </td>
        <td>0x0422 (late 5.2); <br>
        0x040A (v. late 5.2); <br>
        0x0426 (6.0); <br>
        0x0456 (6.1); <br>
        0x043A (6.2); <br>
        0x06C2 (6.3); <br>
        0x06CA (10.0 to 1511); <br>
        0x06CE (1607); <br>
        0x06D6 (1703); <br>
        0x06DE (1709 to 1803); <br>
        0x051E </td>
        <td>
        <pre class="source">UCHAR ActiveFaultCount;</pre>
        </td>
        <td>late 5.2 and higher </td>
        <td>last member in late 5.2; <br>
        last member in v. late 5.2 </td>
      </tr>
      <tr>
        <td>0x028F (6.1); <br>
        0x0277 (6.2); <br>
        0x03C7 (6.3); <br>
        0x03D7 (10.0 to 1511); <br>
        0x03D3 (1607); <br>
        0x03DB (1709 to 1809); <br>
        0x03E3 (1903); <br>
        0x030B </td>
        <td>0x0457 (6.1); <br>
        0x043B (6.2); <br>
        0x06C3 (6.3); <br>
        0x06CB (10.0 to 1511); <br>
        0x06CF (1607); <br>
        0x06D7 (1703); <br>
        0x06DF (1709 to 1809); <br>
        0x06EF (1903); <br>
        0x051F </td>
        <td>
        <pre class="source">UCHAR LockOrderState;</pre>
        </td>
        <td>6.1 and higher </td>
        <td>&nbsp;</td>
      </tr>
    </tbody>
  </table>
  <h3>Appended for Windows Vista </h3>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions"><col class="Remarks">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
        <th>Remarks </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x030C </td>
        <td>0x0520 </td>
        <td>
        <pre class="source">ULONG PerformanceCountLowReserved;</pre>
        </td>
        <td>2004 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0310 </td>
        <td>0x0524 </td>
        <td>
        <pre class="source">LONG PerformanceCountHighReserved;</pre>
        </td>
        <td>2004 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0270 (6.0); <br>
        0x0290 (6.1); <br>
        0x0278 (6.2); <br>
        0x03C8 (6.3); <br>
        0x03D8 (10.0 to 1511); <br>
        0x03D4 (1607); <br>
        0x03DC (1703 to 1809); <br>
        0x03E4 (1903); <br>
        0x0314 </td>
        <td>0x0428 (6.0); <br>
        0x0458 (6.1); <br>
        0x0440 (6.2); <br>
        0x06C8 (6.3); <br>
        0x06D0 (10.0 to 1607); <br>
        0x06D8 (1703); <br>
        0x06E0 (1709 to 1809); <br>
        0x06F0 (1903); <br>
        0x0528 </td>
        <td>
        <pre class="source">ULONG_PTR AlpcMessageId;</pre>
        </td>
        <td>6.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0274 (6.0); <br>
        0x0294 (6.1); <br>
        0x027C (6.2); <br>
        0x03CC (6.3); <br>
        0x03DC (10.0 to 1511); <br>
        0x03D8 (1607); <br>
        0x03E0 (1703 to 1809); <br>
        0x03E8 (1903); <br>
        0x0318 </td>
        <td>0x0430 (6.0); <br>
        0x0460 (6.1); <br>
        0x0448 (6.2); <br>
        0x06D0 (6.3); <br>
        0x06D8 (10.0 to 1607); <br>
        0x06E0 (1703); <br>
        0x06E8 (1709 to 1809); <br>
        0x06F8 (1903); <br>
        0x0530 </td>
        <td>
        <pre class="source">union {
    PVOID AlpcMessage;
    ULONG AlpcReceiveAttributeSet;
};</pre>
        </td>
        <td>6.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0280 (6.2); <br>
        0x03D0 (6.3); <br>
        0x03E0 (10.0 to 1511) <br>
        </td>
        <td>0x0450 (6.2); <br>
        0x06D8 (6.3); <br>
        0x06E0 (10.0 to 1511) </td>
        <td>
        <pre class="source">LONG ExitStatus;</pre>
        </td>
        <td>6.2 to 1511 </td>
        <td>previously at 0x0210 and 0x0378; <br>
        next at 0x03E4 and 0x06F0 </td>
      </tr>
      <tr>
        <td>0x0278 (6.0); <br>
        0x0298 (6.1); <br>
        0x0284 (6.2); <br>
        0x03D4 (6.3); <br>
        0x03E4 (10.0 to 1511); <br>
        0x03DC (1607); <br>
        0x03E4 (1703 to 1809); <br>
        0x03EC (1903); <br>
        0x031C </td>
        <td>0x0438 (6.0); <br>
        0x0468 (6.1); <br>
        0x0458 (6.2); <br>
        0x06E0 (6.3); <br>
        0x06E8 (10.0 to 1511); <br>
        0x06E0 (1607); <br>
        0x06E8 (1703); <br>
        0x06F0 (1709 to 1809); <br>
        0x0700 (1903); <br>
        0x0538 </td>
        <td>
        <pre class="source">LIST_ENTRY AlpcWaitListEntry;</pre>
        </td>
        <td>6.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x03E4 (1607); <br>
        0x03EC (1703 to 1809); <br>
        0x03F4 (1903); <br>
        0x0324 </td>
        <td>0x06F0 (1607); <br>
        0x06F8 (1703); <br>
        0x0700 (1709 to 1809); <br>
        0x0710 (1903); <br>
        0x0548 </td>
        <td>
        <pre class="source">NTSTATUS ExitStatus;</pre>
        </td>
        <td>1607 and higher </td>
        <td>previously at 0x03E4 and 0x06E0 </td>
      </tr>
      <tr>
        <td>0x0280 (6.0); <br>
        0x02A0 (6.1); <br>
        0x028C (6.2); <br>
        0x03DC (6.3); <br>
        0x03EC (10.0 to 1511); <br>
        0x03E8 (1607); <br>
        0x03F0 (1703 to 1809); <br>
        0x03F8 (1903); <br>
        0x0328 </td>
        <td>0x0448 (6.0); <br>
        0x0478 (6.1); <br>
        0x0468 (6.2); <br>
        0x06F0 (6.3); <br>
        0x06F8 (10.0 to 1511); <br>
        0x06F4 (1607); <br>
        0x06FC (1703); <br>
        0x0704 (1709 to 1809); <br>
        0x0714 (1903); <br>
        0x054C </td>
        <td>
        <pre class="source">ULONG CacheManagerCount;</pre>
        </td>
        <td>6.0 and higher </td>
        <td>last member in 6.0 </td>
      </tr>
    </tbody>
  </table>
  <h3>Appended for Windows 7 </h3>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions"><col class="Remarks">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
        <th>Remarks </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x02A4 (6.1); <br>
        0x0290 (6.2); <br>
        0x03E0 (6.3); <br>
        0x03F0 (10.0 to 1511); <br>
        0x03EC (1607); <br>
        0x03F4 (1703 to 1809); <br>
        0x03FC (1903); <br>
        0x032C </td>
        <td>0x047C (6.1); <br>
        0x046C (6.2); <br>
        0x06F4 (6.3); <br>
        0x06FC (10.0 to 1511); <br>
        0x06F8 (1607); <br>
        0x0700 (1703); <br>
        0x0708 (1709 to 1809); <br>
        0x0718 (1903); <br>
        0x0550 </td>
        <td>
        <pre class="source">ULONG IoBoostCount;</pre>
        </td>
        <td>6.1 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x03F0 (1607); <br>
        0x03F8 (1703 to 1809); <br>
        0x0400 (1903); <br>
        0x0330 </td>
        <td>0x06FC (1607); <br>
        0x0704 (1703); <br>
        0x07C0 (1709 to 1803); <br>
        0x071C (1903); <br>
        0x0554 </td>
        <td>
        <pre class="source">ULONG IoQoSBoostCount;</pre>
        </td>
        <td>1607 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x03F4 (1607); <br>
        0x03FC (1703 to 1809); <br>
        0x0404 (1903); <br>
        0x0334 </td>
        <td>0x0700 (1607); <br>
        0x0708 (1703); <br>
        0x0710 (1709 to 1809); <br>
        0x0720 (1903); <br>
        0x0558 </td>
        <td>
        <pre class="source">ULONG IoQoSThrottleCount;</pre>
        </td>
        <td>1607 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0400 (1809); <br>
        0x0408 (1903); <br>
        0x0338 </td>
        <td>0x0714 (1809); <br>
        0x0724 (1903); <br>
        0x055C </td>
        <td>
        <pre class="source">ULONG KernelStackReference;</pre>
        </td>
        <td>&nbsp;</td>
        <td>previously at 0x042C and 0x0770 </td>
      </tr>
      <tr>
        <td>0x0294 (6.2); <br>
        0x03E4 (6.3); <br>
        0x03F4 (10.0 to 1511); <br>
        0x03F8 (1607); <br>
        0x0400 (1703 to 1803); <br>
        0x0404 (1809); <br>
        0x040C (1903); <br>
        0x033C </td>
        <td>0x0470 (6.2); <br>
        0x06F8 (6.3); <br>
        0x0700 (10.0 to 1511); <br>
        0x0708 (1607); <br>
        0x0710 (1703); <br>
        0x0718 (1709 to 1809); <br>
        0x0728 (1903); <br>
        0x0560 </td>
        <td>
        <pre class="source">LIST_ENTRY BoostList;</pre>
        </td>
        <td>6.2 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x029C (6.2); <br>
        0x03EC (6.3); <br>
        0x03FC (10.0 to 1511); <br>
        0x0400 (1607); <br>
        0x0408 (1703 to 1803); <br>
        0x040C (1809); <br>
        0x0414 (1903); <br>
        0x0344 </td>
        <td>0x0480 (6.2); <br>
        0x0708 (6.3); <br>
        0x0710 (10.0 to 1511); <br>
        0x0718 (1607); <br>
        0x0720 (1703); <br>
        0x0728 (1709 to 1809); <br>
        0x0738 (1903); <br>
        0x0570 </td>
        <td>
        <pre class="source">LIST_ENTRY DeboostList;</pre>
        </td>
        <td>6.2 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x02A4 (6.2); <br>
        0x03F4 (6.3); <br>
        0x0404 (10.0 to 1511); <br>
        0x0408 (1607); <br>
        0x0410 (1703 to 1803); <br>
        0x0414 (1809); <br>
        0x041C (1903); <br>
        0x034C </td>
        <td>0x0490 (6.2); <br>
        0x0718 (6.3); <br>
        0x0720 (10.0 to 1511); <br>
        0x0728 (1607); <br>
        0x0730 (1703); <br>
        0x0738 (1709 to 1809); <br>
        0x0748 (1903); <br>
        0x0580 </td>
        <td>
        <pre class="source">KSPIN_LOCK BoostListLock;</pre>
        </td>
        <td>6.2 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x02A8 (6.1 to 6.2); <br>
        0x03F8 (6.3); <br>
        0x0408 (10.0 to 1511); <br>
        0x040C (1607); <br>
        0x0414 (1703 to 1803); <br>
        0x0418 (1809); <br>
        0x0420 (1903); <br>
        0x0350 </td>
        <td>0x0480 (6.1); <br>
        0x0498 (6.2); <br>
        0x0720 (6.3); <br>
        0x0728 (10.0 to 1511); <br>
        0x0730 (1607); <br>
        0x0738 (1703); <br>
        0x0740 (1709 to 1809); <br>
        0x0750 (1903); <br>
        0x0588 </td>
        <td>
        <pre class="source">KSPIN_LOCK IrpListLock;</pre>
        </td>
        <td>6.1 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x02AC (6.1 to 6.2); <br>
        0x03FC (6.3); <br>
        0x040C (10.0 to 1511); <br>
        0x0410 (1607); <br>
        0x0418 (1703 to 1803); <br>
        0x041C (1809); <br>
        0x0424 (1903); <br>
        0x0354 </td>
        <td>0x0488 (6.1); <br>
        0x04A0 (6.2); <br>
        0x0728 (6.3); <br>
        0x0730 (10.0 to 1511); <br>
        0x0738 (1607); <br>
        0x0740 (1703); <br>
        0x0748 (1709 to 1809); <br>
        0x0758 (1903); <br>
        0x0590 </td>
        <td>
        <pre class="source">PVOID ReservedForSynchTracking;</pre>
        </td>
        <td>6.1 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x02B0 (6.1 to 6.2); <br>
        0x0400 (6.3); <br>
        0x0410 (10.0 to 1511); <br>
        0x0414 (1607); <br>
        0x041C (1703 to 1803); <br>
        0x0420 (1809); <br>
        0x0428 (1903); <br>
        0x0358 </td>
        <td>0x0490 (6.1); <br>
        0x04A8 (6.2); <br>
        0x0730 (6.3); <br>
        0x0738 (10.0 to 1511); <br>
        0x0740 (1607); <br>
        0x0748 (1703); <br>
        0x0750 (1709 to 1809); <br>
        0x0760 (1903); <br>
        0x0598 </td>
        <td>
        <pre class="source">SINGLE_LIST_ENTRY CmCallbackListHead;</pre>
        </td>
        <td>6.1 and higher </td>
        <td>last member in 6.1 </td>
      </tr>
    </tbody>
  </table>
  <h3>Appended for Windows 8 </h3>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions"><col class="Remarks">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
        <th>Remarks </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x02B4 (6.2); <br>
        0x0404 (6.3); <br>
        0x0414 (10.0 to 1511); <br>
        0x0418 (1607); <br>
        0x0420 (1703 to 1803); <br>
        0x0424 (1809); <br>
        0x042C (1903); <br>
        0x035C </td>
        <td>0x04B0 (6.2); <br>
        0x0738 (6.3); <br>
        0x0740 (10.0 to 1511); <br>
        0x0748 (1607); <br>
        0x0750 (1703); <br>
        0x0758 (1709 to 1809); <br>
        0x0768 (1903); <br>
        0x05A0 </td>
        <td>
        <pre class="source">GUID const *ActivityId;</pre>
        </td>
        <td>6.2 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x02B8 (6.2) </td>
        <td>0x04B8 (6.2) </td>
        <td>
        <pre class="source">PVOID WnfContext;</pre>
        </td>
        <td>6.2 only </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0408 (6.3); <br>
        0x0418 (10.0 to 1511); <br>
        0x041C (1607); <br>
        0x0424 (1703 to 1803); <br>
        0x0428 (1809); <br>
        0x0430 (1903); <br>
        0x0360 </td>
        <td>0x0740 (6.3); <br>
        0x0748 (10.0 to 1511); <br>
        0x0750 (1607); <br>
        0x0758 (1703); <br>
        0x0760 (1709 to 1809); <br>
        0x0770 (1903); <br>
        0x05A8 </td>
        <td>
        <pre class="source">SINGLE_LIST_ENTRY SeLearningModeListHead;</pre>
        </td>
        <td>6.3 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x040C (6.3); <br>
        0x041C (10.0 to 1511); <br>
        0x0420 (1607); <br>
        0x0428 (1703 to 1803); <br>
        0x042C (1809); <br>
        0x0434 (1903); <br>
        0x0364 </td>
        <td>0x0748 (6.3); <br>
        0x0750 (10.0 to 1511); <br>
        0x0758 (1607); <br>
        0x0760 (1703); <br>
        0x0768 (1709 to 1809); <br>
        0x0778 (1903); <br>
        0x05B0 </td>
        <td>
        <pre class="source">PVOID VerifierContext;</pre>
        </td>
        <td>6.3 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x02BC (6.2); <br>
        0x0410 (6.3); <br>
        0x0420 (10.0 to 1511); <br>
        0x0424 (1607); <br>
        0x042C (1703 to 1803) </td>
        <td>0x04C0 (6.2); <br>
        0x0750 (6.3); <br>
        0x0758 (10.0 to 1511); <br>
        0x0760 (1607); <br>
        0x0768 (1703); <br>
        0x0770 (1709 to 1803) </td>
        <td>
        <pre class="source">ULONG KernelStackReference;</pre>
        </td>
        <td>6.2 to 1803 </td>
        <td>next at 0x0400 and 0x0714; <br>
        last member in 6.2 </td>
      </tr>
    </tbody>
  </table>
  <p>See that for 64-bit Windows 8, the 32-bit <span class="member">KernelStackReference</span> 
  left the structure to end with four bytes of alignment padding. That Windows 8.1 
  followed with a pointer (see next) turned this padding into wasted space which 
  the 1809 edition of Windows 10 reclaimed by moving the member to fill the alignment 
  space that 64-bit Windows 8 also wasted immediately before the
  <span class="member">BoostList</span> (above). </p>
  <h3>Appended for Windows 8.1 </h3>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions"><col class="Remarks">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
        <th>Remarks </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x0414 (6.3); <br>
        0x0424 (10.0 to 1511); <br>
        0x0428 (1607); <br>
        0x0430 (1703 to 1809); <br>
        0x0438 (1903); <br>
        0x0368 </td>
        <td>0x0758 (6.3); <br>
        0x0760 (10.0 to 1511); <br>
        0x0768 (1607); <br>
        0x0770 (1703); <br>
        0x0778 (1709 to 1803); <br>
        0x0770 (1809); <br>
        0x0780 (1903); <br>
        0x05B8 </td>
        <td>
        <pre class="source">PVOID AdjustedClientToken;</pre>
        </td>
        <td>6.3 and higher </td>
        <td>last member in 6.3 (x86) </td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>0x0760 (6.3) </td>
        <td>
        <pre class="source">ULONG UserFsBase;</pre>
        </td>
        <td>6.3 only </td>
        <td>next at 0x043C and 0x0790 </td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>0x0768 (6.3) </td>
        <td>
        <pre class="source">ULONGLONG UserGsBase;</pre>
        </td>
        <td>6.3 only </td>
        <td>next at 0x0440 and 0x0798 </td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>0x0770 (6.3) </td>
        <td>
        <pre class="source">PVOID PicoContext;</pre>
        </td>
        <td>6.3 only </td>
        <td>next at 0x0438 and 0x0788 <br>
        last member in 6.3 (x64) </td>
      </tr>
    </tbody>
  </table>
  <h3>Appended for Windows 10 </h3>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions"><col class="Remarks">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
        <th>Remarks </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td rowspan="2">0x0428 (10.0 to 1511); <br>
        0x042C (1607); <br>
        0x0434 (1703 to 1809); <br>
        0x043C (1903); <br>
        0x036C </td>
        <td rowspan="2">0x0768 (10.0 to 1511); <br>
        0x0770 (1607); <br>
        0x0778 (1703); <br>
        0x0780 (1709 to 1803); <br>
        0x0778 (1809); <br>
        0x0788 (1903); <br>
        0x05C0 </td>
        <td>
        <pre class="source">PVOID WorkingOnBehalfClient;</pre>
        </td>
        <td>10.0 to 1511 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>
        <pre class="source">PVOID WorkOnBehalfThread;</pre>
        </td>
        <td>1607 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x042C (10.0 to 1511); <br>
        0x0430 (1607); <br>
        0x0438 (1703 to 1809); <br>
        0x0440 (1903); <br>
        0x0370 </td>
        <td>0x0770 (10.0 to 1511); <br>
        0x0778 (1607); <br>
        0x0780 (1703); <br>
        0x0788 (1709 to 1803); <br>
        0x0780 (1809); <br>
        0x0790 (1903); <br>
        0x05C8 </td>
        <td>
        <pre class="source">PS_PROPERTY_SET PropertySet;</pre>
        </td>
        <td>10.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0438 (10.0 to 1511); <br>
        0x043C (1607); <br>
        0x0444 (1703 to 1809); <br>
        0x044C (1903); <br>
        0x037C </td>
        <td>0x0788 (10.0 to 1511); <br>
        0x0790 (1607); <br>
        0x0798 (1703); <br>
        0x07A0 (1709 to 1803); <br>
        0x0798 (1809); <br>
        0x07A8 (1903); <br>
        0x05E0 </td>
        <td>
        <pre class="source">PVOID PicoContext;</pre>
        </td>
        <td>10.0 and higher </td>
        <td>previously x64-only at 0x0770 </td>
      </tr>
      <tr>
        <td rowspan="2">0x043C (10.0 to 1511); <br>
        0x0440 (1607); <br>
        0x0448 (1703 to 1809); <br>
        0x0450 (1903); <br>
        0x0380 </td>
        <td rowspan="2">0x0790 (10.0 to 1511); <br>
        0x0798 (1607); <br>
        0x07A0 (1703); <br>
        0x07A8 (1709 to 1803); <br>
        0x07A0 (1809); <br>
        0x07B0 (1903); <br>
        0x05E8 </td>
        <td>
        <pre class="source">ULONG UserFsBase;</pre>
        </td>
        <td>10.0 to 1511 </td>
        <td>previously x64-only at 0x0760 </td>
      </tr>
      <tr>
        <td>
        <pre class="source">ULONG_PTR UserFsBase;</pre>
        </td>
        <td>1607 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0440 (10.0 to 1511); <br>
        0x0444 (1607); <br>
        0x044C (1703 to 1809); <br>
        0x0454 (1903); <br>
        0x0384 </td>
        <td>0x0798 (10.0 to 1511); <br>
        0x07A0 (1607); <br>
        0x07A8 (1703); <br>
        0x07B0 (1709 to 1803); <br>
        0x07A8 (1809); <br>
        0x07B8 (1903); <br>
        0x05F0 </td>
        <td>
        <pre class="source">ULONG_PTR UserGsBase;</pre>
        </td>
        <td>10.0 and higher </td>
        <td>previously x64-only at 0x0768 </td>
      </tr>
      <tr>
        <td>0x0444 (10.0 to 1511); <br>
        0x0448 (1607); <br>
        0x0450 (1703 to 1809); <br>
        0x0458 (1903); <br>
        0x0388 </td>
        <td>0x07A0 (10.0 to 1511); <br>
        0x07A8 (1607); <br>
        0x07B0 (1703); <br>
        0x07B8 (1709 to 1803); <br>
        0x07B0 (1809); <br>
        0x07C0 (1903); <br>
        0x05F8 </td>
        <td>
        <pre class="source">THREAD_ENERGY_VALUES *EnergyValues;</pre>
        </td>
        <td>10.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td rowspan="2">0x0448 (10.0 to 1511); <br>
        0x044C (1607); <br>
        0x0454 (1703 to 1809); <br>
        0x045C (1903) </td>
        <td rowspan="2">0x07A8 (10.0 to 1511); <br>
        0x07B0 (1607); <br>
        0x07B8 (1703); <br>
        0x07C0 (1709 to 1803); <br>
        0x07B8 (1809); <br>
        0x07C8 (1903) </td>
        <td>
        <pre class="source">ULONG volatile CmCellReferences;</pre>
        </td>
        <td>10.0 to 1511 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>
        <pre class="source">PVOID CmDbgInfo;</pre>
        </td>
        <td>1607 to 1903 </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x044C (10.0 to 1511); <br>
        0x0450 (1607); <br>
        0x0458 (1703 to 1809); <br>
        0x0460 (1903); <br>
        0x038C </td>
        <td>0x07B0 (10.0 to 1511); <br>
        0x07B8 (1607); <br>
        0x07C0 (1703); <br>
        0x07C8 (1709 to 1803); <br>
        0x07C0 (1809); <br>
        0x07D0 (1903); <br>
        0x0600 </td>
        <td>
        <pre class="source">union {
    ULONG_PTR SelectedCpuSets;
    ULONG_PTR *SelectedCpuSetsIndirect;
};</pre>
        </td>
        <td>10.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td rowspan="2">0x0450 (10.0 to 1511); <br>
        0x0454 (1607); <br>
        0x045C (1703 to 1809); <br>
        0x0464 (1903); <br>
        0x0390 </td>
        <td rowspan="2">0x07B8 (10.0 to 1511); <br>
        0x07C0 (1607); <br>
        0x07C8 (1703); <br>
        0x07D0 (1709 to 1803); <br>
        0x07C8 (1809); <br>
        0x07D8 (1903); <br>
        0x0608 </td>
        <td>
        <pre class="source"><a href="../esilo.htm">ESILO</a> *Silo;</pre>
        </td>
        <td>10.0 only </td>
        <td>last member in 10.0 </td>
      </tr>
      <tr>
        <td>
        <pre class="source"><a href="../ejob/index.htm">EJOB</a> *Silo;</pre>
        </td>
        <td>1511 and higher </td>
        <td>last member in 1511 </td>
      </tr>
    </tbody>
  </table>
  <p>Whether silos are their own type of object, as in the original Windows 10, 
  or are special types of job object, the <span class="member">Silo</span> member 
  can have the special value -3 to mean that the thread is not itself attached to 
  a silo but the thread’s process may be. </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions"><col class="Remarks">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
        <th>Remarks </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x0458 (1607); <br>
        0x0460 (1703 to 1809); <br>
        0x0468 (1903); <br>
        0x0394 </td>
        <td>0x07C8 (1607); <br>
        0x07D0 (1703); <br>
        0x07D8 (1709 to 1803); <br>
        0x07D0 (1809); <br>
        0x07E0 (1903); <br>
        0x0610 </td>
        <td>
        <pre class="source">UNICODE_STRING *ThreadName;</pre>
        </td>
        <td>1607 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>0x07D0 (1607); <br>
        0x07D8 (1703); <br>
        0x07E0 (1709 to 1803); <br>
        0x07D8 (1809); <br>
        0x07E8 (1903); <br>
        0x0618 </td>
        <td>
        <pre class="source">CONTEXT *SetContextState;</pre>
        </td>
        <td>1607 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x045C (1607) </td>
        <td>0x07D8 (1607) </td>
        <td>
        <pre class="source">ULONG ReadyTime;</pre>
        </td>
        <td>1607 only </td>
        <td>last member in 1607 </td>
      </tr>
      <tr>
        <td>0x0398 </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">PVOID SparePointer;</pre>
        </td>
        <td>2004 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0464 (1703 to 1809); <br>
        0x046C (1903); <br>
        0x039C </td>
        <td>0x07E0 (1703); <br>
        0x07E8 (1709 to 1803); <br>
        0x07E0 (1809); <br>
        0x07F0 (1903); <br>
        0x0620 </td>
        <td>
        <pre class="source">ULONG LastExpectedRunTime;</pre>
        </td>
        <td>1703 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0468 (1809); <br>
        0x0470 (1903); <br>
        0x03A0 </td>
        <td>0x07E4 (1809); <br>
        0x07F4 (1903); <br>
        0x0624 </td>
        <td>
        <pre class="source">ULONG HeapData;</pre>
        </td>
        <td>1809 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0468 (1703 to 1803); <br>
        0x046C (1809); <br>
        0x0474 (1903); <br>
        0x03A4 </td>
        <td>0x07E8 (1703); <br>
        0x07F0 (1709 to 1803); <br>
        0x07E8 (1809); <br>
        0x07F8 (1903); <br>
        0x0628 </td>
        <td>
        <pre class="source">LIST_ENTRY OwnerEntryListHead;</pre>
        </td>
        <td>1703 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0470 (1703 to 1803); <br>
        0x0474 (1809); <br>
        0x047C (1903); <br>
        0x03AC </td>
        <td>0x07F8 (1703); <br>
        0x0800 (1709 to 1803); <br>
        0x07F8 (1809); <br>
        0x0808 (1903); <br>
        0x0638 </td>
        <td>
        <pre class="source">ULONG_PTR DisownedOwnerEntryListLock;</pre>
        </td>
        <td>1703 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0474 (1703 to 1803); <br>
        0x0478 (1809); <br>
        0x0480 (1903); <br>
        0x03B0 </td>
        <td>0x0800 (1703); <br>
        0x0808 (1709 to 1803); <br>
        0x0800 (1809); <br>
        0x0818 (1903); <br>
        0x0640 </td>
        <td>
        <pre class="source">LIST_ENTRY DisownedOwnerEntryListHead;</pre>
        </td>
        <td>1703 and higher </td>
        <td>last member in 1703 to 1903 </td>
      </tr>
      <tr>
        <td>0x03B8 </td>
        <td>0x0650 </td>
        <td>
        <pre class="source">KLOCK_ENTRY *LockEntries [0x48];</pre>
        </td>
        <td>2004 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x04D8 </td>
        <td>0x0890 </td>
        <td>
        <pre class="source">PVOID CmDbgInfo;</pre>
        </td>
        <td>2004 and higher </td>
        <td>&nbsp;</td>
      </tr>
    </tbody>
  </table>
  <div class="Footer">
    <p class="Dates">This page was created on 15th June 2016 and was last modified 
    on 24th March 2023. </p>
    <!--webbot bot="Include" U-Include="../../../../../_include/c1623.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2016-2023. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="14266" -->
  </div>
</div>

</body>

</html>
