<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>HAL Exports Added For Version 5.1</title>
<link rel="stylesheet" type="text/css" href="../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../_styles/km.css">
<script type="text/javascript" src="../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../_scripts/km.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="63592" -->
<h1>HAL Exports Added For Version 5.1 </h1>
<p>The table on this page lists the three exports that were added to the Windows 
HAL for version 5.1, i.e., for Windows XP. </p>
<!--webbot bot="Include" U-Include="../../_include/colours-undoc.htm" TAG="BODY" startspan -->

<p>For the table below, documentation status is summarised by colour coding so that 
more detail can be given as Remarks with less text. (If you read this website with 
scripts enabled, then hovering the mouse over any coloured text will produce a tooltip 
that shows why the text is coloured.) Functions that have their own non-trivial 
documentation are shown with no background colour. Functions that appear to 
be completely undocumented are <span class="undocumented">highlighted yellow</span>. </p>

<!--webbot bot="Include" endspan i-checksum="48657" -->
<table class="Functions">
  <colgroup>
    <col class="Name"><col class="Remarks">
  </colgroup>
  <tr>
    <th>Name </th>
    <th>Export History </th>
  </tr>
  <tr>
    <td><span class="function">KeAcquireInStackQueuedSpinLock</span> </td>
    <td>x86 only; <br>
    since 6.2, forwarded to kernel </td>
  </tr>
  <tr>
    <td><span class="undocumented function">KeAcquireInStackQueuedSpinLockRaiseToSynch</span>
    </td>
    <td>x86 only; <br>
    since 6.2, forwarded to kernel </td>
  </tr>
  <tr>
    <td><span class="function">KeReleaseInStackQueuedSpinLock</span> </td>
    <td>x86 only; <br>
    since 6.2, forwarded to kernel </td>
  </tr>
</table>
<p>Though these new functions are x86-specific exports from the HAL, all have x64 
support as exports from the kernel. </p>
<p>The two that are documented are remarkable in several respects. First, they are 
the first HAL exports for which the contemporaneous documentation states explicitly 
which versions have them. Second, the versions are stated correctly. This ought 
not to be remarkable, and is not remarked on in the table, but when version constraints 
were applied to declarations in the WDK for Windows Vista, these functions became 
the oldest for which such constraints are correct. HAL exports that had been added 
for Windows 2000 got declared as requiring at least Windows XP and older HAL exports 
were declared as requiring at least Windows 2000. </p>
<p>Though version 5.1 added only these three exports, and only then to the x86 HAL, 
their functionality was at the time some sort of new best thing in kernel-mode programming. 
All documentation of functions for plain old spin locks was revised to advise that 
“Drivers for Windows XP and later should use the more efficient and reliable queued 
spin locks”. Microsoft didn’t actually call them new, but plainly saw some interest 
in documenting the newness correctly. For a clue that they were not entirely new, 
wonder why these functions are not named more directly as <span class="function">
KeAcquireQueuedSpinLock</span>, etc., and look back to the <a href="names50.htm">
HAL Exports Added for Version 5.0</a>. </p>
<h2>Discontinued </h2>
<p>Version 5.1 stops exporting a whole set of functions through which the HAL supports 
kernel-mode debugging over a serial port: </p>
<ul>
  <li><span class="undocumented function">KdPortGetByte</span>; </li>
  <li><span class="undocumented function">KdPortInitialize</span>; </li>
  <li><span class="undocumented function">KdPortPollByte</span>; </li>
  <li><span class="undocumented function">KdPortPutByte</span>; </li>
  <li><span class="undocumented function">KdPortRestore</span>; </li>
  <li><span class="undocumented function">KdPortSave</span>. </li>
</ul>
<p>All are first exported in version 3.10. Their only expected caller had been the 
kernel. To broaden the type of debug port, the implementation was moved from the 
HAL to a new module with a new interface. </p>
<div class="Footer">
  <p class="Dates">This page was created on 14th April 2009 and was last modified 
  on 13th October 2020. </p>
  <!--webbot bot="Include" U-Include="../../_include/c0920.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2009-2020. Geoff Chappell. All rights reserved. 
<a href="../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="5603" -->
</div>

</body>

</html>
