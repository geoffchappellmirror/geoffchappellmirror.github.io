<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>New and Updated in June 2020</title>
<link rel="stylesheet" type="text/css" href="../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../_styles/tree.css">
<script type="text/javascript" src="../../_scripts/master.js"></script>
<script type="text/javascript" src="../../_scripts/document.js"></script>
<script type="text/javascript" src="../../_scripts/tree.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript Header" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="14880" -->
<div class="Main">
  <h1>New and Updated in June 2020 </h1>
  <p>If only to start with, June is about picking up some loose ends from
  <a href="05.htm">May</a>’s work with Event Tracing for Windows (ETW). </p>
  <p>One point to the term “loose end” is that what’s talked of is some small or 
  slight thing among the bits and pieces at the end of this, that or the other. 
  If there is any one kernel-mode API to dismiss as a loose end without its being 
  small or slight, it is the ancient <span class="function">RtlQueryRegistryValues</span> 
  function. It was clearly intended as a convenience for low-level programmers to 
  load all the configurable settings for their driver or service in one go from 
  definitions in tables. But anyone’s thought that this was standardised handling 
  that would be more robust for being written by the system’s manufacturer is long, 
  long gone. It seems fair, if not generous, to say the <span class="function">RtlQueryRegistryValues</span> 
  function has for decades been regarded by its intended users as much too fickle 
  to count as any sort of convenience. It can have surprised nobody when Microsoft’s 
  documentation started warning (in 2010 to 2012) that one flag was unsafe and that 
  with another “an untrusted user-mode application may be able to cause a buffer 
  overflow.” Alarmingly, these problems were deemed so serious that not only was 
  a new flag introduced for mitigation but its omission “by a call from kernel-mode 
  causes a 0x139 bug check (KERNEL_SECURITY_CHECK_FAILURE)” in some circumstances.
  </p>
  <p>Given such history, it is well past time that <span class="function">RtlQueryRegistryValues</span> 
  is documented here—and it will be, but not in what remains of June. One thing 
  leads to another, which leads to another, and so on, especially when the first 
  thing is such a mess. Somehow, the sequence led me to the Object Manager, whose 
  structures and functions and bug checks have, like ETW, been on my to-do list 
  for decades, but unlike ETW, not before produced even one page I’ve felt was good 
  enough to publish. What I offer now, today at the end of the month, wouldn’t have 
  passed muster years ago. My standards may be slipping. But at long last I have 
  at least broken the ground. There will be more. </p>
  <h2>Kernel Mode </h2>
  <div class="Tree">
    <ul>
      <li class="Expanded Branch">Kernel
      <ul>
        <li class="Expanded Branch">API
        <ul>
          <li class="Expanded Branch">Executive
          <ul>
            <li class="Expanded Branch"><a href="../../studies/windows/km/ntoskrnl/api/ex/resource/index.htm">Resources</a> (new)
            <ul>
              <li class="Expanded Branch">Functions
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/resource/isacquiredshared.htm">ExIsResourceAcquiredShared</a> (new) </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/resource/isacquiredsharedlite.htm">ExIsResourceAcquiredSharedLite</a> (new) </li>
              </ul>
              </li>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/resource/eresource.htm">ERESOURCE</a> (new) </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/resource/process_lock_information.htm">RTL_PROCESS_LOCK_INFORMATION</a> </li>
              </ul>
              </li>
            </ul>
            </li>
            <li class="Expanded Branch">System Information
            <ul>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/ex/sysinfo/handle_table_entry.htm">SYSTEM_HANDLE_TABLE_ENTRY_INFO</a> </li>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/api/ntexapi/system_objecttype_information.htm">SYSTEM_OBJECTTYPE_INFORMATION</a> </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li class="Expanded Branch">Object Manager
          <ul>
            <li class="Expanded Branch">Query
            <ul>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/api/ntobapi/object_basic_information.htm">OBJECT_BASIC_INFORMATION</a> (new) </li>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/api/ntobapi/object_handle_flag_information.htm">OBJECT_HANDLE_FLAG_INFORMATION</a> (new) </li>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/api/ntobapi/object_type_information.htm">OBJECT_TYPE_INFORMATION</a> (new) </li>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/api/ntobapi/object_types_information.htm">OBJECT_TYPES_INFORMATION</a> (new) </li>
              </ul>
              </li>
              <li class="Expanded Branch">Enumerations
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/api/ntobapi_x/object_information_class.htm">OBJECT_INFORMATION_CLASS</a> (new) </li>
              </ul>
              </li>
            </ul>
            </li>
            <li class="Expanded Branch">Structures
            <ul>
              <li class="Expanded Branch"><a href="../../studies/windows/km/ntoskrnl/inc/ntos/ob/object_header/index.htm">OBJECT_HEADER</a> (new)
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/ntos/ob/object_header/flags.htm">Flags</a> (new) </li>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/ntos/ob/object_header/infomask.htm">InfoMask</a> (new) </li>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/ntos/ob/object_header/traceflags.htm">TraceFlags</a> (new) </li>
              </ul>
              </li>
              <li><a href="../../studies/windows/km/ntoskrnl/inc/ntos/ob/object_header_audit_info.htm">OBJECT_HEADER_AUDIT_INFO</a> (new) </li>
              <li><a href="../../studies/windows/km/ntoskrnl/inc/ntos/ob/object_header_creator_info.htm">OBJECT_HEADER_CREATOR_INFO</a> (new) </li>
              <li><a href="../../studies/windows/km/ntoskrnl/inc/ntos/ob/object_header_handle_info.htm">OBJECT_HEADER_HANDLE_INFO</a> (new) </li>
              <li><a href="../../studies/windows/km/ntoskrnl/inc/ntos/ob/object_header_handle_revocation_info.htm">OBJECT_HEADER_HANDLE_REVOCATION_INFO</a> (new) </li>
              <li><a href="../../studies/windows/km/ntoskrnl/inc/ntos/ob/object_header_name_info.htm">OBJECT_HEADER_NAME_INFO</a> (new) </li>
              <li><a href="../../studies/windows/km/ntoskrnl/inc/ntos/ob/object_header_process_info.htm">OBJECT_HEADER_PROCESS_INFO</a> (new) </li>
              <li><a href="../../studies/windows/km/ntoskrnl/inc/ntos/ob/object_header_quota_info.htm">OBJECT_HEADER_QUOTA_INFO</a> (new) </li>
            </ul>
            </li>
          </ul>
          </li>
          <li class="Expanded Branch">Run Time Library
          <ul>
            <li class="Expanded Branch">NLS
            <ul>
              <li class="Expanded Branch">Functions
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/rtl/nls/appendunicodetostring.htm">RtlAppendUnicodeToString</a> (new) </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/rtl/nls/createunicodestring.htm">RtlCreateUnicodeString</a> (new) </li>
              </ul>
              </li>
            </ul>
            </li>
            <!-- li class="Folder">Registry Utilities 
            <ul>
              <li class="Folder">Functions 
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/rtl/regutil/checkregistrykey.htm">RtlCheckRegistryKey</a> (new) </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/rtl/regutil/queryregistryvalues.htm">RtlQueryRegistryValues</a> (new) </li>
                <li><a href="../../studies/windows/km/ntoskrnl/api/rtl/regutil/queryregistryvaluesex.htm">RtlQueryRegistryValuesEx</a> (new) </li>
              </ul>
              </li>
              <li class="Folder">Structures 
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/rtl/regutil/query_registry_table.htm">RTL_QUERY_REGISTRY_TABLE</a> (new) </li>
              </ul>
              </li>
            </ul>
            </li -->
            <li class="Expanded Branch"><!-- a href="../../studies/windows/km/ntoskrnl/api/rtl/stktrace/index.htm" -->Stack Trace Database<!-- /a> (new) -->
            <ul>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/api/rtl/stktrace/process_backtraces.htm">RTL_PROCESS_BACKTRACES</a> </li>
              </ul>
              </li>
            </ul>
            </li>
            <li class="Expanded Branch">Strings
            <ul>
              <li class="Expanded Branch">Structures
              <ul>
                <li><a href="../../studies/windows/km/ntoskrnl/inc/shared/ntdef/unicode_string.htm">UNICODE_STRING</a> (new) </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
    </ul>
  </div>
  <div class="Footer">
    <!--webbot bot="Include" U-Include="../../_include/c20.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2020. Geoff Chappell. All rights reserved.  
<a href="../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="39716" -->
  </div>
</div>

</body>

</html>
