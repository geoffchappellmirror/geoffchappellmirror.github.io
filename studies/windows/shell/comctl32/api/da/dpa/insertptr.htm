<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>DPA_InsertPtr</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="14798" endspan -->
<h1>DPA_InsertPtr </h1>
<p>This function inserts an item into a DPA at a given position. </p>
<h2>Declaration </h2>
<pre class="source">int
DPA_InsertPtr (
    HDPA pdpa,
    int index,
    PVOID p);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">pdpa</span> argument provides a handle to the DPA.
</p>
<p>The <span class="argument">index</span> argument provides the 0-based index at 
which to insert the item, or is <span class="constant">DPA_APPEND</span> (0x7FFFFFFF) 
to add the item to the end of the list. </p>
<p>The <span class="argument">p</span> argument provides a pointer to the item, 
or is NULL to insert an empty item. </p>
<h3>Return Value </h3>
<p>The function returns the 0-based index at which the item was added to the list, 
else <span class="constant">DPA_ERR</span> (-1) for failure. </p>
<h2>Behaviour </h2>
<p>The function fails if the DPA handle is NULL or if the 0-based index is negative. 
If the index is greater than the number of pointers currently in the array, then 
the function inserts at the end of the array. This case may be arranged most conveniently 
by giving <span class="constant">DPA_APPEND</span> as the index. </p>
<p>The function inserts the given item into the given DPA at the position described 
by the given index (subject to one exceptional case noted below). All pointers at 
or above the insertion point are moved one position further along the array to make 
room for the new pointer. </p>
<p>If memory for the array is not large enough for one more pointer, the function 
fails unless it can get a reallocation. The new capacity, measured in pointers, 
is the current number of pointers in the array, plus one, rounded up to the next 
multiple of the allocation unit (which may increase as a side-effect). </p>
<h3>Variations </h3>
<!--webbot bot="Include" U-Include="_include/null40.htm" TAG="BODY" startspan -->

<p>Defence against a NULL <span class="argument">pdpa</span> argument begins in 
a build of version 4.0. Specifically, there is no defence in the version 4.0 from 
Windows 95, or in any earlier version, but there is in the version 4.0 for Internet 
Explorer 3.00 for Windows NT. (I have no copy of an Internet Explorer 3.00 for Windows 
95. See the list of <a href="../../../history/index.htm">COMCTL32 versions</a> 
found for this survey.) </p>

<!--webbot bot="Include" i-checksum="61182" endspan -->
<p>That said, the defence is defective in versions earlier than 4.71: the function 
does not fail, but instead returns zero. </p>
<p>In version 6.10, the function checks explicitly that adding 1 to the current 
capacity does not take the capacity beyond 0x7FFFFFFF. </p>
<h2>Availability </h2>
<p>The <span class="function">DPA_InsertPtr </span>function is exported from COMCTL32.DLL 
as ordinal 334 in version 3.50 and higher. The implementation for version 6.10 
and higher is built into a statically linked library and thence is also exported 
from the Internet Explorer module IERTUTIL.DLL as ordinal 85 in version 7.0 and 
higher. </p>
<!--webbot bot="Include" U-Include="../../_include/settlement.htm" TAG="BODY" startspan -->

<p>This function was documented among the
<a target="_top" href="http://msdn.microsoft.com/library/ms807073.aspx">
Settlement Program Interfaces</a> in December 2002, but with Windows 2000 cited 
as the minimum operating system, despite many years of earlier availability. </p>

<!--webbot bot="Include" i-checksum="21400" endspan -->
<div class="Footer">
  <p class="Dates">This page was created on 9th April 2005 (from material first 
  published in 1997) and was last modified 
  on 15th March 2010. </p>
  <!--webbot bot="Include" U-Include="../../../../_include/c9710.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 1997-2010. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="5797" endspan -->
</div>

</body>

</html>