<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>ADVAPI32 </title>
<link rel="stylesheet" type="text/css" href="../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../_styles/win32.css">
<script type="text/javascript" src="../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../_scripts/win32.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell, Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="6863" -->
<!--webbot bot="Include" U-Include="../_include/sketch.htm" TAG="BODY" startspan -->

<div class="Header">
  <p class="alert">SKETCH OF HOW RESEARCH MIGHT CONTINUE AND RESULTS BE PRESENTED
  </p>
</div>

<!--webbot bot="Include" endspan i-checksum="5204" -->
<h1>ADVAPI32 </h1>
<p>From the very beginning of 32-bit Windows, many Windows API functions that programmers 
regard as basic, if not actually central, to user-mode Windows programming are implemented 
not in the user-mode kernel (KERNEL32.DLL) but in a separate ADVAPI32.DLL. </p>
<p>That ADVAPI32 is basic to Windows programming is plain from Microsoft’s descriptions 
in the file’s version resources: </p>
<ul>
  <li>“Win32 ADVAPI32 core component” for the old Windows that runs on DOS; </li>
  <li>“Advanced Windows 32 Base API” for the modern Windows based on Windows NT. </li>
</ul>
<p>This separation of base functionality has its merits, but it springs a well-known 
trap for writers of DLLs, who even now are surprised to find that functions for 
such seemingly basic work as querying a registry value are off-limits during their 
DLL’s initialisation. The reason is that the work in question depends not just on 
NTDLL and KERNEL32 but on ADVAPI32. The latter will have been loaded but may not 
yet have been called for its initialisation. Functions that are imported from ADVAPI32 
may misbehave. Of course, if your perspective comes from debugging the consequences, 
then you’ll likely think this trap is not known nearly well enough! </p>
<div class="Footer">
  <!--webbot bot="Include" U-Include="../_include/c16.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2016. Geoff Chappell. All rights reserved. 
<a href="../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="62939" -->
</div>

</body>

</html>
