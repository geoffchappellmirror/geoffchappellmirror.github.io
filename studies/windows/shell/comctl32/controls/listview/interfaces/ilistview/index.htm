<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>IListView</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="58008" endspan -->
<h1>IListView </h1>
<table>
  <tr>
    <td rowspan="2"><span class="constant">IID_IListView</span> </td>
    <td><span class="iid">{2FFE2979-5928-4386-9CDB-8E1F15B72FB4}</span> </td>
    <td>original </td>
  </tr>
  <tr>
    <td><span class="iid">{E5B16AF2-3990-4681-A609-1F060CD14269}</span> </td>
    <td>version 6.10 from Windows 7 </td>
  </tr>
</table>
<p>The original <span class="interface">IListView</span> methods are (as ordered 
in the virtual function table after the <span class="interface">IOleWindow</span> 
methods): </p>
<table class="Struct">
  <colgroup>
    <col class="Offset"><col class="Name">
  </colgroup>
  <tr>
    <th>Offset </th>
    <th>Method </th>
  </tr>
  <tr>
    <td>0x14 </td>
    <td><span class="method">GetImageList</span> </td>
  </tr>
  <tr>
    <td>0x18 </td>
    <td><span class="method">SetImageList</span> </td>
  </tr>
  <tr>
    <td>0x1C </td>
    <td><span class="method"><a href="getbackgroundcolor.htm">GetBackgroundColor</a></span>
    </td>
  </tr>
  <tr>
    <td>0x20 </td>
    <td><span class="method"><a href="setbackgroundcolor.htm">SetBackgroundColor</a></span>
    </td>
  </tr>
  <tr>
    <td>0x24 </td>
    <td><span class="method">GetTextColor</span> </td>
  </tr>
  <tr>
    <td>0x28 </td>
    <td><span class="method">SetTextColor</span> </td>
  </tr>
  <tr>
    <td>0x2C </td>
    <td><span class="method">GetTextBackgroundColor</span> </td>
  </tr>
  <tr>
    <td>0x30 </td>
    <td><span class="method">SetTextBackgroundColor</span> </td>
  </tr>
  <tr>
    <td>0x34 </td>
    <td><span class="method">GetHotLightColor</span> </td>
  </tr>
  <tr>
    <td>0x38 </td>
    <td><span class="method">SetHotLightColor</span> </td>
  </tr>
  <tr>
    <td>0x3C </td>
    <td><span class="method">GetItemCount</span> </td>
  </tr>
  <tr>
    <td>0x40 </td>
    <td><span class="method">SetItemCount</span> </td>
  </tr>
  <tr>
    <td>0x44 </td>
    <td><span class="method">GetItem</span> </td>
  </tr>
  <tr>
    <td>0x48 </td>
    <td><span class="method">SetItem</span> </td>
  </tr>
  <tr>
    <td>0x4C </td>
    <td><span class="method">GetItemState</span> </td>
  </tr>
  <tr>
    <td>0x50 </td>
    <td><span class="method">SetItemState</span> </td>
  </tr>
  <tr>
    <td>0x54 </td>
    <td><span class="method">GetItemText</span> </td>
  </tr>
  <tr>
    <td>0x58 </td>
    <td><span class="method">SetItemText</span> </td>
  </tr>
  <tr>
    <td>0x5C </td>
    <td><span class="method"><a href="getbackgroundimage.htm">GetBackgroundImage</a></span>
    </td>
  </tr>
  <tr>
    <td>0x60 </td>
    <td><span class="method"><a href="setbackgroundimage.htm">SetBackgroundImage</a></span>
    </td>
  </tr>
  <tr>
    <td>0x64 </td>
    <td><span class="method">GetFocusedColumn</span> </td>
  </tr>
  <tr>
    <td>0x68 </td>
    <td><span class="method">SetSelectionFlags</span> </td>
  </tr>
  <tr>
    <td>0x6C </td>
    <td><span class="method">GetSelectedColumn</span> </td>
  </tr>
  <tr>
    <td>0x70 </td>
    <td><span class="method">SetSelectedColumn</span> </td>
  </tr>
  <tr>
    <td>0x74 </td>
    <td><span class="method">GetView</span> </td>
  </tr>
  <tr>
    <td>0x78 </td>
    <td><span class="method">SetView</span> </td>
  </tr>
  <tr>
    <td>0x7C </td>
    <td><span class="method">InsertItem</span> </td>
  </tr>
  <tr>
    <td>0x80 </td>
    <td><span class="method">DeleteItem</span> </td>
  </tr>
  <tr>
    <td>0x84 </td>
    <td><span class="method">DeleteAllItems</span> </td>
  </tr>
  <tr>
    <td>0x88 </td>
    <td><span class="method">UpdateItem</span> </td>
  </tr>
  <tr>
    <td>0x8C </td>
    <td><span class="method">GetItemRect</span> </td>
  </tr>
  <tr>
    <td>0x90 </td>
    <td><span class="method">GetSubItemRect</span> </td>
  </tr>
  <tr>
    <td>0x94 </td>
    <td><span class="method">HitTestSubItem</span> </td>
  </tr>
  <tr>
    <td>0x98 </td>
    <td><span class="method">GetIncrSearchString</span> </td>
  </tr>
  <tr>
    <td>0x9C </td>
    <td><span class="method">GetItemSpacing</span> </td>
  </tr>
  <tr>
    <td>0xA0 </td>
    <td><span class="method">SetIconSpacing</span> </td>
  </tr>
  <tr>
    <td>0xA4 </td>
    <td><span class="method">GetNextItem</span> </td>
  </tr>
  <tr>
    <td>0xA8 </td>
    <td><span class="method">FindItem</span> </td>
  </tr>
  <tr>
    <td>0xAC </td>
    <td><span class="method">GetSelectionMark</span> </td>
  </tr>
  <tr>
    <td>0xB0 </td>
    <td><span class="method">SetSelectionMark</span> </td>
  </tr>
  <tr>
    <td>0xB4 </td>
    <td><span class="method">GetItemPosition</span> </td>
  </tr>
  <tr>
    <td>0xB8 </td>
    <td><span class="method">SetItemPosition</span> </td>
  </tr>
  <tr>
    <td>0xBC </td>
    <td><span class="method">ScrollView</span> </td>
  </tr>
  <tr>
    <td>0xC0 </td>
    <td><span class="method">EnsureItemVisible</span> </td>
  </tr>
  <tr>
    <td>0xC4 </td>
    <td><span class="method">EnsureSubItemVisible</span> </td>
  </tr>
  <tr>
    <td>0xC8 </td>
    <td><span class="method">EditSubItem</span> </td>
  </tr>
  <tr>
    <td>0xCC </td>
    <td><span class="method">RedrawItems</span> </td>
  </tr>
  <tr>
    <td>0xD0 </td>
    <td><span class="method">ArrangeItems</span> </td>
  </tr>
  <tr>
    <td>0xD4 </td>
    <td><span class="method">RecomputeItems</span> </td>
  </tr>
  <tr>
    <td>0xD8 </td>
    <td><span class="method">GetEditControl</span> </td>
  </tr>
  <tr>
    <td>0xDC </td>
    <td><span class="method">EditLabel</span> </td>
  </tr>
  <tr>
    <td>0xE0 </td>
    <td><span class="method">EditGroupLabel</span> </td>
  </tr>
  <tr>
    <td>0xE4 </td>
    <td><span class="method">CancelEditLabel</span> </td>
  </tr>
  <tr>
    <td>0xE8 </td>
    <td><span class="method">GetEditItem</span> </td>
  </tr>
  <tr>
    <td>0xEC </td>
    <td><span class="method">HitTest</span> </td>
  </tr>
  <tr>
    <td>0xF0 </td>
    <td><span class="method">GetStringWidth</span> </td>
  </tr>
  <tr>
    <td>0xF4 </td>
    <td><span class="method">GetColumn</span> </td>
  </tr>
  <tr>
    <td>0xF8 </td>
    <td><span class="method">SetColumn</span> </td>
  </tr>
  <tr>
    <td>0xFC </td>
    <td><span class="method">GetColumnOrderArray</span> </td>
  </tr>
  <tr>
    <td>0x0100 </td>
    <td><span class="method">SetColumnOrderArray</span> </td>
  </tr>
  <tr>
    <td>0x0104 </td>
    <td><span class="method">GetHeaderControl</span> </td>
  </tr>
  <tr>
    <td>0x0108 </td>
    <td><span class="method">InsertColumn</span> </td>
  </tr>
  <tr>
    <td>0x010C </td>
    <td><span class="method">DeleteColumn</span> </td>
  </tr>
  <tr>
    <td>0x0110 </td>
    <td><span class="method">CreateDragImage</span> </td>
  </tr>
  <tr>
    <td>0x0114 </td>
    <td><span class="method">GetViewRect</span> </td>
  </tr>
  <tr>
    <td>0x0118 </td>
    <td><span class="method">GetClientRect</span> </td>
  </tr>
  <tr>
    <td>0x011C </td>
    <td><span class="method">GetColumnWidth</span> </td>
  </tr>
  <tr>
    <td>0x0120 </td>
    <td><span class="method">SetColumnWidth</span> </td>
  </tr>
  <tr>
    <td>0x0124 </td>
    <td><span class="method">GetCallbackMask</span> </td>
  </tr>
  <tr>
    <td>0x0128 </td>
    <td><span class="method">SetCallbackMask</span> </td>
  </tr>
  <tr>
    <td>0x012C </td>
    <td><span class="method">GetTopIndex</span> </td>
  </tr>
  <tr>
    <td>0x0130 </td>
    <td><span class="method">GetCountPerPage</span> </td>
  </tr>
  <tr>
    <td>0x0134 </td>
    <td><span class="method">GetOrigin</span> </td>
  </tr>
  <tr>
    <td>0x0138 </td>
    <td><span class="method">GetSelectedCount</span> </td>
  </tr>
  <tr>
    <td>0x013C </td>
    <td><span class="method">SortItems</span> </td>
  </tr>
  <tr>
    <td>0x0140 </td>
    <td><span class="method">GetExtendedStyle</span> </td>
  </tr>
  <tr>
    <td>0x0144 </td>
    <td><span class="method">SetExtendedStyle</span> </td>
  </tr>
  <tr>
    <td>0x0148 </td>
    <td><span class="method">GetHoverTime</span> </td>
  </tr>
  <tr>
    <td>0x014C </td>
    <td><span class="method">SetHoverTime</span> </td>
  </tr>
  <tr>
    <td>0x0150 </td>
    <td><span class="method">GetToolTip</span> </td>
  </tr>
  <tr>
    <td>0x0154 </td>
    <td><span class="method">SetToolTip</span> </td>
  </tr>
  <tr>
    <td>0x0158 </td>
    <td><span class="method">GetHotItem</span> </td>
  </tr>
  <tr>
    <td>0x015C </td>
    <td><span class="method">SetHotItem</span> </td>
  </tr>
  <tr>
    <td>0x0160 </td>
    <td><span class="method">GetHotCursor</span> </td>
  </tr>
  <tr>
    <td>0x0164 </td>
    <td><span class="method">SetHotCursor</span> </td>
  </tr>
  <tr>
    <td>0x0168 </td>
    <td><span class="method">ApproximateViewRect</span> </td>
  </tr>
  <tr>
    <td>0x016C </td>
    <td><span class="method">SetRangeObject</span> </td>
  </tr>
  <tr>
    <td>0x0170 </td>
    <td><span class="method">GetWorkAreas</span> </td>
  </tr>
  <tr>
    <td>0x0174 </td>
    <td><span class="method">SetWorkAreas</span> </td>
  </tr>
  <tr>
    <td>0x0178 </td>
    <td><span class="method">GetWorkAreaCount</span> </td>
  </tr>
  <tr>
    <td>0x017C </td>
    <td><span class="method">ResetEmptyText</span> </td>
  </tr>
  <tr>
    <td>0x0180 </td>
    <td><span class="method">EnableGroupView</span> </td>
  </tr>
  <tr>
    <td>0x0184 </td>
    <td><span class="method">IsGroupViewEnabled</span> </td>
  </tr>
  <tr>
    <td>0x0188 </td>
    <td><span class="method">SortGroups</span> </td>
  </tr>
  <tr>
    <td>0x018C </td>
    <td><span class="method">GetGroupInfo</span> </td>
  </tr>
  <tr>
    <td>0x0190 </td>
    <td><span class="method">SetGroupInfo</span> </td>
  </tr>
  <tr>
    <td>0x0194 </td>
    <td><span class="method">GetGroupRect</span> </td>
  </tr>
  <tr>
    <td>0x0198 </td>
    <td><span class="method">GetGroupState</span> </td>
  </tr>
  <tr>
    <td>0x019C </td>
    <td><span class="method">HasGroup</span> </td>
  </tr>
  <tr>
    <td>0x01A0 </td>
    <td><span class="method">InsertGroup</span> </td>
  </tr>
  <tr>
    <td>0x01A4 </td>
    <td><span class="method">RemoveGroup</span> </td>
  </tr>
  <tr>
    <td>0x01A8 </td>
    <td><span class="method">InsertGroupSorted</span> </td>
  </tr>
  <tr>
    <td>0x01AC </td>
    <td><span class="method">GetGroupMetrics</span> </td>
  </tr>
  <tr>
    <td>0x01B0 </td>
    <td><span class="method">SetGroupMetrics</span> </td>
  </tr>
  <tr>
    <td>0x01B4 </td>
    <td><span class="method">RemoveAllGroups</span> </td>
  </tr>
  <tr>
    <td>0x01B8 </td>
    <td><span class="method">GetFocusedGroup</span> </td>
  </tr>
  <tr>
    <td>0x01BC </td>
    <td><span class="method">GetGroupCount</span> </td>
  </tr>
  <tr>
    <td>0x01C0 </td>
    <td><span class="method">SetOwnerDataCallback</span> </td>
  </tr>
  <tr>
    <td>0x01C4 </td>
    <td><span class="method">GetTileViewInfo</span> </td>
  </tr>
  <tr>
    <td>0x01C8 </td>
    <td><span class="method">SetTileViewInfo</span> </td>
  </tr>
  <tr>
    <td>0x01CC </td>
    <td><span class="method">GetTileInfo</span> </td>
  </tr>
  <tr>
    <td>0x01D0 </td>
    <td><span class="method">SetTileInfo</span> </td>
  </tr>
  <tr>
    <td>0x01D4 </td>
    <td><span class="method">GetInsertMark</span> </td>
  </tr>
  <tr>
    <td>0x01D8 </td>
    <td><span class="method">SetInsertMark</span> </td>
  </tr>
  <tr>
    <td>0x01DC </td>
    <td><span class="method">GetInsertMarkRect</span> </td>
  </tr>
  <tr>
    <td>0x01E0 </td>
    <td><span class="method">GetInsertMarkColor</span> </td>
  </tr>
  <tr>
    <td>0x01E4 </td>
    <td><span class="method">SetInsertMarkColor</span> </td>
  </tr>
  <tr>
    <td>0x01E8 </td>
    <td><span class="method">HitTestInsertMark</span> </td>
  </tr>
  <tr>
    <td>0x01EC </td>
    <td><span class="method">SetInfoTip</span> </td>
  </tr>
  <tr>
    <td>0x01F0 </td>
    <td><span class="method">GetOutlineColor</span> </td>
  </tr>
  <tr>
    <td>0x01F4 </td>
    <td><span class="method">SetOutlineColor</span> </td>
  </tr>
  <tr>
    <td>0x01F8 </td>
    <td><span class="method">GetFrozenItem</span> </td>
  </tr>
  <tr>
    <td>0x01FC </td>
    <td><span class="method">SetFrozenItem</span> </td>
  </tr>
  <tr>
    <td>0x0200 </td>
    <td><span class="method">GetFrozenSlot</span> </td>
  </tr>
  <tr>
    <td>0x0204 </td>
    <td><span class="method">SetFrozenSlot</span> </td>
  </tr>
  <tr>
    <td>0x0208 </td>
    <td><span class="method">GetViewMargin</span> </td>
  </tr>
  <tr>
    <td>0x020C </td>
    <td><span class="method">SetViewMargin</span> </td>
  </tr>
  <tr>
    <td>0x0210 </td>
    <td><span class="method">SetKeyboardSelected</span> </td>
  </tr>
  <tr>
    <td>0x0214 </td>
    <td><span class="method">MapIndexToId</span> </td>
  </tr>
  <tr>
    <td>0x0218 </td>
    <td><span class="method">MapIdToIndex</span> </td>
  </tr>
  <tr>
    <td>0x021C </td>
    <td><span class="method">IsItemVisible</span> </td>
  </tr>
  <tr>
    <td>0x0220 </td>
    <td><span class="method">GetGroupSubsetCount</span> </td>
  </tr>
  <tr>
    <td>0x0224 </td>
    <td><span class="method">SetGroupSubsetCount</span> </td>
  </tr>
  <tr>
    <td>0x0228 </td>
    <td><span class="method">GetVisibleSlotCount</span> </td>
  </tr>
  <tr>
    <td>0x022C </td>
    <td><span class="method">GetColumnMargin</span> </td>
  </tr>
  <tr>
    <td>0x0230 </td>
    <td><span class="method">SetSubItemCallback</span> </td>
  </tr>
  <tr>
    <td>0x0234 </td>
    <td><span class="method">GetVisibleItemRange</span> </td>
  </tr>
  <tr>
    <td>0x0238 </td>
    <td><span class="method">SetTypeAheadFlags</span> </td>
  </tr>
</table>
<p>with prototypes: </p>
<pre class="source">HRESULT GetImageList (INT, HIMAGELIST *);</pre>
<pre class="source">HRESULT SetImageList (INT, HIMAGELIST, HIMAGELIST *);</pre>
<pre class="source">HRESULT GetBackgroundColor (COLORREF *);</pre>
<pre class="source">HRESULT SetBackgroundColor (COLORREF);</pre>
<pre class="source">HRESULT GetTextColor (COLORREF *);</pre>
<pre class="source">HRESULT SetTextColor (COLORREF);</pre>
<pre class="source">HRESULT GetTextBackgroundColor (COLORREF *);</pre>
<pre class="source">HRESULT SetTextBackgroundColor (COLORREF);</pre>
<pre class="source">HRESULT GetHotLightColor (COLORREF *);</pre>
<pre class="source">HRESULT SetHotLightColor (COLORREF);</pre>
<pre class="source">HRESULT GetItemCount (int *);</pre>
<pre class="source">HRESULT SetItemCount (int, DWORD);</pre>
<pre class="source">HRESULT GetItem (LVITEMW *);</pre>
<pre class="source">HRESULT SetItem (LVITEMW * const);</pre>
<pre class="source">HRESULT GetItemState (int, int, ULONG, ULONG *);</pre>
<pre class="source">HRESULT SetItemState (int, int, ULONG, ULONG);</pre>
<pre class="source">HRESULT GetItemText (INT, INT, PWSTR, INT);</pre>
<pre class="source">HRESULT SetItemText (int, int, PCWSTR);</pre>
<pre class="source">HRESULT GetBackgroundImage (LVBKIMAGEW *);</pre>
<pre class="source">HRESULT SetBackgroundImage (LVBKIMAGEW * const);</pre>
<pre class="source">HRESULT GetFocusedColumn (INT *);</pre>
<pre class="source">HRESULT SetSelectionFlags (ULONG, ULONG);</pre>
<pre class="source">HRESULT GetSelectedColumn (INT *);</pre>
<pre class="source">HRESULT SetSelectedColumn (int);</pre>
<pre class="source">HRESULT GetView (DWORD *);</pre>
<pre class="source">HRESULT SetView (DWORD);</pre>
<pre class="source">HRESULT InsertItem (LVITEMW * const, int *);</pre>
<pre class="source">HRESULT DeleteItem (int);</pre>
<pre class="source">HRESULT DeleteAllItems (VOID);</pre>
<pre class="source">HRESULT UpdateItem (int);</pre>
<pre class="source">HRESULT GetItemRect (LVITEMINDEX, int, RECT *);</pre>
<pre class="source">HRESULT GetSubItemRect (LVITEMINDEX, INT, INT, RECT *);</pre>
<pre class="source">HRESULT HitTestSubItem (LVHITTESTINFO *);</pre>
<pre class="source">HRESULT GetIncrSearchString (PWSTR, INT, INT *);</pre>
<pre class="source">HRESULT GetItemSpacing (BOOL, INT *, INT *);</pre>
<pre class="source">HRESULT SetIconSpacing (INT, INT, INT *, INT *);</pre>
<pre class="source">HRESULT GetNextItem (LVITEMINDEX, ULONG, LVITEMINDEX *);</pre>
<pre class="source">HRESULT FindItem (LVITEMINDEX, LVFINDINFOW const *, LVITEMINDEX *);</pre>
<pre class="source">HRESULT GetSelectionMark (LVITEMINDEX *);</pre>
<pre class="source">HRESULT SetSelectionMark (LVITEMINDEX, LVITEMINDEX *);</pre>
<pre class="source">HRESULT GetItemPosition (LVITEMINDEX, POINT *);</pre>
<pre class="source">HRESULT SetItemPosition (int, POINT const *);</pre>
<pre class="source">HRESULT ScrollView (int, int);</pre>
<pre class="source">HRESULT EnsureItemVisible (LVITEMINDEX, BOOL);</pre>
<pre class="source">HRESULT EnsureSubItemVisible (LVITEMINDEX, INT);</pre>
<pre class="source">HRESULT EditSubItem (LVITEMINDEX, INT);</pre>
<pre class="source">HRESULT RedrawItems (int, int);</pre>
<pre class="source">HRESULT ArrangeItems (int);</pre>
<pre class="source">HRESULT RecomputeItems (INT);</pre>
<pre class="source">HRESULT GetEditControl (HWND *);</pre>
<pre class="source">HRESULT EditLabel (LVITEMINDEX, PCWSTR, HWND *);</pre>
<pre class="source">HRESULT EditGroupLabel (INT);</pre>
<pre class="source">HRESULT CancelEditLabel (VOID);</pre>
<pre class="source">HRESULT GetEditItem (LVITEMINDEX *, INT *);</pre>
<pre class="source">HRESULT HitTest (LVHITTESTINFO *);</pre>
<pre class="source">HRESULT GetStringWidth (PCWSTR, int *);</pre>
<pre class="source">HRESULT GetColumn (int, LVCOLUMNW *);</pre>
<pre class="source">HRESULT SetColumn (int, LVCOLUMNW * const);</pre>
<pre class="source">HRESULT GetColumnOrderArray (int, int *);</pre>
<pre class="source">HRESULT SetColumnOrderArray (int, int const *);</pre>
<pre class="source">HRESULT GetHeaderControl (HWND *);</pre>
<pre class="source">HRESULT InsertColumn (int, LVCOLUMNW * const, int *);</pre>
<pre class="source">HRESULT DeleteColumn (int);</pre>
<pre class="source">HRESULT CreateDragImage (int, POINT const *, HIMAGELIST *);</pre>
<pre class="source">HRESULT GetViewRect (RECT *);</pre>
<pre class="source">HRESULT GetClientRect (BOOL, RECT *);</pre>
<pre class="source">HRESULT GetColumnWidth (INT, INT *);</pre>
<pre class="source">HRESULT SetColumnWidth (int, int);</pre>
<pre class="source">HRESULT GetCallbackMask (ULONG *);</pre>
<pre class="source">HRESULT SetCallbackMask (ULONG);</pre>
<pre class="source">HRESULT GetTopIndex (int *);</pre>
<pre class="source">HRESULT GetCountPerPage (int *);</pre>
<pre class="source">HRESULT GetOrigin (POINT *);</pre>
<pre class="source">HRESULT GetSelectedCount (INT *);</pre>
<pre class="source">HRESULT SortItems (BOOL, LPARAM, PFNLVCOMPARE);</pre>
<pre class="source">HRESULT GetExtendedStyle (DWORD *);</pre>
<pre class="source">HRESULT SetExtendedStyle (DWORD, DWORD, DWORD *);</pre>
<pre class="source">HRESULT GetHoverTime (UINT *);</pre>
<pre class="source">HRESULT SetHoverTime (UINT, UINT *);</pre>
<pre class="source">HRESULT GetToolTip (HWND *);</pre>
<pre class="source">HRESULT SetToolTip (HWND, HWND *);</pre>
<pre class="source">HRESULT GetHotItem (LVITEMINDEX *);</pre>
<pre class="source">HRESULT SetHotItem (LVITEMINDEX, LVITEMINDEX *);</pre>
<pre class="source">HRESULT GetHotCursor (HCURSOR *);</pre>
<pre class="source">HRESULT SetHotCursor (HCURSOR, HCURSOR *);</pre>
<pre class="source">HRESULT ApproximateViewRect (int, INT *, INT *);</pre>
<pre class="source">HRESULT SetRangeObject (INT, ILVRange *);</pre>
<pre class="source">HRESULT GetWorkAreas (int, RECT *);</pre>
<pre class="source">HRESULT SetWorkAreas (int, RECT const *);</pre>
<pre class="source">HRESULT GetWorkAreaCount (INT *);</pre>
<pre class="source">HRESULT ResetEmptyText (VOID);</pre>
<pre class="source">HRESULT EnableGroupView (INT);</pre>
<pre class="source">HRESULT IsGroupViewEnabled (BOOL *);</pre>
<pre class="source">HRESULT SortGroups (PFNLVGROUPCOMPARE, PVOID);</pre>
<pre class="source">HRESULT GetGroupInfo (INT, INT, LVGROUP *);</pre>
<pre class="source">HRESULT SetGroupInfo (INT, INT, LVGROUP * const);</pre>
<pre class="source">HRESULT GetGroupRect (BOOL, int, INT, RECT *);</pre>
<pre class="source">HRESULT GetGroupState (INT, ULONG, ULONG *);</pre>
<pre class="source">HRESULT HasGroup (int, BOOL *);</pre>
<pre class="source">HRESULT InsertGroup (int, LVGROUP * const, int *);</pre>
<pre class="source">HRESULT RemoveGroup (INT);</pre>
<pre class="source">HRESULT InsertGroupSorted (LVINSERTGROUPSORTED const *, int *);</pre>
<pre class="source">HRESULT GetGroupMetrics (LVGROUPMETRICS *);</pre>
<pre class="source">HRESULT SetGroupMetrics (LVGROUPMETRICS * const);</pre>
<pre class="source">HRESULT RemoveAllGroups (VOID);</pre>
<pre class="source">HRESULT GetFocusedGroup (INT *);</pre>
<pre class="source">HRESULT GetGroupCount (INT *);</pre>
<pre class="source">HRESULT SetOwnerDataCallback (IOwnerDataCallback *);</pre>
<pre class="source">HRESULT GetTileViewInfo (LVTILEVIEWINFO *);</pre>
<pre class="source">HRESULT SetTileViewInfo (LVTILEVIEWINFO * const);</pre>
<pre class="source">HRESULT GetTileInfo (LVTILEINFO *);</pre>
<pre class="source">HRESULT SetTileInfo (LVTILEINFO * const);</pre>
<pre class="source">HRESULT GetInsertMark (LVINSERTMARK *);</pre>
<pre class="source">HRESULT SetInsertMark (LVINSERTMARK const *);</pre>
<pre class="source">HRESULT GetInsertMarkRect (RECT *);</pre>
<pre class="source">HRESULT GetInsertMarkColor (COLORREF *);</pre>
<pre class="source">HRESULT SetInsertMarkColor (COLORREF, COLORREF *);</pre>
<pre class="source">HRESULT HitTestInsertMark (POINT const *, LVINSERTMARK *);</pre>
<pre class="source">HRESULT SetInfoTip (LVSETINFOTIP * const);</pre>
<pre class="source">HRESULT GetOutlineColor (COLORREF *);</pre>
<pre class="source">HRESULT SetOutlineColor (COLORREF, COLORREF *);</pre>
<pre class="source">HRESULT GetFrozenItem (INT *);</pre>
<pre class="source">HRESULT SetFrozenItem (INT, INT);</pre>
<pre class="source">HRESULT GetFrozenSlot (RECT *);</pre>
<pre class="source">HRESULT SetFrozenSlot (INT, POINT const *);</pre>
<pre class="source">HRESULT GetViewMargin (RECT *);</pre>
<pre class="source">HRESULT SetViewMargin (RECT const *);</pre>
<pre class="source">HRESULT SetKeyboardSelected (LVITEMINDEX);</pre>
<pre class="source">HRESULT MapIndexToId (INT, INT *);</pre>
<pre class="source">HRESULT MapIdToIndex (INT, INT *);</pre>
<pre class="source">HRESULT IsItemVisible (LVITEMINDEX, BOOL *);</pre>
<pre class="source">HRESULT GetGroupSubsetCount (INT *);</pre>
<pre class="source">HRESULT SetGroupSubsetCount (INT);</pre>
<pre class="source">HRESULT GetVisibleSlotCount (INT *);</pre>
<pre class="source">HRESULT GetColumnMargin (RECT *);</pre>
<pre class="source">HRESULT SetSubItemCallback (ISubItemCallback *);</pre>
<pre class="source">HRESULT GetVisibleItemRange (LVITEMINDEX *, LVITEMINDEX *);</pre>
<pre class="source">HRESULT SetTypeAheadFlags (UINT, UINT);</pre>
<p>in which <span class="interface">ILVRange</span>, <span class="interface">
<a href="../iownerdatacallback.htm">IOwnerDataCallback</a></span> and
<span class="interface"><a href="../isubitemcallback.htm">ISubItemCallback</a></span> 
are apparently undocumented interfaces. </p>
<p>The revision for Windows 7 inserts a method (near to the end of the virtual function 
table): </p>
<table class="Struct">
  <tr>
    <th>Offset </th>
    <th>Method </th>
  </tr>
  <tr>
    <td>0x0220 </td>
    <td><span class="method">EnableAlphaShadow</span> </td>
  </tr>
  <tr>
    <td>0x0224 </td>
    <td><span class="method">GetGroupSubsetCount</span> </td>
  </tr>
  <tr>
    <td>0x0228 </td>
    <td><span class="method">SetGroupSubsetCount</span> </td>
  </tr>
  <tr>
    <td>0x022C </td>
    <td><span class="method">GetVisibleSlotCount</span> </td>
  </tr>
  <tr>
    <td>0x0230 </td>
    <td><span class="method">GetColumnMargin</span> </td>
  </tr>
  <tr>
    <td>0x0234 </td>
    <td><span class="method">SetSubItemCallback</span> </td>
  </tr>
  <tr>
    <td>0x0238 </td>
    <td><span class="method">GetVisibleItemRange</span> </td>
  </tr>
  <tr>
    <td>0x023C </td>
    <td><span class="method">SetTypeAheadFlags</span> </td>
  </tr>
</table>
<p>The new method has the prototype: </p>
<pre class="source">HRESULT EnableAlphaShadow (BOOL);</pre>
<p>Two other methods have slight changes to their prototypes: </p>
<pre class="source">HRESULT SetSelectionFlags (SELECTION_FLAGS, SELECTION_FLAGS);</pre>
<pre class="source">HRESULT SetTypeAheadFlags (TYPEAHEAD_FLAGS, TYPEAHEAD_FLAGS);</pre>
<p>in which <span class="enum">SELECTION_FLAGS</span> and <span class="enum">TYPEAHEAD_FLAGS</span> 
are formal enumerations to replace what had been mere integers. </p>
<h2>Implementation </h2>
<p>The one known implementation of the <span class="interface">IListView</span> 
interface is by COMCTL32 for a class that Microsoft’s symbol files name as
<span class="class">CListView</span>. An instance of this class is created for each 
List-View control. To get a pointer to a List-View control’s
<span class="interface">IListView</span> interface, send message 0x10BD to the control, 
with <span class="argument">wParam</span> addressing <span class="constant">IID_IListView</span> 
and with <span class="argument">lParam</span> addressing a variable that will receive 
the interface pointer. </p>
<h2>Availability </h2>
<p>The <span class="interface">IListView</span> interface is implemented in COMCTL32 
versions 6.10 and higher. </p>
<!--webbot bot="Include" U-Include="../_include/undoc610.htm" TAG="BODY" startspan -->

<p>Though new for Windows Vista, this interface is not documented by Microsoft in 
the January 2007 edition of the Software Development Kit (SDK) for Windows Vista.
</p>

<!--webbot bot="Include" i-checksum="26411" endspan -->
<p>Neither does the SDK document the window message (perhaps named something like
<span class="message"><a href="../../messages/queryinterface.htm">LVM_QUERYINTERFACE</a></span>) 
through which a List-View control exposes its interfaces. This is all rather curious. 
Where the methods correspond closely with the messages, the natural expectation 
is that calling the methods will be vastly more efficient than sending messages. 
Add that some of the methods do things for which there is no corresponding message, 
and that some messages are anyway undocumented, and it is hard to escape the notion 
that Microsoft has given List-View controls some significant new machinery for the 
benefit of some favoured users. Will these games ever stop? </p>
<div class="Footer">
  <p class="Dates">This page was created on 25th April 2008 and was last modified 
  on 22nd December 2009. </p>
  <!--webbot bot="Include" U-Include="../../../../../_include/c0809.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2008-2009. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="14538" endspan -->
</div>

</body>

</html>
