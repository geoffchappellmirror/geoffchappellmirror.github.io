<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>CreateProtectedModeRegistry</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/ie.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/ie.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>CreateProtectedModeRegistry </h1>
<p>Sets low integrity for registry keys needed by Internet Explorer in Protected 
Mode. </p>
<h2>Declaration </h2>
<pre class="source">HRESULT CreateProtectedModeRegistry (VOID);</pre>
<h3>Return Value </h3>
<!--webbot bot="Include" U-Include="../_include/hresult.htm" TAG="BODY" startspan -->

<p>The function returns zero for success, else an error code. </p>

<!--webbot bot="Include" i-checksum="1551" endspan -->
<h2>Behaviour </h2>
<p>If not running on Windows Vista or higher, the function fails (returning
<span class="constant">S_FALSE</span>). Otherwise, the function sets low integrity 
for each of the applicable registry keys (see below). Failure for any one does not 
cause the function to skip any others, but does cause the function to fail (returning
<span class="constant">E_FAIL</span>). The applicable registry keys are: </p>
<ul>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\AppDataLow</span> </li>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\InternetRegistry</span>
  </li>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\LowRegistry</span>
  </li>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\LowRegistry\DontShowMeThisDialogAgain</span>
  </li>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet 
  Settings\5.0\LowCache</span> </li>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\IntelliForms</span>
  </li>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Toolbar</span>
  </li>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\ToolbarWebBrowser</span>
  </li>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder\Favorites</span>
  </li>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\PageSetup</span>
  </li>
  <li><span class="regkey">HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet 
  Settings\Passport\LowDAMap</span> </li>
  <li><span class="regkey">HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet 
  Settings\Wpad</span> (version 8.0 and higher) </li>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\LowRegistry</span>
  </li>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Zoom</span> 
  (version 8.0 and higher) </li>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\BrowserEmulation\LowMic</span> 
  (version 8.0 and higher) </li>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\IETld\LowMic</span> 
  (version 8.0 and higher) </li>
</ul>
<p>To set a low integrity level for a registry key, the function creates the key, 
asking for <span class="constant">KEY_WRITE</span> and <span class="constant">WRITE_OWNER</span> 
access rights, and calls the <span class="function">
<a href="../util/setregistrykeyintegritylevel.htm">SetRegistryKeyIntegrityLevel</a></span> 
function with the particular SID that is represented by LW in the Security Descriptor 
Definition Language. </p>
<h2>Availability </h2>
<p>The <span class="function">CreateProtectedModeRegistry</span> function is exported 
from IERTUTIL as ordinal 33 in version 7.0 and higher. </p>
<div class="Footer">
  <p class="Dates">This page was created on 5th April 2010 and was last modified 
  on 7th April 2010. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c10.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2010. Geoff Chappell. All rights reserved. 
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="61781" endspan -->
</div>

</body>

</html>
