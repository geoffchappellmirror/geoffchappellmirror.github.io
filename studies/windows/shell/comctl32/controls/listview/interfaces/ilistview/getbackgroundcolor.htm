<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>GetBackgroundColor</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../../../_scripts/master.js">
</script>
<script type="text/javascript" src="../../../../../../../../_scripts/document.js">
</script>
<script type="text/javascript" src="../../../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="58008" endspan -->
<h1>GetBackgroundColor </h1>
<p>This method of the <span class="interface"><a href="index.htm">IListView</a></span> 
interface gets the background colour of a List-View control. </p>
<h2>Declaration </h2>
<pre class="source">HRESULT GetBackgroundColor (COLORREF *pclrBk);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">pclrBk</span> argument is the address of a 
variable that is to receive either: the background colour; or the value
<span class="constant">CLR_NONE</span> (0xFFFFFFFF) if there is no background 
colour.
</p>
<h3>Return Value </h3>
<!--webbot bot="Include" U-Include="../_include/hresult.htm" TAG="BODY" startspan -->

<p>The method returns zero for success, else an error code. </p>

<!--webbot bot="Include" i-checksum="37727" endspan -->
<h2>Behaviour </h2>
<!--webbot bot="Include" U-Include="_include/createdestroy.htm" TAG="BODY" startspan -->

<p>The method fails, returning <span class="constant">E_UNEXPECTED</span>, if 
the List-View control has not yet received its <span class="message">WM_CREATE</span> 
message or has already received a <span class="message">WM_DESTROY</span> 
message.
</p>

<!--webbot bot="Include" i-checksum="20458" endspan -->
<p>In the preceding case, the background colour returned at the address given by
<span class="argument">pclrBk</span> is zero (black). </p>
<p>In all other cases, the method succeeds. The background colour that the 
method returns (indirectly, at the address given by <span class="argument">
pclrBk</span>) is the current background colour, if the control is enabled. </p>
<p>By current background colour it is here meant the colour that the control is 
configured to use for its background when the background is next redrawn, 
whenever that turns out to be. Until then, the background as shown to the user 
may have an entirely different colour. This method does nothing to arrange that 
the background be repainted. </p>
<p>Whenever a List-View control is disabled, its current background colour is 
forced to <span class="constant">COLOR_BTNFACE</span>. If this method is called 
while the control is disabled, it returns the colour that is waiting to become 
the current background colour should the control ever be re-enabled. </p>
<h2>Availability </h2>
<p>The <span class="method">GetBackgroundColor</span> method of the
<span class="interface">IListView</span> interface is implemented by List-View 
controls in COMCTL32 versions 6.10 and higher. </p>
<p>In all COMCTL32 versions from at least 3.50, the functionality of the
<span class="method">GetBackgroundColor</span> method is available through the 
windowing system, by sending the <span class="message">
<a href="../../messages/getbkcolor.htm">LVM_GETBKCOLOR</a></span> message. </p>
<div class="Footer">
  <p class="Dates">This page was created on 29th April 2008 and was last 
  modified on 25th May 2008. </p>
  <!--webbot bot="Include" U-Include="../../../../../_include/c08.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2008. Geoff Chappell. All rights reserved.
<a href="../../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="56773" endspan -->
</div>

</body>

</html>