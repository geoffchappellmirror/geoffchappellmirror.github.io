<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Internet Features</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/ie.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/ie.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="43332" -->
<h1>Internet Features </h1>
<p>For the release of Windows XP SP2 and Windows Server 2003 SP1, Microsoft seems 
to have got very conscious of a need to be seen to do more about security for web 
browsing. The URLMON.DLL in these service-pack releases introduces a scheme of named 
security features. Each is a defence of some sort, such that the cautious configuration 
is to enable the feature. Features may be configured differently for different processes. 
Provision also exists by which a feature that is enabled in general for some process 
is disabled for the process’s work with a trusted URL. </p>
<p>These features are made programmatically accessible through functions exported 
from URLMON, the archetypes being <span class="function">
<a href="cointernetisfeatureenabled.htm">CoInternetIsFeatureEnabled</a></span> and
<span class="function"><a href="cointernetsetfeatureenabled.htm">CoInternetSetFeatureEnabled</a></span>. 
They are all documented, and some even have user-interface support. </p>
<p>The following are the features that are supported as of version 7.00 (for Windows 
Vista). </p>
<table class="Constants">
  <tr>
    <th>Constant </th>
    <th>Name </th>
    <th>Applicable Versions </th>
  </tr>
  <tr>
    <td>0x00 </td>
    <td><span class="constant">FEATURE_OBJECT_CACHING</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x01 </td>
    <td><span class="constant">FEATURE_ZONE_ELEVATION</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x02 </td>
    <td><span class="constant">FEATURE_MIME_HANDLING</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x03 </td>
    <td><span class="constant">FEATURE_MIME_SNIFFING</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x04 </td>
    <td><span class="constant">FEATURE_WINDOW_RESTRICTIONS</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x05 </td>
    <td><span class="constant">FEATURE_WEBOC_POPUPMANAGEMENT</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x06 </td>
    <td><span class="constant">FEATURE_BEHAVIORS</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x07 </td>
    <td><span class="constant">FEATURE_DISABLE_MK_PROTOCOL</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x08 </td>
    <td><span class="constant">FEATURE_LOCALMACHINE_LOCKDOWN</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x09 </td>
    <td><span class="constant">FEATURE_SECURITYBAND</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x0A </td>
    <td><span class="constant">FEATURE_RESTRICT_ACTIVEXINSTALL</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x0B </td>
    <td><span class="constant">FEATURE_VALIDATE_NAVIGATE_URL</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x0C </td>
    <td><span class="constant">FEATURE_RESTRICT_FILEDOWNLOAD</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x0D </td>
    <td><span class="constant">FEATURE_ADDON_MANAGEMENT</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x0E </td>
    <td><span class="constant">FEATURE_PROTOCOL_LOCKDOWN</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x0F </td>
    <td><span class="constant">FEATURE_HTTP_USERNAME_PASSWORD_DISABLE</span>
    </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x10 </td>
    <td><span class="constant">FEATURE_SAFE_BINDTOOBJECT</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x11 </td>
    <td><span class="constant">FEATURE_UNC_SAVEDFILECHECK</span> </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x12 </td>
    <td><span class="constant">FEATURE_GET_URL_DOM_FILEPATH_UNENCODED</span>
    </td>
    <td>6.00 from Windows XP SP2, and higher </td>
  </tr>
  <tr>
    <td>0x13 </td>
    <td><span class="constant">FEATURE_TABBED_BROWSING</span> </td>
    <td>7.00 and higher </td>
  </tr>
  <tr>
    <td>0x14 </td>
    <td><span class="constant">FEATURE_SSLUX</span> </td>
    <td>7.00 and higher </td>
  </tr>
  <tr>
    <td>0x15 </td>
    <td><span class="constant">FEATURE_DISABLE_NAVIGATION_SOUNDS</span> </td>
    <td>7.00 and higher </td>
  </tr>
  <tr>
    <td>0x16 </td>
    <td><span class="constant">FEATURE_DISABLE_LEGACY_COMPRESSION</span> </td>
    <td>7.00 and higher </td>
  </tr>
  <tr>
    <td>0x17 </td>
    <td><span class="constant">FEATURE_FORCE_ADDR_AND_STATUS</span> </td>
    <td>7.00 and higher </td>
  </tr>
  <tr>
    <td>0x18 </td>
    <td><span class="constant">FEATURE_XMLHTTP</span> </td>
    <td>7.00 and higher </td>
  </tr>
  <tr>
    <td>0x19 </td>
    <td><span class="constant">FEATURE_DISABLE_TELNET_PROTOCOL</span> </td>
    <td>7.00 and higher </td>
  </tr>
  <tr>
    <td>0x1A </td>
    <td><span class="constant">FEATURE_FEEDS</span> </td>
    <td>7.00 and higher </td>
  </tr>
  <tr>
    <td>0x1B </td>
    <td><span class="constant">FEATURE_BLOCK_INPUT_PROMPTS</span> </td>
    <td>7.00 and higher </td>
  </tr>
</table>
<h2>Registry Settings </h2>
<p>The initial state for each feature is loaded from the registry. As with several 
other collections of registry settings for Internet Explorer, the feature controls 
may appear in any of several branches. In order of decreasing precedence, these 
are: </p>
<ul>
  <li><span class="regkey">HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Internet 
  Explorer\Main\FeatureControl</span> </li>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\Policies\Microsoft\Internet 
  Explorer\Main\FeatureControl</span> </li>
  <li><span class="regkey">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Main\FeatureControl</span>
  </li>
  <li><span class="regkey">HKEY_LOCAL_MACHINE\Software\Microsoft\Internet Explorer\Main\FeatureControl</span>
  </li>
</ul>
<p>except that the branches in <span class="regkey">HKEY_CURRENT_USER</span> are 
ignored if the following evaluates to 1: </p>
<table class="Registry">
  <tr>
    <td>Key </td>
    <td><span class="regkey">HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\CurrentVersion\Internet 
    Settings</span> </td>
  </tr>
  <tr>
    <td>Value </td>
    <td><span class="regvalue">Security_HKLM_only</span> </td>
  </tr>
  <tr>
    <td>Type </td>
    <td><span class="constant">REG_DWORD</span> </td>
  </tr>
</table>
<p>The merit of allowing each setting at the same place with respect to multiple 
branches is the usual one of establishing policies versus preferences, machine-wide 
or per user. </p>
<p>Each feature is its own subkey of the <span class="regkey">FeatureControl</span> 
key. The (case-insensitive) values in the feature’s key each name a process. A special 
value <span class="regvalue">*</span> catches processes that aren’t named explicitly. 
A feature is evaluated for a process by iterating through the applicable branches 
in order of decreasing precedence and accepting the first value that applies to 
that process. It does not matter which branch the value comes from. Each feature 
has a default for when no applicable value is found in any branch. </p>
<table class="Registry">
  <tr>
    <td>Key </td>
    <td><span class="regkey">HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Internet 
    Explorer\Main\FeatureControl\<span class="placeholder">feature</span></span>
    <br>
    <span class="regkey">HKEY_CURRENT_USER\Software\Policies\Microsoft\Internet 
    Explorer\Main\FeatureControl\<span class="placeholder">feature</span></span>
    <br>
    <span class="regkey">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Main\FeatureControl\<span class="placeholder">feature</span></span>
    <br>
    <span class="regkey">HKEY_LOCAL_MACHINE\Software\Microsoft\Internet Explorer\Main\FeatureControl\<span class="placeholder">feature</span></span>
    </td>
  </tr>
  <tr>
    <td>Value </td>
    <td><span class="regvalue"><span class="placeholder">filename</span></span> 
    for any process whose executable has that filename (subject to note below);
    <br>
    <span class="regvalue">*</span> for all executables </td>
  </tr>
  <tr>
    <td>Type </td>
    <td><span class="constant">REG_SZ</span> in policy branches, else
    <span class="constant">REG_DWORD</span> </td>
  </tr>
  <tr>
    <td>Data </td>
    <td>the string <span class="literal">0</span> in policy branches, else the dword 
    0, for false; <br>
    the string <span class="literal">1</span> in policy branches, else the dword 
    1, for true; <br>
    else value is ignored </td>
  </tr>
  <tr>
    <td>Default </td>
    <td>varies with <span class="regkey"><span class="placeholder">feature</span></span> 
    and <span class="regvalue"><span class="placeholder">filename</span></span>
    </td>
  </tr>
</table>
<p>Among the <span class="regvalue"><span class="placeholder">filename</span></span> 
values for any feature control, <span class="regvalue">iexplore.exe</span> stands 
also for any process whose filename is “ieuser.exe”, with the side-effect that values 
named <span class="regvalue">ieuser.exe</span> are ignored. </p>
<p>Note, by the way, that the pattern of these registry settings is not 
exclusive to the features that are exposed through exported URLMON functions. 
There are very many internal features. For a list, see
<a href="../../../../../../notes/windows/ie/featurecontrol.htm">Feature Control 
in Internet Explorer</a>. </p>
<h2>Defaults </h2>
<p>Each feature has two types of default. </p>
<p>The Internet Explorer default applies when the feature is requested for a process 
named EXPLORER.EXE, IEUSER.EXE or IEXPLORE.EXE. The Internet Explorer default has 
all features enabled except: </p>
<ul>
  <li><span class="constant">FEATURE_PROTOCOL_LOCKDOWN</span>; </li>
  <li><span class="constant">FEATURE_DISABLE_NAVIGATION_SOUNDS</span>. </li>
</ul>
<p>For other processes, all features are disabled by default except: </p>
<ul>
  <li><span class="constant">FEATURE_OBJECT_CACHING</span>; </li>
  <li><span class="constant">FEATURE_BEHAVIORS</span>; </li>
  <li><span class="constant">FEATURE_DISABLE_MK_PROTOCOL</span>; </li>
  <li><span class="constant">FEATURE_GET_URL_DOM_FILEPATH_UNENCODED</span>; </li>
  <li><span class="constant">FEATURE_DISABLE_LEGACY_COMPRESSION</span>; </li>
  <li><span class="constant">FEATURE_XMLHTTP</span>. </li>
</ul>
<h2>User-Interface Support </h2>
<p>Some of the features have user-interface support as administrative policies through 
the Windows Vista version of the Group Policy Object Editor. The following table 
lists the folders among the Security Features in the Internet Explorer administrative 
template (displayed under Windows Components), and shows the feature that corresponds 
to each. Note that this support isn’t complete even for the original features and 
doesn’t extend to any of the features added for Windows Vista. </p>
<table>
  <tr>
    <td>Add-on Management </td>
    <td><span class="regkey">FEATURE_ADDON_MANAGEMENT</span> </td>
  </tr>
  <tr>
    <td>Binary Behavior Security Restriction </td>
    <td><span class="regkey">FEATURE_BEHAVIORS</span> </td>
  </tr>
  <tr>
    <td>Consistent Mime Handling </td>
    <td><span class="regkey">FEATURE_MIME_HANDLING</span> </td>
  </tr>
  <tr>
    <td>Information Bar </td>
    <td><span class="regkey">FEATURE_SECURITYBAND</span> </td>
  </tr>
  <tr>
    <td>Local Machine Zone Lockdown Security </td>
    <td><span class="regkey">FEATURE_LOCALMACHINE_LOCKDOWN</span> </td>
  </tr>
  <tr>
    <td>Mime Sniffing Safety Feature </td>
    <td><span class="regkey">FEATURE_MIME_SNIFFING</span> </td>
  </tr>
  <tr>
    <td>MK Protocol Security Restriction </td>
    <td><span class="regkey">FEATURE_DISABLE_MK_PROTOCOL</span> </td>
  </tr>
  <tr>
    <td>Network Protocol Lockdown </td>
    <td><span class="regkey">FEATURE_PROTOCOL_LOCKDOWN</span> </td>
  </tr>
  <tr>
    <td>Object Caching Protection </td>
    <td><span class="regkey">FEATURE_OBJECT_CACHING</span> </td>
  </tr>
  <tr>
    <td>Protection From Zone Elevation </td>
    <td><span class="regkey">FEATURE_ZONE_ELEVATION</span> </td>
  </tr>
  <tr>
    <td>Restrict ActiveX Install </td>
    <td><span class="regkey">FEATURE_RESTRICT_ACTIVEXINSTALL</span> </td>
  </tr>
  <tr>
    <td>Restrict File Download </td>
    <td><span class="regkey">FEATURE_RESTRICT_FILEDOWNLOAD</span> </td>
  </tr>
  <tr>
    <td>Scripted Window Security Restrictions </td>
    <td><span class="regkey">FEATURE_WINDOW_RESTRICTIONS</span> </td>
  </tr>
</table>
<p>One feature is known to have user-interface support through Internet Properties 
in the Control Panel, in the Security group on the Advanced tab. The support is 
specific to “iexplore.exe” as the process. Checking “Allow active content to run 
in files on My Computer” disables <span class="regkey">FEATURE_LOCALMACHINE_LOCKDOWN</span>.
</p>
<div class="Footer">
  <p class="Dates">This page was created on 12th December 2008 and was last modified 
  on 15th December 2008. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c08.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2008. Geoff Chappell. All rights reserved. 
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="62741" -->
</div>

</body>

</html>
