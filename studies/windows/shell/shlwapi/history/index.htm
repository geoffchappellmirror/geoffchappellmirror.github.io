<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SHLWAPI Versions</title>
<link rel="stylesheet" type="text/css" href="../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../_styles/shell.css">
<script type="text/javascript" src="../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="30135" endspan -->
<h1>SHLWAPI Versions </h1>
<p>The Shell Light-Weight Utility library (SHLWAPI.DLL) has so far existed in 
seven variations considered by Microsoft to have sufficient external impact to deserve 
at least a difference in the minor version number. </p>
<table class="FileVersions">
  <colgroup>
    <col class="FileVersion"><col span="3" class="Package">
  </colgroup>
  <tr>
    <th rowspan="2" class="FileVersion">SHLWAPI Version </th>
    <th colspan="3" class="Distribution">Distribution </th>
  </tr>
  <tr>
    <th>Internet Explorer </th>
    <th>Windows </th>
    <th>NT </th>
  </tr>
  <tr>
    <td>4.70 </td>
    <td>3.01, 3.02 </td>
    <td>Windows 95 OSR2 </td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>4.71 </td>
    <td>4.0 </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>4.72 </td>
    <td>4.01 </td>
    <td>Windows 98 </td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>5.0 </td>
    <td>5.0, 5.01 </td>
    <td>Windows 98 SE </td>
    <td>Windows 2000 </td>
  </tr>
  <tr>
    <td>5.50 </td>
    <td>5.5 </td>
    <td>Windows Me </td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>6.0 </td>
    <td>6.0, 7.0, 8.0 </td>
    <td>&nbsp;</td>
    <td>Windows XP, <br>
    Windows Server 2003, <br>
    Windows Vista, <br>
    Windows Server 2008 </td>
  </tr>
  <tr>
    <td>6.1 </td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>Windows 7 </td>
  </tr>
</table>
<p>The earliest part of this history seems to have got lost at Microsoft. The page
<a target="_top" href="http://msdn.microsoft.com/library/bb776779.aspx">Shell and 
Common Controls Versions</a> in the MSDN Library reviews the history of the major 
shell DLLs and is surely intended as authoritative. Yet until at least 2007, Microsoft 
claimed on this page that “Shlwapi.dll first shipped with Internet Explorer 4.0, 
so its first version number is 4.71.” At Microsoft’s website today (16th September 
2008), the text is slightly different. It is now said that “Shlwapi.dll shipped 
with Internet Explorer 4.0, so its initial version number here is 4.71” as if to 
dismiss any earlier version as being out of context. But the context that Microsoft 
sets immediately before is: </p>
<blockquote>
  The following table outlines the different DLL versions and how they were distributed 
  dating back to Microsoft Internet Explorer 3.0, Microsoft Windows 95, and Microsoft 
  Windows NT 4.0.
</blockquote>
<p>I think therefore that the version 4.70 from Internet Explorer 3.0 and Windows 
95 OSR2 must still be counted as missing from Microsoft’s account of SHLWAPI’s history. 
It’s just that it now looks more likely that the early history is not lost at all, 
but is something that Microsoft actively seeks to brush away. </p>
<p>Again until at least 2007, Microsoft’s page also overlooked version 5.50, making 
no mention of Internet Explorer 5.5 and also noting incorrectly that Windows Me 
has “version 5.0 of Shlwapi.dll”. The online version today (16th September 2008) 
does at last list SHLWAPI version 5.5 in the table, but retains the incorrect note. </p>
<p>SHLWAPI was for many years distributed with Internet Explorer. Indeed, it was 
often that the earliest way to obtain new SHLWAPI functionality was to install 
Internet Explorer and there is some argument that Microsoft has regarded SHLWAPI 
as an Internet Explorer component, even though SHLWAPI is essential to the 
Windows Shell even for work that has nothing to do with the Internet. The 
Internet Explorer 8.0 packages for Windows XP and for Windows Server 2003 
include SHLWAPI but the package for Windows Vista does not. </p>
<h2>Builds </h2>
<!--webbot bot="Include" U-Include="../../_include/builds.htm" TAG="BODY" startspan -->

<p>Though the next table fusses over such details as build numbers and dates, it 
is certainly not meant as a comprehensive list even of builds that had formal, public 
releases. For that, consult Microsoft, who manufacture the software and are surely 
best able of anyone to present a definitive record. Bear in mind, however, that 
if Microsoft’s published documentation could sensibly be relied on as either comprehensive 
or accurate, then you could not now be reading these notes. </p>
<p>Builds are arranged in increasing order of the file version as recorded in the 
executable’s resources. This version number is readily visible using Windows Explorer 
either in a so-called infotip for the file or by accessing the Version tab in the 
Properties dialog for the file. Programmers know this version number as coming from 
the so-called root block of the version-information resource, specifically from 
the <span class="member">dwFileVersionMS</span> and <span class="member">dwFileVersionLS</span> 
members of a <span class="struct">VS_FIXEDFILEINFO</span> structure. </p>
<p>The date stamp shown for each version is more obscure. File dates are easily 
modified after the executable is built and are anyway liable to be shown differently 
when read from different time zones. However, there is in each executable’s header 
a date stamp which is set when the executable is built and which is not commonly 
changed afterwards. It is readily accessible to anyone with programming knowledge 
and appropriate tools, e.g., Microsoft’s own DUMPBIN utility. </p>

<!--webbot bot="Include" i-checksum="23166" endspan -->
<!--webbot bot="Include" U-Include="../../_include/iesmalldiff.htm" TAG="BODY" startspan -->

<p>Most Internet Explorer versions supply the executable separately for Windows 
and NT (and in some cases with a further separation for NT 4.0 and Windows 
2000). Where two date stamps are presented on the same row for an Internet 
Explorer release, it means that the Windows and NT executables differ only in 
the file header’s date stamp and checksum (and that the date stamps are from the 
same day). </p>

<!--webbot bot="Include" i-checksum="24391" endspan -->
<table class="FileVersions">
  <colgroup>
    <col class="FileVersion"><col class="DateStamp"><col class="Size">
    <col class="Package">
  </colgroup>
  <tr>
    <th class="FileVersion">File Version </th>
    <th class="DateStamp">File Header Date Stamp </th>
    <th class="Size">Size </th>
    <th class="Package">Package </th>
  </tr>
  <tr>
    <td>4.70.0.1155 </td>
    <td>3208B5F3 (8th August 1996) </td>
    <td>36,864 </td>
    <td>Windows 95 OSR2 </td>
  </tr>
  <tr>
    <td>4.70.0.1215 </td>
    <td>3262E2E1 (15th October 1996) </td>
    <td>37,376 </td>
    <td>Internet Explorer 3.01, 3.02 </td>
  </tr>
  <tr>
    <td rowspan="2">4.71.1712.0 </td>
    <td>34217239 (19th September 1997) </td>
    <td>131,856 </td>
    <td>Internet Explorer 4.0 (Windows) </td>
  </tr>
  <tr>
    <td>342173A5 (19th September 1997) </td>
    <td>131,856 </td>
    <td>Internet Explorer 4.0 (NT) </td>
  </tr>
  <tr>
    <td rowspan="2">4.72.2106.4 </td>
    <td>3472465D (19th November 1997) </td>
    <td>131,856 </td>
    <td>Internet Explorer 4.01 (Windows) </td>
  </tr>
  <tr>
    <td>347247A4 (19th November 1997) </td>
    <td>131,856 </td>
    <td>Internet Explorer 4.01 (NT) </td>
  </tr>
  <tr>
    <td rowspan="3">4.72.3110.0 </td>
    <td>35060D92 (11th March 1998) </td>
    <td>131,856 </td>
    <td>Windows 98 </td>
  </tr>
  <tr>
    <td>3553AA2A (9th May 1998) <br>
    36EEB3DF (17th March 1999) </td>
    <td>131,856 </td>
    <td>Internet Explorer 4.01 SP1 (Windows) <br>
    Internet Explorer 4.01 SP2 (Windows) </td>
  </tr>
  <tr>
    <td>3553AB87 (9th May 1998) <br>
    36EEB5B0 (17th March 1999) </td>
    <td>131,856 </td>
    <td>Internet Explorer 4.01 SP1 (NT) <br>
    Internet Explorer 4.01 SP2 (NT) </td>
  </tr>
  <tr>
    <td>5.0.2314.1000 </td>
    <td>36F1D8DA, 36F1DBAA (19th March 1999) </td>
    <td>282,896 </td>
    <td>Internet Explorer 5.0 </td>
  </tr>
  <tr>
    <td>5.0.2614.3500 </td>
    <td>3717633E (17th April 1999) </td>
    <td>282,896 </td>
    <td>Windows 98 SE </td>
  </tr>
  <tr>
    <td>5.0.2920.0 </td>
    <td>3844D035 (1st December 1999) </td>
    <td>289,552 </td>
    <td>Windows 2000 </td>
  </tr>
  <tr>
    <td rowspan="2">5.0.3103.1000 </td>
    <td>39299478 (23rd May 2000) </td>
    <td>279,312 </td>
    <td>Internet Explorer 5.01 (Windows 2000) </td>
  </tr>
  <tr>
    <td>3947EB46 (15th June 2000) </td>
    <td>289,040 </td>
    <td>Windows 2000 SP1 </td>
  </tr>
  <tr>
    <td>5.0.3105.105 </td>
    <td>3941292D, 39412A8B (10th June 2000) </td>
    <td>288,528 </td>
    <td>Internet Explorer 5.01 (Windows and NT) </td>
  </tr>
  <tr>
    <td>5.0.3502.4373 </td>
    <td>3BDFA427 (31st October 2001) </td>
    <td>289,552 </td>
    <td>Windows 2000 SP2 </td>
  </tr>
  <tr>
    <td>5.0.3502.5332 </td>
    <td>3D3D020B (23rd July 2002) </td>
    <td>290,064 </td>
    <td>Windows 2000 SP3 </td>
  </tr>
  <tr>
    <td>5.0.3502.6601 </td>
    <td>3EF274DC (20th June 2003) </td>
    <td>289,552 </td>
    <td>Windows 2000 SP4 </td>
  </tr>
  <tr>
    <td>5.50.4134.100 </td>
    <td>393701CE (2nd June 2000) </td>
    <td>302,352 </td>
    <td>Windows Me </td>
  </tr>
  <tr>
    <td>5.50.4134.600 </td>
    <td>393D8770, 393D8BED (7th June 2000) </td>
    <td>300,304 </td>
    <td>Internet Explorer 5.5 </td>
  </tr>
  <tr>
    <td>5.50.4807.2300 </td>
    <td>3B5CD625, 3B5CD97B (24th July 2001) </td>
    <td>301,328 </td>
    <td>Internet Explorer 5.5 SP2 </td>
  </tr>
  <tr>
    <td rowspan="2">6.0.2600.0 </td>
    <td>3B7DFE10 (18th August 2001) </td>
    <td>397,824 </td>
    <td>Windows XP </td>
  </tr>
  <tr>
    <td>3B7DFE49, 3B7DFFE3 (18th August 2001) </td>
    <td>391,168 </td>
    <td>Internet Explorer 6.0 </td>
  </tr>
  <tr>
    <td rowspan="2">6.0.2800.1106 </td>
    <td>3D6DFA02 (29th August 2002) </td>
    <td>401,920 </td>
    <td>Windows XP SP1 </td>
  </tr>
  <tr>
    <td>3D6E2AA6, 3D6E2BF2 (30th August 2002) </td>
    <td>395,264 </td>
    <td>Internet Explorer 6.0 SP1 </td>
  </tr>
  <tr>
    <td>6.0.2900.2833 </td>
    <td>43D6EB0C (25th January 2006) </td>
    <td>474,112 </td>
    <td>Windows XP SP2 </td>
  </tr>
  <tr>
    <td>6.0.2900.2995 </td>
    <td>45091361 (14th September 2006) </td>
    <td>474,112 </td>
    <td>Internet Explorer 7.0 for Windows XP <br>
    Internet Explorer 8.0 for Windows XP </td>
  </tr>
  <tr>
    <td>6.0.2900.5512 </td>
    <td>4802A116 (14th April 2008) </td>
    <td>474,112 </td>
    <td>Windows XP SP3 </td>
  </tr>
  <tr>
    <td>6.0.3790.0 </td>
    <td>3E802498 (25th March 2003) </td>
    <td>287,744 </td>
    <td>Windows Server 2003 </td>
  </tr>
  <tr>
    <td>6.0.3790.1830 </td>
    <td>424377DE (25th March 2005) </td>
    <td>321,024 </td>
    <td>Windows Server 2003 SP1 </td>
  </tr>
  <tr>
    <td>6.0.3790.2795 </td>
    <td>45108CD1 (20th September 2006) </td>
    <td>321,536 </td>
    <td>Internet Explorer 7.0 for Windows Server 2003 <br>
    Internet Explorer 8.0 for Windows Server 2003 </td>
  </tr>
  <tr>
    <td>6.0.3790.3959 </td>
    <td>45D70AC0 (18th February 2007) </td>
    <td>320,000 </td>
    <td>Windows Server 2003 SP2 </td>
  </tr>
  <tr>
    <td>6.0.6000.16386 </td>
    <td>4549BDB9 (2nd November 2006) </td>
    <td>339,968 </td>
    <td>Windows Vista </td>
  </tr>
  <tr>
    <td>6.0.6001.18000 </td>
    <td>4791A75C (19th January 2008) </td>
    <td>351,744 </td>
    <td>Windows Vista SP1 <br>
    Windows Server 2008 </td>
  </tr>
  <tr>
    <td>6.0.6002.18005 </td>
    <td>49E037F1 (11th April 2009) </td>
    <td>353,280 </td>
    <td>Windows Vista SP2 </td>
  </tr>
  <tr>
    <td>6.1.7600.16385 </td>
    <td>4A5BDB05 (14th July 2009) </td>
    <td>339,968 </td>
    <td>Windows 7 </td>
  </tr>
</table>
<p>The difference between the NT versions of Internet Explorer 4.01 Service Packs 
1 and 2 is because of rebasing, including to change the file header’s date stamp 
and checksum. The Windows versions differ just in the date stamp and checksum (perhaps 
because rebasing was performed but with the new and old base addresses happening 
to be the same). </p>
<p>No Internet Explorer 5.5 SP1 was found for this study. </p>
<h3>Build Number Shorthand </h3>
<p>SHLWAPI’s programming interface varies from build to build of some major versions. 
The variation becomes especially complicated for version 6.0, not just because of 
the long life of the version over four streams of the Windows product and two of 
Internet Explorer, but also because of a significant muddle over ordinals for undocumented 
functions added for Windows XP SP2 and Windows Server 2003 SP1. </p>
<!--webbot bot="Include" U-Include="../../_include/shorthands.htm" TAG="BODY" startspan -->

<p>This study refers to applicable products and service packs in ascending order 
of versions and build numbers. Be aware that this is not chronological order. For 
instance, the phrase “version 6.0 from Windows XP SP2 and higher” also includes 
all builds of version 6.0 from Windows Server 2003, even though the original Windows 
Server 2003 predates Windows XP SP2. Where the original Windows Server 2003 is excluded, 
as sometimes is needed, the two products are specified: “version 6.0 from Windows 
XP SP2 and Windows Server 2003 SP1 and higher”. A comma before “and higher” indicates 
that the description takes in not only higher builds from the stated version but 
also higher versions. For instance, the phrase “version 6.0 from Windows XP SP2, 
and higher” also includes version 6.10 from Windows 7. </p>

<!--webbot bot="Include" i-checksum="11549" endspan -->
<p>Except if noted differently, builds of SHLWAPI from Internet Explorer 7.0 and 
8.0 for Windows XP are counted as if from Windows XP SP2, and builds for Windows 
Server 2003 are counted as if from Windows Server 2003 SP1. </p>
<div class="Footer">
  <p class="Dates">This page was created on 31st August 2004 and was last modified 
  on 24th December 2009. </p>
  <!--webbot bot="Include" U-Include="../../_include/c0409.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2004-2009. Geoff Chappell. All rights reserved.
<a href="../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="62296" endspan -->
</div>

</body>

</html>
