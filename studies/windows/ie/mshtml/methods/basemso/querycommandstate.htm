<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Security-Policy" content="default-src 'none'; frame-src 'self'; img-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline'; style-src 'self'">
<title>MSHTML Methods: queryCommandState</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/controls.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/demo.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/ie.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/controls.js" defer></script>
<script type="text/javascript" src="../../../../../../_scripts/demo.js" defer></script>
<script type="text/javascript" src="../../../_scripts/ie.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="43332" -->
<div class="Main">
  <h1>MSHTML Methods: queryCommandState </h1>
  <h2>Scripting Syntax </h2>
  <pre class="source">bOn = object.queryCommandState (sCommand);</pre>
  <h3>Object </h3>
  <p>The <span class="method">queryCommandState</span> method applies to the
  <span class="object">document</span> and <span class="object">TextRange</span> 
  objects and the <span class="collection">controlRange</span> collection. </p>
  <h3>Arguments </h3>
  <p>The required <span class="argument">sCommand</span> argument names a command 
  to execute. There are many <a href="index.htm">supported commands</a>. </p>
  <h3>Return Value </h3>
  <p>The method returns <span class="keyword">true</span> if the named command is 
  supported and enabled is in the on state. Otherwise, it returns
  <span class="keyword">false</span>. </p>
  <h2>Behaviour </h2>
  <p>The <span class="method">queryCommandState</span> method provides scriptable 
  access to the object’s <span class="interface">IOleCommandTarget</span> functionality, 
  specifically to call the <span class="method">QueryStatus</span> method and test 
  for a particular combination of flags. </p>
  <!--webbot bot="Include" U-Include="_include/commands.htm" TAG="BODY" startspan -->

<p>The case-insensitive command name given as <span class="argument">sCommand</span> 
translates to a numeric command ID in the MSHTML command group represented 
programmatically by <span class="cgid">CGID_MSHTML</span>. Even within this 
command group, only a small subset of the commands that are supported through 
the
<span class="interface">IOleCommandTarget</span> interface are supported for 
scripting.
</p>

<!--webbot bot="Include" endspan i-checksum="9044" -->
  <p>The <span class="method">queryCommandState</span> method fails, in the sense 
  of causing a runtime script error, if the given command name is not supported 
  for scripting. It also fails, again with a runtime script error, if the call to
  <span class="method">QueryStatus</span> fails. </p>
  <p>Given a successful call to <span class="method">QueryStatus</span>, the
  <span class="method">queryCommandState</span> method returns
  <span class="keyword">true</span> or <span class="keyword">false</span> according 
  to whether <span class="method">QueryStatus</span> produces the following combination:
  </p>
  <ul>
    <li><span class="constant">OLECMDF_SUPPORTED</span> and
    <span class="constant">OLECMDF_ENABLED</span> both set </li>
    <li><span class="constant">OLECMDF_LATCHED</span> set and
    <span class="constant">OLECMDF_NINCHED</span> clear </li>
    <li>all other bits clear </li>
  </ul>
  <p>The second part of this combination represents the on state. To this method, 
  the indeterminate state (if supported) is effectively the same as off. </p>
  <!--webbot bot="Include" U-Include="_include/querystatus.htm" TAG="BODY" startspan -->

<p>Behavior within the call to <span class="method">QueryStatus</span> varies 
with the command and is anyway left for the different topic of MSHTML’s
<span class="interface">IOleCommandTarget</span> functionality. </p>

<!--webbot bot="Include" endspan i-checksum="12494" -->
  <div class="Demonstration">
    <!--webbot bot="Include" U-Include="../../../_include/showdemo.htm" TAG="BODY" startspan -->

<p class="NoScript alert">There is a demonstration here. To see it, please enable 
scripting and then refresh this page.</p>

<!--webbot bot="Include" endspan i-checksum="36776" -->
    <pre id="Test_document_queryCommandState" class="Script">function Test_document_queryCommandState ()
{
    var cmd = prompt ('Enter the name of an MSHTML command to query for the "on" state:', "");
    if (cmd == null) return;

    var result = document.queryCommandState (cmd);
    alert ('queryCommandState ("' + cmd + '") for the document returned ' + result);
}</pre>
  </div>
  <div class="Footer">
    <p class="Dates">This page was created on 10th February 2008 and was last modified 
    on 11th December 2011. </p>
    <!--webbot bot="Include" U-Include="../../../_include/c0811.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2008-2011. Geoff Chappell. All rights reserved. 
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="55279" -->
  </div>
</div>

</body>

</html>
