<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>RTL_PROCESS_MODULE_INFORMATION</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <!--webbot bot="Include" U-Include="../../../../_include/revising.htm" TAG="BODY" startspan -->

<div class="Header">
  <p class="alert">REVISION IN PROGRESS - Take more than your usual care. </p>
</div>

<!--webbot bot="Include" endspan i-checksum="2512" -->
  <h1>RTL_PROCESS_MODULE_INFORMATION </h1>
  <p>The <span class="struct">RTL_PROCESS_MODULE_INFORMATION</span> structure is 
  a recurring element in the <span class="struct">
  <a href="rtl_process_modules.htm">RTL_PROCESS_MODULES</a></span> structure that 
  a successful call to <span class="function">
  <a href="../../../api/ex/sysinfo/query.htm">ZwQuerySystemInformation</a></span> 
  or <span class="function">NtQuerySystemInformation</span> produces at the start 
  of its output buffer when given the information class <span class="constant">SystemModuleInformation</span> 
  (0x0B). </p>
  <h2>Documentation Status </h2>
  <p>The <span class="struct">RTL_PROCESS_MODULE_INFORMATION</span> structure is 
  not documented. </p>
  <!--webbot bot="Include" U-Include="../_include/type_info_urlmon.htm" TAG="BODY" startspan -->

<p>Microsoft does publish the practical equivalent of a C-language definition as 
type information in symbol files—not for the kernel, where the structure is prepared, 
nor even for low-level user-mode DLLs that interpret the structure, but for a handful 
of higher-level DLLs that might ordinarily be thought very distant from any involvement 
with the structure. Perhaps only by oversight, but starting as long ago as Windows 
8, Microsoft’s downloadable packages of public symbols have included a smattering 
of private symbol files and these continue to be available through the public symbol 
server. Precisely which DLLs have the type information varies between versions. 
COMBASE.DLL is among the more reliable nowadays. Disclosure in symbol files for 
URLMON.DLL stopped for the 1803 release of Windows 10 but is specially notable 
because of this DLL’s origins in Internet Explorer and thence for the strong suggestion 
that Microsoft’s programmers of Internet Explorer had access to more details of 
low-level Windows programming than Microsoft publishes for wider use (including 
by the programmers of competing web browsers). </p>

<!--webbot bot="Include" endspan i-checksum="12783" -->
  <!--webbot bot="Include" U-Include="../_include/type_info_ddklibs.htm" TAG="BODY" startspan -->

<p>Type information for the structure has also seeped out at the other end of the 
Windows timeline, though not in symbol files but in statically linked libraries: 
GDISRVL.LIB from the Device Driver Kit (DDK) for Windows NT 3.51; and SHELL32.LIB 
from the DDK for Windows NT 4.0. </p>

<!--webbot bot="Include" endspan i-checksum="3859" -->
  <h2>Layout </h2>
  <p>The <span class="struct">RTL_PROCESS_MODULE_INFORMATION</span> is 0x011C or 
  0x0128 bytes in 32-bit and 64-bit Windows, respectively. </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00 </td>
        <td>0x00 </td>
        <td>
        <pre class="source">PVOID Section;</pre>
        </td>
      </tr>
      <tr>
        <td>0x04 </td>
        <td>0x08 </td>
        <td>
        <pre class="source">PVOID MappedBase;</pre>
        </td>
      </tr>
      <tr>
        <td>0x08 </td>
        <td>0x10 </td>
        <td>
        <pre class="source">PVOID ImageBase;</pre>
        </td>
      </tr>
      <tr>
        <td>0x0C </td>
        <td>0x18 </td>
        <td>
        <pre class="source">ULONG ImageSize;</pre>
        </td>
      </tr>
      <tr>
        <td>0x10 </td>
        <td>0x1C </td>
        <td>
        <pre class="source">ULONG Flags;</pre>
        </td>
      </tr>
      <tr>
        <td>0x14 </td>
        <td>0x20 </td>
        <td>
        <pre class="source">USHORT LoadOrderIndex;</pre>
        </td>
      </tr>
      <tr>
        <td>0x16 </td>
        <td>0x22 </td>
        <td>
        <pre class="source">USHORT InitOrderIndex;</pre>
        </td>
      </tr>
      <tr>
        <td>0x18 </td>
        <td>0x24 </td>
        <td>
        <pre class="source">USHORT LoadCount;</pre>
        </td>
      </tr>
      <tr>
        <td>0x1A </td>
        <td>0x26 </td>
        <td>
        <pre class="source">USHORT OffsetToFileName;</pre>
        </td>
      </tr>
      <tr>
        <td>0x1C </td>
        <td>0x28 </td>
        <td>
        <pre class="source">CHAR FullPathName [0x0100];</pre>
        </td>
      </tr>
    </tbody>
  </table>
  <p>The <span class="member">OffsetToFileName</span> is the offset in bytes from 
  the start of the <span class="member">FullPathName</span> to just the filename 
  part. </p>
  <div class="Footer">
    <p class="Dates">This page was created on 9th
    <a href="../../../../../../../new/16/11.htm">November 2016</a> and was last 
    modified on 29th <a href="../../../../../../../new/23/01.htm">January 2023</a>.
    </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c1623.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2016-2023. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="4941" -->
  </div>
</div>

</body>

</html>
