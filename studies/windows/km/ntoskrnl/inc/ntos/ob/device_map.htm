<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>DEVICE_MAP</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <!--webbot bot="Include" U-Include="../../../../_include/sketch.htm" TAG="BODY" startspan -->

<div class="Header">
  <p class="alert">SKETCH OF HOW RESEARCH MIGHT CONTINUE AND RESULTS BE PRESENTED
  </p>
</div>

<!--webbot bot="Include" endspan i-checksum="5204" -->
  <h1>DEVICE_MAP </h1>
  <p>The <span class="struct">DEVICE_MAP</span> structure (formally
  <span class="struct">_DEVICE_MAP</span>) is where the Object Manager arranges 
  that the \DosDevices directory in the object namespace can refer to a local directory 
  object instead of the global one. </p>
  <h2>Variability </h2>
  <p>The <span class="struct">DEVICE_MAP</span> is highly susceptible to changing 
  between builds. The following changes of size give some rough indication: </p>
  <table class="Sizes">
    <colgroup>
      <col class="Version"><col class="Size" span="2">
    </colgroup>
    <thead>
      <tr>
        <th>Version </th>
        <th>Size (x86) </th>
        <th>Size (x64) </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>5.0 </td>
        <td>0x2C </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>5.1 to 6.0 </td>
        <td>0x30 </td>
        <td>0x38 </td>
      </tr>
      <tr>
        <td>6.1 to 1511 </td>
        <td>0x34 </td>
        <td>0x40 </td>
      </tr>
      <tr>
        <td>1607 to 2004 </td>
        <td>0x38 </td>
        <td>0x48 </td>
      </tr>
    </tbody>
  </table>
  <h2>Layout </h2>
  <p>The sizes in the preceding table and the offsets, names and types in the next 
  are from type information in public symbol files for the kernel, starting from 
  Windows 2000 SP3. </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition">
      <col class="Versions"><col class="Remarks">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
        <th>Remarks </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00 (5.0) </td>
        <td>&nbsp;</td>
        <td>
        <pre class="source">ULONG ReferenceCout;</pre>
        </td>
        <td>5.0 only </td>
        <td>next at 0x08 </td>
      </tr>
      <tr>
        <td>0x04 (5.0); <br>
        0x00 </td>
        <td>0x00 </td>
        <td>
        <pre class="source"><a href="object_directory.htm">OBJECT_DIRECTORY</a> *DosDevicesDirectory;</pre>
        </td>
        <td>5.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x04 </td>
        <td>0x08 </td>
        <td>
        <pre class="source">OBJECT_DIRECTORY *GlobalDosDevicesDirectory;</pre>
        </td>
        <td>5.1 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x08 </td>
        <td>0x10 </td>
        <td>
        <pre class="source">HANDLE DosDevicesDirectoryHandle;</pre>
        </td>
        <td>6.1 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x08 (5.1 to 6.0); <br>
        0x0C </td>
        <td>0x10 (late 5.2 to 6.0); <br>
        0x18 </td>
        <td>
        <pre class="source">ULONG ReferenceCount;</pre>
        </td>
        <td>5.1 and higher </td>
        <td>previously at 0x00 </td>
      </tr>
      <tr>
        <td>0x08 (5.0); <br>
        0x0C (5.1 to 6.0); <br>
        0x10 </td>
        <td>0x14 (late 5.2 to 6.0); <br>
        0x1C </td>
        <td>
        <pre class="source">ULONG DriveMap;</pre>
        </td>
        <td>5.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x0C (5.0); <br>
        0x10 (5.1 to 6.0); <br>
        0x14 </td>
        <td>0x18 (late 5.2 to 6.0); <br>
        0x20 </td>
        <td>
        <pre class="source">UCHAR DriveType [0x20];</pre>
        </td>
        <td>5.0 and higher </td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>0x34 </td>
        <td>0x40 </td>
        <td>
        <pre class="source"><a href="../ps/ejob/index.htm">EJOB</a> *ServerSilo;</pre>
        </td>
        <td>1607 and higher </td>
        <td>&nbsp;</td>
      </tr>
    </tbody>
  </table>
  <div class="Footer">
    <p class="Dates">This page was created on 16th
    <a href="../../../../../../../new/22/07.htm">August 2022</a> and was last modified 
    on 21st August 2022. </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c22.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2022. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="5890" -->
  </div>
</div>

</body>

</html>
