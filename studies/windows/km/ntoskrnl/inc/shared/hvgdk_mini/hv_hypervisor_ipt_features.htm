<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>HV_HYPERVISOR_IPT_FEATURES</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <h1>HV_HYPERVISOR_IPT_FEATURES </h1>
  <p>The <span class="struct">HV_HYPERVISOR_IPT_FEATURES</span> structure (formally
  <span class="struct">_HV_HYPERVISOR_IPT_FEATURES</span> ) collects the flags that 
  a Microsoft-compatible hypervisor’s <span class="instruction">
  <a href="../../../../cpu/cpuid/index.htm">cpuid</a></span> leaf 0x4000000B produces 
  in the <span class="register">eax</span>, <span class="register">ebx</span>,
  <span class="register">ecx</span> and <span class="register">edx</span> registers.
  </p>
  <h2>Availability </h2>
  <p>The <span class="struct">HV_HYPERVISOR_IPT_FEATURES</span> is new for the 1903 
  release of Windows 10. </p>
  <h3>Access </h3>
  <p>The kernel is not known to expose this structure or any reading of
  <span class="instruction">cpuid</span> leaf 0x4000000B through any interface, 
  documented or not, even in kernel mode. </p>
  <h2>Documentation Status </h2>
  <p>The <span class="struct">HV_HYPERVISOR_IPT_FEATURES</span> structure is not 
  documented. The hypervisor’s <span class="instruction">cpuid</span> implementation 
  is documented in the
  <a href="https://msdn.microsoft.com/en-us/virtualization/hyperv_on_windows/reference/tlfs">
  Hypervisor Top-Level Functional Specification</a> (TLFS). What’s offered today, 
  10th December 2022, as the specification’s most recent version is a PDF that is 
  getting on to three years old (version 6.0b, dated February 2020). it extends 
  only to leaf 0x4000000A. The reality behind the superficially fine words of the 
  Microsoft Open Specification Promise is that the Hyper-V implementation, and presumably 
  Microsoft’s use of it to Microsoft’s advantage for Microsoft’s purposes, runs 
  ahead of the documentation that Microsoft opens for general use. </p>
  <p>As for the <span class="struct">HV_HYPERVISOR_IPT_FEATURES</span> as Microsoft’s 
  particular expression of the output from <span class="instruction">cpuid</span> 
  leaf 0x4000000B, disclosure by Microsoft is conspicuously thin. The practical 
  equivalent of a C-language definition might be published as type information in 
  symbol files, but I yet know of it only as type information in two statically 
  linked libraries. One, named CLFSMGMT.LIB, is among the many that are supplied 
  with the Software Development Kit (SDK) for user-mode programming. Type information 
  for the <span class="struct">HV_HYPERVISOR_IPT_FEATURES</span> drops out of this 
  library in Version 2004. The other is more obviously related to hypervisors. It 
  is named KDHV.LIB. Microsoft distributes it among the programming samples in the 
  Debugging Tools for Windows. </p>
  <h2>Layout </h2>
  <p>The <span class="struct">HV_HYPERVISOR_IPT_FEATURES</span> is 0x10 bytes in 
  both 32-bit and 64-bit Windows. Offsets and definitions below are from type information 
  in KDHV.LIB. </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset"><col class="Definition"><col class="Versions">
    </colgroup>
    <thead>
      <tr>
        <th>Offset </th>
        <th>Definition </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00 </td>
        <td>
        <pre class="source">/*  bit fields, see below  */</pre>
        </td>
        <td>1903 and higher </td>
      </tr>
      <tr>
        <td>0x04 </td>
        <td>
        <pre class="source">UINT32 Reserved1;</pre>
        </td>
        <td>1903 and higher </td>
      </tr>
      <tr>
        <td>0x08 </td>
        <td>
        <pre class="source">UINT32 Reserved2;</pre>
        </td>
        <td>1903 and higher </td>
      </tr>
      <tr>
        <td rowspan="2">0x0C </td>
        <td>
        <pre class="source">UINT32 Reserved3;</pre>
        </td>
        <td>1903 only </td>
      </tr>
      <tr>
        <td>
        <pre class="source">/*  bit fields, see below  */</pre>
        </td>
        <td>2004 and higher </td>
      </tr>
    </tbody>
  </table>
  <h3>Offset 0x00 (<span class="register">EAX</span>) </h3>
  <table class="Flags">
    <colgroup>
      <col class="Mask"><col class="Definition">
    </colgroup>
    <thead>
      <tr>
        <th>Mask </th>
        <th>Definition </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00000001 </td>
        <td>
        <pre class="source">UINT32 ChainedToPA : 1;</pre>
        </td>
      </tr>
      <tr>
        <td>0x00000002 </td>
        <td>
        <pre class="source">UINT32 Enlightened : 1;</pre>
        </td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>
        <pre class="source">UINT32 Reserved0 : 10;</pre>
        </td>
      </tr>
      <tr>
        <td>0xFFFFF000 </td>
        <td>
        <pre class="source">UINT32 MaxTraceBufferSizePerVtl : 20;</pre>
        </td>
      </tr>
    </tbody>
  </table>
  <h3>Offset 0x0C (<span class="register">EDX</span>) </h3>
  <table class="Flags">
    <colgroup>
      <col class="Mask"><col class="Definition"><col class="Versions">
    </colgroup>
    <thead>
      <tr>
        <th>Mask </th>
        <th>Definition </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00000001 </td>
        <td>
        <pre class="source">UINT32 HypervisorIpt : 1;</pre>
        </td>
        <td>2004 and higher </td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>
        <pre class="source">UINT32 Reserved3 : 31;</pre>
        </td>
        <td>2004 and higher </td>
      </tr>
    </tbody>
  </table>
  <div class="Footer">
    <p class="Dates">This page was created on 10th
    <a href="../../../../../../../new/22/12.htm">December 2022</a>. </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c22.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2022. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="5890" -->
  </div>
</div>

</body>

</html>
