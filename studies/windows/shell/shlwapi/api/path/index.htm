<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Security-Policy" content="base-uri 'none'; default-src 'none'; form-action 'none'; frame-src 'self'; img-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'">
<title>Path Utility Functions</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
<style type="text/css">
span.old {
  background-color: #F0F0FF;
}
</style>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="43332" -->
<h1>Path Utility Functions </h1>
<p>The first released version of SHLWAPI, namely 4.70, exported numerous functions 
for working with paths and pathnames and for operating on the corresponding files 
and directories. Many are very much the sorts of things that programmers find themselves 
writing too often and spending too much time over because of surprisingly many special 
cases. As Matt Pietrek said in <span class="citation">A Programmer’s Perspective 
on New System DLL Features in Windows NT 5.0, Part II</span>, apparently from
<span class="citation">Microsoft Systems Journal</span> in December 1997, this is 
“useful ‘Why didn’t they do this three years ago?’ functionality” to do “potentially 
error-prone work for you”. </p>
<p>As it happens, at least a few of these functions for path manipulation were already 
old (for an industry with notoriously short attention). They were just not known 
very widely. SHLWAPI version 4.70 was already in retail releases of Windows over 
a year earlier. Moreover, some of the functions had an even earlier life, dating 
from the original Windows 95, but implemented in SHELL32. I do not mean to put words 
in Matt’s mouth, but I wonder if as a co-author of <span class="citation">Undocumented 
Windows</span> (Addison-Wesley, 1992, ISBN 0-201-60834-0), his question was really 
code for “Why didn’t they <span class="emphasis">document</span> this three years 
ago?” </p>
<p>The following list shows the path utility functions that are exported from SHLWAPI 
version 6.00.2800.1106 (Windows XP Service Pack 1). A version in brackets is the 
first SHLWAPI version that is known to export the function. Where no version is 
given, it is understood that the function dates from SHLWAPI version 4.70 (released 
in 1996), or earlier. Most, by far, are indeed that old. The truly ancient functions 
that SHLWAPI acquired from SHELL32 version 4.0 are <span class="old">shaded blue</span>.
</p>
<p>A handful of path utility functions were added for version 4.71, which is when 
Microsoft got round to documenting the set. Note that almost all the path utility 
functions are documented. However, it is conspicuous that among the continuing additions 
almost all that have been added since Windows 2000 are undocumented. Functions that 
were not documented as late as the January 2004 edition of the MSDN Library on CD 
are <span class="undocumented">highlighted yellow</span>. </p>
<ul>
  <li><span class="undocumented function">CharLowerNoDBCS</span> (5.0 from Windows 
  2000) </li>
  <li><span class="undocumented function">CharUpperNoDBCS</span> (5.0 from Windows 
  2000) </li>
  <li><span class="undocumented function">FixSlashesAndColon</span> (5.0 from Windows 
  2000) </li>
  <li><span class="undocumented function">NextPath</span> (5.0 from Windows 2000)
  </li>
  <li><span class="old function">PathAddBackslash</span> </li>
  <li><span class="function">PathAddExtension</span> </li>
  <li><span class="old function">PathAppend</span> </li>
  <li><span class="old function">PathBuildRoot</span> </li>
  <li><span class="function">PathCanonicalize</span> </li>
  <li><span class="old function">PathCombine</span> </li>
  <li><span class="function">PathCommonPrefix</span> </li>
  <li><span class="function">PathCompactPath</span> </li>
  <li><span class="function">PathCompactPathEx</span> </li>
  <li><span class="old function">PathFileExists</span> </li>
  <li><span class="undocumented function">PathFileExistsAndAttributes</span> (5.0 
  from Windows 2000) </li>
  <li><span class="undocumented function">PathFileExistsDefExt</span> (4.71)
  </li>
  <li><span class="undocumented function">PathFileExistsDefExtAndAttributesW</span> 
  (6.0) </li>
  <li><span class="old function">PathFindExtension</span> </li>
  <li><span class="old function">PathFindFileName</span> </li>
  <li><span class="function">PathFindNextComponent</span> </li>
  <li><span class="old function">PathFindOnPath</span> </li>
  <li><span class="undocumented function">PathFindOnPathEx</span> (4.71) </li>
  <li><span class="function">PathFindSuffixArray</span> (5.0) </li>
  <li><span class="old function">PathGetArgs</span> </li>
  <li><span class="function">PathGetCharType</span> (4.71) </li>
  <li><span class="old function"><a href="getdrivenumber.htm">PathGetDriveNumber</a></span>
  </li>
  <li><span class="function">PathIsContentType</span> (4.71) </li>
  <li><span class="old function">PathIsDirectory</span> </li>
  <li><span class="function">PathIsDirectoryEmpty</span> (5.0) </li>
  <li><span class="function">PathIsFileSpec</span> </li>
  <li><span class="function">PathIsLFNFileSpec</span> (5.0) </li>
  <li><span class="function">PathIsNetworkPath</span> (5.0) </li>
  <li><span class="function">PathIsPrefix</span> </li>
  <li><span class="old function">PathIsRelative</span> </li>
  <li><span class="old function">PathIsRoot</span> </li>
  <li><span class="old function">PathIsSameRoot</span> </li>
  <li><span class="function">PathIsSystemFolder</span> (4.71) </li>
  <li><span class="old function">PathIsUNC</span> </li>
  <li><span class="function">PathIsUNCServer</span> (4.71) </li>
  <li><span class="function">PathIsUNCServerShare</span> (4.71) </li>
  <li><span class="old function">PathIsURL</span> </li>
  <li><span class="undocumented function">PathIsValidChar</span> (5.0 from Windows 
  2000) </li>
  <li><span class="function">PathMakePretty</span> </li>
  <li><span class="function"><a href="makesystemfolder.htm">PathMakeSystemFolder</a></span> 
  (4.71) </li>
  <li><span class="old function">PathMatchSpec</span> </li>
  <li><span class="old function"><a href="parseiconlocation.htm">PathParseIconLocation</a></span>
  </li>
  <li><span class="old function">PathQuoteSpaces</span> </li>
  <li><span class="function">PathRelativePathTo</span> </li>
  <li><span class="old function">PathRemoveArgs</span> </li>
  <li><span class="function">PathRemoveBackslash</span> </li>
  <li><span class="old function">PathRemoveBlanks</span> </li>
  <li><span class="old function">PathRemoveExtension</span> </li>
  <li><span class="old function">PathRemoveFileSpec</span> </li>
  <li><span class="function">PathRenameExtension</span> </li>
  <li><span class="function">PathSearchAndQualify</span> </li>
  <li><span class="old function">PathSetDlgItemPath</span> </li>
  <li><span class="undocumented function">PathSkipLeadingSlashesA</span> (5.0)
  </li>
  <li><span class="function">PathSkipRoot</span> </li>
  <li><span class="old function">PathStripPath</span> </li>
  <li><span class="old function">PathStripToRoot</span> </li>
  <li><span class="function">PathUndecorate</span> (5.0) </li>
  <li><span class="function">PathUnExpandEnvStrings</span> (5.0 from Windows 2000)
  </li>
  <li><span class="undocumented function">PathUnExpandEnvStringsForUser</span> (5.0 
  from Windows 2000) </li>
  <li><span class="function">PathUnmakeSystemFolder</span> (4.71) </li>
  <li><span class="old function">PathUnquoteSpaces</span> </li>
</ul>
<p>It is in the nature of working with paths that these functions almost all have 
ANSI and Unicode forms. The only exceptions are <span class="function">PathSkipLeadingSlashesA</span> 
and <span class="function">PathFileExistsDefExtAndAttributesW</span>. The functions 
chosen as path utilities for the purpose of this article are all those that SHLWAPI 
acquires from object files named PATHA.OBJ and PATHW.OBJ, linked from libraries 
SHLWANSI.LIB and SHLWUNI.LIB respectively. The ANSI and Unicode implementations 
are each native to their character sets, as opposed to one converting to and from 
the other. They seem likely to differ only through conditional compilation. </p>
<div class="Footer">
  <!--webbot bot="Include" U-Include="../../../_include/c0709.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2007-2009. Geoff Chappell. All rights reserved.
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="4319" -->
</div>

</body>

</html>
