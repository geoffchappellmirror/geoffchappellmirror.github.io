<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SHGetPerScreenResName</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js">
</script>
<script type="text/javascript" src="../../../../../../_scripts/document.js">
</script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>SHGetPerScreenResName </h1>
<p>This function obtains a string to describe the screen resolution for use with 
a view state. </p>
<h2>Declaration </h2>
<pre class="source">int
SHGetPerScreenResName (
    LPWSTR pszBuffer,
    int cchBuffer,
    DWORD dwReserved);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">pszBuffer</span> and <span class="argument">
cchBuffer</span> arguments provide the address and size, in Unicode characters, 
of a buffer in which to receive the per-screen resolution name as a 
null-terminated Unicode string. </p>
<p>The <span class="argument">dwReserved</span> argument has unknown 
significance except that it must be zero. </p>
<h3>Return Value </h3>
<p>The function returns the length, in characters, of the generated name. It 
returns zero on failure. </p>
<h2>
Behaviour </h2>
<p>The function fails trivially if <span class="argument">dwReserved</span> is 
not zero. Otherwise, the per-screen resolution name is generated and as much as 
possible is copied to the given buffer. The name is formed as the screen width 
and height, separated by an “x”, followed by the number of monitors, in 
brackets. All three numbers are decimal. </p>
<h2>Use by Microsoft </h2>
<p>The only known use that Microsoft makes of this function in executables 
distributed with Windows is for BROWSEUI.DLL and SHELL32.DLL when loading and 
saving view states for browsed folders. Though the function is used by two 
executables, it really is joint use: the relevant code is from the one source 
file (PROPERTYBAG.CPP) that the two executables share at link-time via a library 
(STOCK4.LIB). Five properties have a screen resolution string added to their 
names. BROWSEUI manages the <span class="property">MinPos</span>,
<span class="property">MaxPos</span> and <span class="property">WinPos</span> 
properties. SHELL32 manages <span class="property">ItemPos</span> and
<span class="property">ScrollPos</span>. </p>
<h2>Availability </h2>
<p>The <span class="function">SHGetPerScreenResName</span> function is exported 
from SHLWAPI as ordinal 533 in version 6.00 and higher. </p>
<!--webbot bot="Include" U-Include="../_include/undoc600.htm" TAG="BODY" startspan -->

<p>Though this function dates from 2001, it was still not documented by 
Microsoft in the MSDN Library at least as late as the CD edition dated January 
2004. </p>

<!--webbot bot="Include" i-checksum="12777" endspan -->
<div class="Footer">
  <p class="Dates">This page was created on 8th March 2007 and was last modified 
  on 15th March 2007. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c07.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2007. Geoff Chappell. All rights reserved. 
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="62613" endspan -->
</div>

</body>

</html>