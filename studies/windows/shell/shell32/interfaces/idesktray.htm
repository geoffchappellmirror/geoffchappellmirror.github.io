<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>IDeskTray</title>
<link rel="stylesheet" type="text/css" href="../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../_styles/shell.css">
<script type="text/javascript" src="../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="30135" endspan -->
<h1>IDeskTray </h1>
<p>The <span class="interface">IDeskTray</span> methods are (as ordered in the virtual 
function table after the <span class="interface">IUnknown</span> methods): </p>
<table class="Struct">
  <tr>
    <th>Offset </th>
    <th>Method </th>
  </tr>
  <tr>
    <td>0x0C </td>
    <td><span class="method">AppBarGetState</span> </td>
  </tr>
  <tr>
    <td>0x10 </td>
    <td><span class="method">GetTrayWindow</span> </td>
  </tr>
  <tr>
    <td>0x14 </td>
    <td><span class="method">SetDesktopWindow</span> </td>
  </tr>
  <tr>
    <td>0x18 </td>
    <td><span class="method">SetVar</span> </td>
  </tr>
</table>
<p>with prototypes: </p>
<pre class="source">UINT AppBarGetState (VOID);</pre>
<pre class="source">HRESULT GetTrayWindow (HWND *);</pre>
<pre class="source">HRESULT SetDesktopWindow (HWND);</pre>
<pre class="source">HRESULT SetVar (INT, ULONG);</pre>
<h2>Implementation </h2>
<p>The only known use of the <span class="interface">IDeskTray</span> interface 
is for the SHELL32.DLL function <span class="function">SHCreateDesktop</span>, which 
takes an <span class="interface">IDeskTray</span> pointer as its one argument. The 
interface is of course implemented in EXPLORER but would also be implemented in 
any program that attempts to replace EXPLORER (presumably to improve on it as the 
shell’s front end) while still having SHELL32 present the familiar desktop. </p>
<p>The implementation in EXPLORER is notable for having its <span class="method">
QueryInterface</span> method always fail, which is why no IID is known for the interface.
</p>
<h2>Availability </h2>
<p>The <span class="interface">IDeskTray</span> interface is supported by EXPLORER 
and SHELL32 in version 5.00 and higher. </p>
<!--webbot bot="Include" U-Include="_include/undoc500.htm" TAG="BODY" startspan -->

<p>Though this interface dates from 1999, it was still not documented by 
Microsoft as late as the January 2007 edition of the Windows Vista Software 
Development Kit (SDK). </p>

<!--webbot bot="Include" i-checksum="56246" endspan -->
<div class="Footer">
  <p class="Dates">This page was created on 28th June 2009. </p>
  <!--webbot bot="Include" U-Include="../../_include/c09.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2009. Geoff Chappell. All rights reserved.
<a href="../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="53291" endspan -->
</div>

</body>

</html>
