<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>PathParseIconLocation</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>PathParseIconLocation </h1>
<p>This function parses a resource location string. </p>
<h2>Declaration </h2>
<pre class="source">int PathParseIconLocation (LPTSTR pszIconFile);</pre>
<!--webbot bot="Include" U-Include="../_include/aw.htm" TAG="BODY" startspan -->

<p>The function exists in ANSI and Unicode forms. </p>

<!--webbot bot="Include" i-checksum="40026" endspan -->
<h3>Parameters </h3>
<p>The <span class="argument">pszIconFile</span> argument provides the address of a 
null-terminated string in a standard notation for specifying the pathname of an 
executable and either a resource index or resource ID. </p>
<h3>Return Value </h3>
<p>If the function succeeds, it returns the (positive) resource index or 
(negative) resource ID, and the input string is modified to be just the 
pathname. Failure is indicated by returning zero. </p>
<h2>Behaviour </h2>
<p>If <span class="argument">pszIconFile</span> is NULL, the function has 
nothing to parse, and fails. </p>
<p>The input string is expected to end with a comma, any number of spaces or 
minus signs, an uninterrupted sequence of one or more decimal digits, and then 
any number of characters other than a comma. If the input string does not fit 
this format, then the resource index or ID is zero and the whole input string is 
treated as a pathame (see below). </p>
<p>Otherwise, the characters before the comma become the pathname and the 
characters after the comma are interpreted as the resource index or ID. If there 
are spaces or more than one minus sign between the comma and the decimal digits, 
then the resource index or ID is zero. (This may be an unintended consequence of the <span class="function"><a href="../strings/strtoint.htm">StrToInt</a></span> 
function being misdocumented as supporting leading white space.) Evaluation of 
the decimal digits gives the resource index or ID. If a minus sign precedes the 
decimal digits, the evaluation is negated and denotes a resource ID. </p>
<p>Whatever is parsed as the pathname is processed in place. If the pathname is 
not the whole of the input string, it is null-terminated at the separating 
comma. Enclosing double-quotes are removed, and then so are leading and trailing 
spaces. </p>
<h2>Availability </h2>
<p>The <span class="function">PathParseIconLocation</span> function is exported by 
name (with ANSI and Unicode suffixes) from SHLWAPI in version 4.70 and higher. It 
is also exported from SHELL32.DLL as ordinal 249 (in ANSI for Windows builds and 
Unicode for NT builds) in version 4.00 and higher. The implementation in SHELL32 
version 4.71 and higher is just to dump to the coding in SHLWAPI. </p>
<!--webbot bot="Include" U-Include="../_include/latedoc471.htm" TAG="BODY" startspan -->

<p>This function has been documented since some time in 1997-98. Though it dates 
from 1996 in SHLWAPI and from 1995 elsewhere, it has always been said to require 
at least SHLWAPI version 4.71. </p>

<!--webbot bot="Include" i-checksum="55748" endspan -->
<div class="Footer">
  <p class="Dates">This page was created on 8th July 2009. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c09.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2009. Geoff Chappell. All rights reserved.
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="50766" endspan -->
</div>

</body>

</html>
