<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>DPA_CreateEx</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="14798" endspan -->
<h1>DPA_CreateEx </h1>
<p>This function creates a dynamic pointer array in a specified heap. </p>
<h2>Declaration </h2>
<pre class="source">HDPA
DPA_CreateEx (
    int cpGrow,
    HANDLE hHeap);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">cpGrow</span> argument provides the allocation unit 
for the DPA, measured as a number of pointers. </p>
<p>The <span class="argument">hHeap</span> argument provides a handle of the heap 
to use for the DPA, or is NULL for the default heap. </p>
<h3>Return Value </h3>
<p>The function returns a handle to the DPA if successful, else NULL for failure.
</p>
<h2>Behaviour </h2>
<p>The function creates a DPA handle as the address of a small control structure 
also named <span class="struct"><a href="dpa.htm">DPA</a></span>. Memory for the 
control structure is obtained from the heap given by the <span class="argument">
hHeap</span> argument. If this argument is NULL, the function uses the process heap 
in the NT implementations, else a private heap in the Windows implementations.
</p>
<!--webbot bot="Include" U-Include="_include/cpgrow.htm" TAG="BODY" startspan -->

<p>Memory for the pointer array itself is not obtained by this function. Instead, 
the memory block that contains the array grows and shrinks according to the demands 
of other functions, but always as a multiple of an allocation unit whose initial 
size is set from the <span class="argument">cpGrow</span> argument. This allocation 
unit has an effective minimum of eight: the function chooses eight as the allocation 
unit if given any lesser value. </p>

<!--webbot bot="Include" i-checksum="20375" endspan -->
<h2>Availability </h2>
<p>The <span class="function">DPA_CreateEx</span> function is exported from COMCTL32.DLL 
as ordinal 340 in version 3.50 and higher. The implementation for version 6.10 
and higher is built into a statically linked library and thence is also exported 
from the Internet Explorer module IERTUTIL.DLL as ordinal 75 in version 7.0 and 
higher. </p>
<!--webbot bot="Include" U-Include="../../_include/undoc400.htm" TAG="BODY" startspan -->

<p>Though this function dates from as long ago as 1995, it was still not 
documented by Microsoft in the MSDN Library at least as late as the CD edition 
dated January 2004. </p>

<!--webbot bot="Include" i-checksum="42917" endspan -->
<!--webbot bot="Include" U-Include="../../_include/doc0506.htm" TAG="BODY" startspan -->

<p>This function has, however, got documented since then (in 2006 or perhaps 
some time during 2005). This article now uses Microsoft’s nomenclature. </p>

<!--webbot bot="Include" i-checksum="58210" endspan -->
<div class="Footer">
  <p class="Dates">This page was created on 9th April 2005 (from material first 
  published in 1997) and was last modified 
  on 15th March 2010. </p>
  <!--webbot bot="Include" U-Include="../../../../_include/c9710.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 1997-2010. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="5797" endspan -->
</div>

</body>

</html>