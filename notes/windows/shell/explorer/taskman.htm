<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Run Program at Startup as Taskman</title>
<link rel="stylesheet" type="text/css" href="../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/notes.css">
<script type="text/javascript" src="../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/notes.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript Header" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="57445" -->
<div class="Main">
  <h1>Run Program at Startup as Taskman </h1>
  <p>Windows NT builds of the Windows Explorer provide yet another way to get a 
  program to run automatically in an otherwise normal startup. Whenever EXPLORER.EXE 
  runs as the shell, seen most obviously by its creating the desktop and taskbar, 
  it checks the following registry value and runs whatever command line it finds 
  there. </p>
  <table class="Registry">
    <tr>
      <td>Key </td>
      <td><span class="regkey">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon</span>
      </td>
    </tr>
    <tr>
      <td>Value </td>
      <td><span class="regvalue">Taskman</span> </td>
    </tr>
  </table>
  <p>The data type is immaterial, but there is a limit of 520 bytes. Any data that 
  is read successfully from the registry for the <span class="regvalue">Taskman</span> 
  value is accepted as a Unicode string to be tried as a command line, provided 
  only that the first two bytes are not both zero. (No, EXPLORER does not actually 
  check that at least two bytes are produced.) </p>
  <p>Note especially that execution is not subject to any policy settings or other 
  such restrictions. Execution occurs very early, even before EXPLORER waits for 
  the Service Control Manager to initialise. In terms of other ways to have EXPLORER 
  run programs automatically, this is easily the earliest, preceding even the processing 
  of <span class="regkey">RunOnce</span> entries. </p>
  <h2>Applicable Versions </h2>
  <p>This behaviour is seen in all known NT builds of EXPLORER.EXE as far back as 
  version 4.0.1377.1 from Windows NT 4.0 and continuing at least until version 6.0.6000.16386 
  from Windows Vista. </p>
  <div class="Footer">
    <p class="Dates">This page was created on 14th January 2005 and was last modified 
    on 29th June 2009. </p>
    <!--webbot bot="Include" U-Include="../../../_include/c0509.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2005-2009. Geoff Chappell. All rights reserved. 
<a href="../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="48880" -->
  </div>
</div>

</body>

</html>
