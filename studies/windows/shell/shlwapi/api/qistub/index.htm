<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>QueryInterface Helper</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js">
</script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>QueryInterface Helper </h1>
<p>Right from the start, COM interfaces have been vital to communication between 
shell modules, e.g., from EXPLORER.EXE to SHELL32.DLL, and as a significant 
means of exposing shell objects to programmatic access by shell clients 
(notwithstanding that many of the necessary CLSIDs and IIDs were left 
undocumented). As these interfaces grew in number and complexity, and especially 
as Internet Explorer was “integrated” into the shell, it was only natural that 
the shell modules would acquire for themselves an efficient, standardised helper 
for implementing the <span class="method">QueryInterface</span> 
method. </p>
<p>As it happens, the shell modules acquired their helper from elsewhere. Its 
first known appearance is in early versions of SHDOCVW.DLL, e.g., for Internet 
Explorer 4.0 and Windows 98, though not as an export. It was moved into 
SHLWAPI.DLL for version 5.00, exported, and used widely. </p>
<p>Perhaps because of this history elsewhere, someone must have thought the 
function important enough to keep separate. In SHDOCVW, it was just one of 
numerous functions buried in a file of miscellaneous utility functions 
(UTIL.OBJ), but in SHLWAPI it sits in its own file (QISTUB.OBJ). </p>
<ul>
  <li><span class="doc04 function"><a href="qisearch.htm">QISearch</a></span> </li>
</ul>
<div class="Footer">
  <!--webbot bot="Include" U-Include="../../../_include/c07.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2007. Geoff Chappell. All rights reserved. 
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="62613" endspan -->
</div>

</body>

</html>