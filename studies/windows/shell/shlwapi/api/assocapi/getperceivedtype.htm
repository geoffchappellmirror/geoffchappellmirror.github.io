<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>AssocGetPerceivedType</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>AssocGetPerceivedType </h1>
<h2>Declaration </h2>
<pre class="source">HRESULT
AssocGetPerceivedType (
    LPCWSTR pszExt, 
    PERCEIVED *ptype, 
    PERCEIVEDFLAG *pflag, 
    LPWSTR *ppszType);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">pszExt</span> argument provides the address of a case-insensitive 
null-terminated string that describes the type to look up. </p>
<p>The <span class="argument">ptype</span> argument provides the address of a variable 
that is to receive a code that identifies the perceived type. </p>
<p>The <span class="argument">pflag</span> argument provides the address of a variable 
that is to receive flags that describe the perceived type. </p>
<p>The <span class="argument">ppszType</span> argument provides the address of a 
variable that is to receive a string representation of the perceived type. The
<span class="argument">ppszType</span> argument may be NULL if this information 
is not wanted. </p>
<h3>Return Value </h3>
<!--webbot bot="Include" U-Include="../_include/hresult.htm" TAG="BODY" startspan -->

<p>The function returns zero for success, else an error code. </p>

<!--webbot bot="Include" i-checksum="1551" endspan -->
<p>The variables at <span class="argument">ptype</span> and
<span class="argument">pflag</span> are meaningful even on failure. </p>
<h2>Behaviour </h2>
<p>If the given type is any of many file extensions for which information is hard-coded 
into SHLWAPI, then the function’s behaviour is determined entirely from the hard-coded 
information. The following large table shows the complete behaviour. Note that although 
the function recognises “.lnk” and “.search-ms” and produces data for the
<span class="argument">ptype</span> and <span class="argument">pflag</span> arguments, 
there is no name for the perceived type and the function fails (returning
<span class="constant">E_FAIL</span>). </p>
<table>
  <tr>
    <th>Input Type </th>
    <th>Perceived Type </th>
    <th>Perceived Flag </th>
    <th>Name of Perceived Type </th>
  </tr>
  <tr>
    <td>.aif </td>
    <td><span class="constant">PERCEIVED_TYPE_AUDIO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>audio </td>
  </tr>
  <tr>
    <td>.aifc </td>
    <td><span class="constant">PERCEIVED_TYPE_AUDIO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>audio </td>
  </tr>
  <tr>
    <td>.aiff </td>
    <td><span class="constant">PERCEIVED_TYPE_AUDIO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>audio </td>
  </tr>
  <tr>
    <td>.asf </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.asx </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.au </td>
    <td><span class="constant">PERCEIVED_TYPE_AUDIO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>audio </td>
  </tr>
  <tr>
    <td>.avi </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.bas </td>
    <td><span class="constant">PERCEIVED_TYPE_APPLICATION</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>application </td>
  </tr>
  <tr>
    <td>.bat </td>
    <td><span class="constant">PERCEIVED_TYPE_APPLICATION</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>application </td>
  </tr>
  <tr>
    <td>.bmp </td>
    <td><span class="constant">PERCEIVED_TYPE_IMAGE</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_GDIPLUS</span> </td>
    <td>image </td>
  </tr>
  <tr>
    <td>.cmd </td>
    <td><span class="constant">PERCEIVED_TYPE_APPLICATION</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>application </td>
  </tr>
  <tr>
    <td>.com </td>
    <td><span class="constant">PERCEIVED_TYPE_APPLICATION</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>application </td>
  </tr>
  <tr>
    <td>.cpl </td>
    <td><span class="constant">PERCEIVED_TYPE_SYSTEM</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>system </td>
  </tr>
  <tr>
    <td>.dib </td>
    <td><span class="constant">PERCEIVED_TYPE_IMAGE</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_GDIPLUS</span> </td>
    <td>image </td>
  </tr>
  <tr>
    <td>.dvr-ms </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.emf </td>
    <td><span class="constant">PERCEIVED_TYPE_IMAGE</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_GDIPLUS</span> </td>
    <td>image </td>
  </tr>
  <tr>
    <td>.exe </td>
    <td><span class="constant">PERCEIVED_TYPE_APPLICATION</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>application </td>
  </tr>
  <tr>
    <td>.gif </td>
    <td><span class="constant">PERCEIVED_TYPE_IMAGE</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_GDIPLUS</span> </td>
    <td>image </td>
  </tr>
  <tr>
    <td>.hta </td>
    <td><span class="constant">PERCEIVED_TYPE_APPLICATION</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>application </td>
  </tr>
  <tr>
    <td>.htm </td>
    <td><span class="constant">PERCEIVED_TYPE_DOCUMENT</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>document </td>
  </tr>
  <tr>
    <td>.html </td>
    <td><span class="constant">PERCEIVED_TYPE_DOCUMENT</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>document </td>
  </tr>
  <tr>
    <td>.ico </td>
    <td><span class="constant">PERCEIVED_TYPE_IMAGE</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_GDIPLUS</span> </td>
    <td>image </td>
  </tr>
  <tr>
    <td>.IVF </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.jfif </td>
    <td><span class="constant">PERCEIVED_TYPE_IMAGE</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_GDIPLUS</span> </td>
    <td>image </td>
  </tr>
  <tr>
    <td>.jpe </td>
    <td><span class="constant">PERCEIVED_TYPE_IMAGE</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_GDIPLUS</span> </td>
    <td>image </td>
  </tr>
  <tr>
    <td>.jpeg </td>
    <td><span class="constant">PERCEIVED_TYPE_IMAGE</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_GDIPLUS</span> </td>
    <td>image </td>
  </tr>
  <tr>
    <td>.jpg </td>
    <td><span class="constant">PERCEIVED_TYPE_IMAGE</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_GDIPLUS</span> </td>
    <td>image </td>
  </tr>
  <tr>
    <td>.lnk </td>
    <td><span class="constant">PERCEIVED_TYPE_UNSPECIFIED</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>.m1v </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.m3u </td>
    <td><span class="constant">PERCEIVED_TYPE_AUDIO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>audio </td>
  </tr>
  <tr>
    <td>.mht </td>
    <td><span class="constant">PERCEIVED_TYPE_DOCUMENT</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>document </td>
  </tr>
  <tr>
    <td>.mid </td>
    <td><span class="constant">PERCEIVED_TYPE_AUDIO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>audio </td>
  </tr>
  <tr>
    <td>.midi </td>
    <td><span class="constant">PERCEIVED_TYPE_AUDIO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>audio </td>
  </tr>
  <tr>
    <td>.msi </td>
    <td><span class="constant">PERCEIVED_TYPE_APPLICATION</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>application </td>
  </tr>
  <tr>
    <td>.mp2 </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.mp2v </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.mp3 </td>
    <td><span class="constant">PERCEIVED_TYPE_AUDIO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>audio </td>
  </tr>
  <tr>
    <td>.mpa </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.mpe </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.mpeg </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.mpg </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.mpv2 </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.pif </td>
    <td><span class="constant">PERCEIVED_TYPE_APPLICATION</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>application </td>
  </tr>
  <tr>
    <td>.png </td>
    <td><span class="constant">PERCEIVED_TYPE_IMAGE</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_GDIPLUS</span> </td>
    <td>image </td>
  </tr>
  <tr>
    <td>.reg </td>
    <td><span class="constant">PERCEIVED_TYPE_APPLICATION</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>application </td>
  </tr>
  <tr>
    <td>.rle </td>
    <td><span class="constant">PERCEIVED_TYPE_IMAGE</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_GDIPLUS</span> </td>
    <td>image </td>
  </tr>
  <tr>
    <td>.rmi </td>
    <td><span class="constant">PERCEIVED_TYPE_AUDIO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>audio </td>
  </tr>
  <tr>
    <td>.scr </td>
    <td><span class="constant">PERCEIVED_TYPE_APPLICATION</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>application </td>
  </tr>
  <tr>
    <td>.search-ms </td>
    <td><span class="constant">PERCEIVED_TYPE_UNSPECIFIED</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>.snd </td>
    <td><span class="constant">PERCEIVED_TYPE_AUDIO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>audio </td>
  </tr>
  <tr>
    <td>.tif </td>
    <td><span class="constant">PERCEIVED_TYPE_IMAGE</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_GDIPLUS</span> </td>
    <td>image </td>
  </tr>
  <tr>
    <td>.tiff </td>
    <td><span class="constant">PERCEIVED_TYPE_IMAGE</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_GDIPLUS</span> </td>
    <td>image </td>
  </tr>
  <tr>
    <td>.vb </td>
    <td><span class="constant">PERCEIVED_TYPE_APPLICATION</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> </td>
    <td>application </td>
  </tr>
  <tr>
    <td>.wav </td>
    <td><span class="constant">PERCEIVED_TYPE_AUDIO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>audio </td>
  </tr>
  <tr>
    <td>.wax </td>
    <td><span class="constant">PERCEIVED_TYPE_AUDIO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>audio </td>
  </tr>
  <tr>
    <td>.wm </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.wma </td>
    <td><span class="constant">PERCEIVED_TYPE_AUDIO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>audio </td>
  </tr>
  <tr>
    <td>.wmf </td>
    <td><span class="constant">PERCEIVED_TYPE_IMAGE</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_GDIPLUS</span> </td>
    <td>image </td>
  </tr>
  <tr>
    <td>.wmv </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.wmx </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.wvx </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_WMSDK</span> </td>
    <td>video </td>
  </tr>
  <tr>
    <td>.zip </td>
    <td><span class="constant">PERCEIVED_TYPE_COMPRESSED</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_HARDCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> <br>
    <span class="constant">PERCEIVEDFLAG_ZIPFOLDER</span> </td>
    <td>compressed </td>
  </tr>
</table>
<h3>Registration </h3>
<p>If the given type is not a recognised file extension, the function looks for 
the perceived type in either of two registry keys, shown below in order of decreasing 
precedence: </p>
<table class="Registry">
  <tr>
    <td>Key: </td>
    <td><span class="regkey">HKEY_CLASSES_ROOT\<span class="placeholder">ext</span></span>
    <br>
    <span class="regkey">HKEY_CLASSES_ROOT\SystemFileAssociations\<span class="placeholder">ext</span></span>
    </td>
  </tr>
  <tr>
    <td>Value: </td>
    <td><span class="regvalue">PerceivedType</span> </td>
  </tr>
  <tr>
    <td>Type: </td>
    <td><span class="constant">REG_SZ</span> or <span class="constant">REG_EXPAND_SZ</span>
    </td>
  </tr>
</table>
<p>where <span class="placeholder">ext</span> is the given type (and need not be 
a file extension). If the function falls back to the second key but cannot fit the 
longer registry path into <span class="constant">MAX_PATH</span> characters, it 
fails. If the function cannot read the value from either key (with a limit of 40 
characters), it fails. In these cases of failure, the perceived type and flags returned 
through the <span class="argument">ptype</span> and <span class="argument">pflag</span> 
arguments are <span class="constant">PERCEIVED_TYPE_FOLDER</span> and
<span class="constant">PERCEIVEDFLAG_UNDEFINED</span> respectively. </p>
<p>The string data for the <span class="regvalue">PerceivedType</span> value is 
the case-insensitive name of the perceived type. Each perceived type has hard-coded 
values for the descriptions that are returned through the <span class="argument">
ptype</span> and <span class="argument">pflag</span> arguments:&nbsp; </p>
<table>
  <tr>
    <th>Name of Perceived Type </th>
    <th>Perceived Type </th>
    <th>Perceived Flag </th>
  </tr>
  <tr>
    <td>none </td>
    <td><span class="constant">PERCEIVED_TYPE_UNSPECIFIED</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_SOFTCODED</span> </td>
  </tr>
  <tr>
    <td><span class="regsz">application</span> </td>
    <td><span class="constant">PERCEIVED_TYPE_APPLICATION</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_SOFTCODED</span> </td>
  </tr>
  <tr>
    <td><span class="regsz">audio</span> </td>
    <td><span class="constant">PERCEIVED_TYPE_AUDIO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_SOFTCODED</span> </td>
  </tr>
  <tr>
    <td><span class="regsz">compressed</span> </td>
    <td><span class="constant">PERCEIVED_TYPE_COMPRESSED</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_SOFTCODED</span> </td>
  </tr>
  <tr>
    <td><span class="regsz">document</span> </td>
    <td><span class="constant">PERCEIVED_TYPE_DOCUMENT</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_SOFTCODED</span> </td>
  </tr>
  <tr>
    <td><span class="regsz">gamemedia</span> </td>
    <td><span class="constant">PERCEIVED_TYPE_GAMEMEDIA</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_SOFTCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> </td>
  </tr>
  <tr>
    <td><span class="regsz">image</span> </td>
    <td><span class="constant">PERCEIVED_TYPE_IMAGE</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_SOFTCODED</span> </td>
  </tr>
  <tr>
    <td><span class="regsz">system</span> </td>
    <td><span class="constant">PERCEIVED_TYPE_SYSTEM</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_SOFTCODED</span> </td>
  </tr>
  <tr>
    <td><span class="regsz">text</span> </td>
    <td><span class="constant">PERCEIVED_TYPE_TEXT</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_SOFTCODED</span> <br>
    <span class="constant">PERCEIVEDFLAG_NATIVESUPPORT</span> </td>
  </tr>
  <tr>
    <td><span class="regsz">video</span> </td>
    <td><span class="constant">PERCEIVED_TYPE_VIDEO</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_SOFTCODED</span> </td>
  </tr>
  <tr>
    <td>else </td>
    <td><span class="constant">PERCEIVED_TYPE_CUSTOM</span> </td>
    <td><span class="constant">PERCEIVEDFLAG_SOFTCODED</span> </td>
  </tr>
</table>
<p>If the name from the registry value is recognised, then the name returned through 
the <span class="argument">ppszType</span> argument is the hard-coded name from 
the table. Otherwise, it is the name from the registry. </p>
<h3>Returned Name </h3>
<p>If the function cannot duplicate the name in order to return a pointer at the 
address given by <span class="argument">ppszType</span>, it fails. Memory for the 
name is found by the <span class="function">SHStrDup</span> function and should 
be freed using <span class="function">CoTaskMemFree</span> when the name is no longer 
needed. </p>
<h3>Comment </h3>
<p>Note that although Microsoft defines a <span class="constant">PERCEIVED_TYPE_UNKNOWN</span> 
and (more significantly) a <span class="constant">PERCEIVED_TYPE_CONTACTS</span>, 
it is not currently possible for this function to produce either of these values, 
and <span class="constant">PERCEIVED_TYPE_FOLDER</span> is nothing but the function’s 
default for an error. Conversely, Microsoft’s documentation has it that
<span class="constant">PERCEIVED_TYPE_DOCUMENT</span> is “not used”, though plainly 
it is. </p>
<p>That the large table of hard-coded perceived types for recognised file extensions 
seems not yet to have been published anywhere (except in the SHLWAPI binary code) 
seems a little odd. It may be the closest that Microsoft comes to a list of so-called 
public file types. Surely though ought be listed somewhere, if only so that nobody 
will even think to try setting a perceived type for them in the registry. </p>
<h2>Availability </h2>
<p>The <span class="function">AssocGetPerceivedType</span> function is exported 
by name from SHLWAPI.DLL in builds of version 6.00 from Windows XP SP2 and higher, 
from Windows Server 2003 SP1 and higher, and from Windows Vista and higher, and 
presumably in higher versions. </p>
<div class="Footer">
  <p class="Dates">This page was created on 19th July 2009. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c09.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2009. Geoff Chappell. All rights reserved.
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="50766" endspan -->
</div>

</body>

</html>
