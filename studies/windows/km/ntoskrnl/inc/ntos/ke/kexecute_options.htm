<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>KEXECUTE_OPTIONS</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <h1>KEXECUTE_OPTIONS </h1>
  <p>The <span class="union">KEXECUTE_OPTIONS</span> structure (formally
  <span class="struct">_KEXECUTE_OPTIONS</span>, and actually a union in most versions) 
  was introduced simultaneously for version 5.1 in Windows XP SP2 and version 5.2 
  in Windows Server 2003 SP1. It is here thought to have no purpose outside the
  <span class="struct"><a href="kprocess/index.htm">KPROCESS</a></span>. Indeed, 
  it started as nothing but a simple structure of <span class="type">UCHAR</span> 
  bit fields: </p>
  <pre class="source">typedef struct _KEXECUTE_OPTIONS {      // late 5.2 to 6.0
    /*  bit fields, see below  */
} KEXECUTE_OPTIONS;</pre>
  <p>Within the <span class="struct">KPROCESS</span>, the <span class="struct">KEXECUTE_OPTIONS</span> 
  were originally a member named <span class="member">Flags</span> in union with 
  a <span class="type">UCHAR</span> named <span class="member">ExecuteOptions</span>. 
  Then Windows 7 wrapped the structure of bit fields and its integral overlay (now 
  made <span class="keyword">volatile</span>) into a union, and Windows 8 added 
  another integral overlay (but without <span class="keyword">volatile</span>):
  </p>
  <pre class="source">typedef union _KEXECUTE_OPTIONS {       // 6.1 and higher
    struct {
        /*  bit fields, see below  */
    };
    UCHAR volatile ExecuteOptions;
    UCHAR ExceptionOptionsNV;           // 6.2 and higher
} KEXECUTE_OPTIONS;</pre>
  <p>Either way, the bit fields themselves remain the same except that one was added 
  for Windows Vista SP1: </p>
  <table class="Flags">
    <colgroup>
      <col class="Mask"><col class="Definition"><col class="Versions">
    </colgroup>
    <thead>
      <tr>
        <th>Mask </th>
        <th>Definition </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x01 </td>
        <td>
        <pre class="source">UCHAR ExecuteDisable : 1;</pre>
        </td>
        <td>late 5.1; <br>
        late 5.2 and higher </td>
      </tr>
      <tr>
        <td>0x02 </td>
        <td>
        <pre class="source">UCHAR ExecuteEnable : 1;</pre>
        </td>
        <td>late 5.1; <br>
        late 5.2 and higher </td>
      </tr>
      <tr>
        <td>0x04 </td>
        <td>
        <pre class="source">UCHAR DisableThunkEmulation : 1;</pre>
        </td>
        <td>late 5.1; <br>
        late 5.2 and higher </td>
      </tr>
      <tr>
        <td>0x08 </td>
        <td>
        <pre class="source">UCHAR Permanent : 1;</pre>
        </td>
        <td>late 5.1; <br>
        late 5.2 and higher </td>
      </tr>
      <tr>
        <td>0x10 </td>
        <td>
        <pre class="source">UCHAR ExecuteDispatchEnable : 1;</pre>
        </td>
        <td>late 5.1; <br>
        late 5.2 and higher </td>
      </tr>
      <tr>
        <td>0x20 </td>
        <td>
        <pre class="source">UCHAR ImageDispatchEnable : 1;</pre>
        </td>
        <td>late 5.1; <br>
        late 5.2 and higher </td>
      </tr>
      <tr>
        <td>0x40 </td>
        <td>
        <pre class="source">UCHAR DisableExceptionChainValidation : 1;</pre>
        </td>
        <td>late 6.0 and higher </td>
      </tr>
      <tr>
        <td rowspan="2">&nbsp;</td>
        <td>
        <pre class="source">UCHAR Spare : 2;</pre>
        </td>
        <td>late 5.1; <br>
        late 5.2 to early 6.0 </td>
      </tr>
      <tr>
        <td>
        <pre class="source">UCHAR Spare : 1;</pre>
        </td>
        <td>late 6.0 and higher </td>
      </tr>
    </tbody>
  </table>
  <div class="Footer">
    <p class="Dates">This page was created on 8th October 2017 from material that 
    was first published on 15th <a href="../../../../../../../new/16/06.htm">June 
    2016</a>. It was last modified on 30th September 2022. </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c1622.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2016-2022. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="4925" -->
  </div>
</div>

</body>

</html>
