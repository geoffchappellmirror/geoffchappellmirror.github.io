<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>OS_DATACENTER</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="55064" endspan -->
<h1>OS_DATACENTER </h1>
<p>The <span class="function"><a href="isos.htm">IsOS</a></span> function supports
<span class="constant">OS_DATACENTER</span> as its <span class="argument">dwOS</span> 
argument in various builds of SHLWAPI versions 5.0 and 5.50 (see below), and then 
in version 6.0 and higher. However, these two sets of versions appear to address 
entirely unrelated questions about the operating system. </p>
<p>For those builds of versions 5.0 and 5.50 that support <span class="constant">
OS_DATACENTER</span>, the function returns TRUE if </p>
<ul>
  <li>product type is server </li>
  <li>and major version is 5 </li>
  <li>and suite is both enterprise and blade, but not data center </li>
</ul>
<p>For version 6.0, the test is changed to </p>
<ul>
  <li>product type is domain controller or server </li>
  <li>and suite is data center </li>
</ul>
<p>except that the builds from Windows XP SP2 and SP3 try to have it both ways: 
these apply the earlier test if the operating system version is 5.0, else the later.
</p>
<h2>Availability </h2>
<p>The <span class="constant">OS_DATACENTER</span> case of the SHLWAPI function
<span class="function">IsOS</span> is available in version 6.0 and higher. An earlier 
implementation is known in the following builds of versions 5.0 and 5.50: </p>
<ul>
  <li>5.0 from Internet Explorer 5.01 (for Windows 2000 and higher) </li>
  <li>5.0 from Windows 2000 from SP1 and higher </li>
  <li>5.50 from Internet Explorer 5.5 SP2 </li>
</ul>
<p>but is better regarded as a superseded attempt at a different test. </p>
<h2>Use By Microsoft </h2>
<p>Use of <span class="constant">OS_DATACENTER</span> seems rare. One use that Microsoft 
is known to have found for <span class="constant">OS_DATACENTER</span> is in many 
but not all builds of SHDOCVW.DLL version 6.0, for a feature that may first be seen 
through an Internet Explorer dialog box: </p>
<p>
<img border="0" src="_images/mediabarsettings.jpg" width="392" height="188" alt="Media Bar Settings"></p>
<p>This feature (or, rather, Microsoft’s particular design of it) requires “Windows 
Media Player 7 or greater”. If you click Yes but Windows Media Player 7 or greater 
is not installed, then SHDOCVW will tell you (if your operating system is Windows 
XP or greater): </p>
<p>
<img src="_images/wmpnotinstalled.jpg" border="0" width="782" height="126" alt="Windows Media Player not installed"></p>
<p>This may be primarily a ruse by which one Microsoft application, Internet Explorer, 
that dominated its market at the time gets to advertise another Microsoft application, 
Windows Media Player, that had competitors. Anyway, if the operating system is not 
sufficiently capable or suitable for Windows Media Player 7 or greater, then SHDOCVW 
does not bother offering the Media Bar, let alone suggesting that you try (pointlessly, 
as it would turn out) to install Microsoft’s media player. </p>
<p>Necessary (and documented) conditions for the Media Bar are that the operating 
system be at least Windows 98 or Windows 2000. See, for instance
<a target="_top" href="http://support.microsoft.com/kb/298638">Media Bar is Unavailable 
on Internet Explorer 6 for Windows NT 4.0</a>. However, there are three ways that 
an otherwise acceptable system can be ruled unsuitable for Windows Media Player 
7 or greater. One is that it satisfies the <span class="constant">OS_DATACENTER</span> 
conditions. </p>
<p>This tie between Internet Explorer and Windows Media Player is withdrawn from 
SHDOCVW version 6.0 starting with Windows XP SP2. Perhaps it just passed its usefulness 
or was frowned on by some regulatory authority, but it is curiously contemporaneous 
with when Microsoft seems to have noticed that <span class="constant">OS_DATACENTER</span> 
is ill-defined, having meant very different things at different times. </p>
<div class="Footer">
  <p class="Dates">This page was created on 11th May 2007 and was last modified 
  on 26th December 2009. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c0709.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2007-2009. Geoff Chappell. All rights reserved.
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="4319" endspan -->
</div>

</body>

</html>
