<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>OBJECT_HEADER_PROCESS_INFO</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <h1>OBJECT_HEADER_PROCESS_INFO </h1>
  <p>The <span class="struct">OBJECT_HEADER_PROCESS_INFO</span> structure is one 
  of several structures that may precede an <span class="struct">
  <a href="object_header/index.htm">OBJECT_HEADER</a></span> in a memory block that 
  contains an Object Manager object. Its one purpose is to tell which process, if 
  any, has the exclusive use of the object. If the object is not created for exclusive 
  access, then the <span class="struct">OBJECT_HEADER_PROCESS_INFO</span> is not 
  needed and is not present. </p>
  <p>To get exclusive use of an object, a process specifies the
  <span class="constant">OBJ_EXCLUSIVE</span> attribute among the
  <span class="member">Attributes</span> in the <span class="struct">OBJECT_ATTRIBUTES</span> 
  when creating the object. This has ancient support, but only in version 6.1 and 
  higher is it recorded in the <span class="struct">OBJECT_HEADER_PROCESS_INFO</span> 
  specifically. Versions 3.50 to 6.0 keep the information as a member of the
  <span class="struct"><a href="object_header_quota_info.htm">OBJECT_HEADER_QUOTA_INFO</a></span>. 
  Version 3.10 has it in the <span class="struct">OBJECT_CREATE_INFORMATION</span>.
  </p>
  <p>That an <span class="struct">OBJECT_HEADER_PROCESS_INFO</span> is present for 
  a given object is indicated by a set 0x10 bit in the <span class="member">
  <a href="object_header/infomask.htm">InfoMask</a></span> in the
  <span class="struct">OBJECT_HEADER</span>. How far the one precedes the other 
  depends on which other headers are present, which is in turn indicated by other 
  bits in the <span class="member">InfoMask</span>. </p>
  <h2>Layout </h2>
  <p>The <span class="struct">OBJECT_PROCESS_CREATOR_INFO</span> structure is 0x08 
  or 0x10 bytes in 32-bit and 64-bit Windows, respectively. Microsoft’s names and 
  types are known from type information in public symbol files for the kernel in 
  the applicable versions. </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset" span="2"><col class="Definition"><col class="Versions">
    </colgroup>
    <thead>
      <tr>
        <th>Offset (x86) </th>
        <th>Offset (x64) </th>
        <th>Definition </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00 </td>
        <td>0x00 </td>
        <td>
        <pre class="source">EPROCESS *ExclusiveProcess;</pre>
        </td>
        <td>6.1 and higher </td>
      </tr>
      <tr>
        <td>0x04 </td>
        <td>0x08 </td>
        <td>
        <pre class="source">ULONG_PTR Reserved;</pre>
        </td>
        <td>6.1 and higher </td>
      </tr>
    </tbody>
  </table>
  <div class="Footer">
    <p class="Dates">This page was created on 17th June 2020 but was not published 
    until 30th <a href="../../../../../../../new/20/06.htm">June 2020</a>. </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c20.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2020. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="5634" -->
  </div>
</div>

</body>

</html>
