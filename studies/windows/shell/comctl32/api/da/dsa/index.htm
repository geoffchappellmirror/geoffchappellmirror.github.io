<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Dynamic Structure Arrays</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/shell.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js">
</script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js">
</script>
<script type="text/javascript" src="../../../../_scripts/shell.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell - Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="14798" endspan -->
<h1>Dynamic Structure Arrays </h1>
<p>From the very start, with version 4.00, COMCTL32 provided a set of functions 
for working with arrays of fixed-size structures. Apart from the addition of two 
functions in version 4.71, the interface was stable until a catch-up (with 
similar DPA functions) for Windows Vista: </p>
<ul>
  <li><span class="function">DSA_Clone</span> (6.10) </li>
  <li><span class="settlement function">DSA_Create</span> </li>
  <li><span class="doc06 function">DSA_DeleteAllItems</span> </li>
  <li><span class="doc0406 function">DSA_DeleteItem</span> </li>
  <li><span class="settlement function">DSA_Destroy</span> </li>
  <li><span class="settlement function">DSA_DestroyCallback</span> (4.71) </li>
  <li><span class="doc06 function">DSA_EnumCallback</span> (4.71) </li>
  <li><span class="doc0406 function">DSA_GetItem</span> </li>
  <li><span class="settlement function">DSA_GetItemPtr</span> </li>
  <li><span class="function">DSA_GetSize</span> (6.10) </li>
  <li><span class="settlement function">DSA_InsertItem</span> </li>
  <li><span class="doc0406 function">DSA_SetItem</span> </li>
  <li><span class="function">DSA_Sort</span> (6.10) </li>
</ul>
<h2>Documentation Status </h2>
<p>Though 8 of the 13 DSA functions date from the original Windows 95 and two 
from Internet Explorer 4.0 (released in 1997), none were documented until late 
2002 as
<a target="_top" href="http://msdn.microsoft.com/library/ms807073.aspx">
Settlement Program Interfaces</a>. Even then, Microsoft documented only half as 
many as existed, and declared these as requiring Windows 2000 as the minimum 
operating system. </p>
<!--webbot bot="Include" U-Include="../_include/baredoc.htm" TAG="BODY" startspan -->

<p>As with much of the documentation that results from that settlement, Microsoft’s 
effort is extraordinarily grudging and miserly. This documentation comes with no 
overview of the functionality. Barely all that is offered is that for each function, 
such little information as a competent reader might discern from uncommented C-language 
prototypes is repackaged in the standard form of MSDN documentation. The C-language 
prototypes anyway do not seem to have been released (in COMMCTRL.H, as supplied 
with the Platform SDK) until 2003. </p>

<!--webbot bot="Include" i-checksum="37146" endspan -->
<p>For compliance with Section III.D of the
<a target="_top" href="http://www.usdoj.gov/atr/cases/f200400/200457.htm">Final 
Judgment</a> in a well-publicised anti-trust suit by various U.S. governments, 
Microsoft must document all API functions that are implemented in components of 
Windows and used by components of so-called Microsoft Middleware and 
particularly of Internet Explorer. Of the 10 pre-Vista DSA functions, 9 are used 
by SHDOCVW.DLL, i.e., by the essence of Internet Explorer. Only one (<span class="function">DSA_EnumCallback</span>) 
is plausibly an internal Windows API, whose only known use is by other 
components of Windows (specifically by EXPLORER.EXE and SHELL32.DLL) and not by 
any components of anything that the judgement defines as a Microsoft Middleware 
Product. How can it be that only 5 got documented for the settlement? </p>
<h3>Post-Settlement Documentation </h3>
<p>Some time during 2006 (but perhaps in 2005), Microsoft documented three more 
DSA functions: <span class="function">DSA_DeleteItem</span>,
<span class="function">DSA_GetItem</span> and <span class="function">DSA_SetItem</span>. 
These newly documented functions are acknowledged as dating from Windows 95, not 
that it seems to have occurred to anyone to wonder at how these functions might 
then have obtained their expected DSA handle when no function that can produce a 
DSA handle would be available for another few years. Personally, I can only 
applaud the sense of humour of whoever at Microsoft saw that these functions are 
a decade old yet added the same bright-red tag “This documentation is 
preliminary and is subject to change” that Microsoft more typically uses for 
interfaces that are still in development. </p>
<p>That warning got removed in time for the Windows Vista SDK dated January 
2007, which also documents the two remaining old DSA functions and the three new 
ones. </p>
<div class="Footer">
  <!--webbot bot="Include" U-Include="../../../../_include/c0507.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2005-2007. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="4797" endspan -->
</div>

</body>

</html>