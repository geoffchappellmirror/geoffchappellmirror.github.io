<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>ETW_NOTIFICATION_HEADER</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../../_styles/km.css">
<script type="text/javascript" src="../../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../../_scripts/km.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../../../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../../../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="48540" -->
<div class="Main">
  <h1>ETW_NOTIFICATION_HEADER </h1>
  <p>The <span class="struct">ETW_NOTIFICATION_HEADER</span> structure describes 
  an event notification for multiple cases of the <span class="function">
  <a href="../../../api/etw/traceapi/control/index.htm">NtTraceControl</a></span> 
  function. </p>
  <h2>Documentation Status </h2>
  <p>The <span class="struct">ETW_NOTIFICATION_HEADER</span> structure is not documented.
  </p>
  <!--webbot bot="Include" U-Include="_include/typeinfo_struct.htm" TAG="BODY" startspan -->

<p>A few public disclosures are known from Microsoft, though not as any sort of 
plain-English documentation. One is that a previously unpublished header named NTETW.H 
was published in the original and Version 1511 editions of the Windows Driver Kit 
(WDK) for Windows 10, and this header contains a C-language definition of the structure.
</p>
<p>Were it not for this limited and possibly unintended disclosure of NTETW.H, a 
practical equivalent of the C-language definition (but missing comments, of course) 
would anyway be known from type information in symbol files. But this too has the 
look of an oversight. Type information for this structure has never appeared in 
any public symbol files for the kernel or for the obvious low-level user-mode DLLs. 
It has instead slipped out in symbol files for a smattering of higher-level user-mode 
DLLs, starting with Windows 8. For these few, the readily available symbol files 
actually are private symbol files and show that the unpublished
<a href="../../../source/inc/ntetw.htm">NTETW.H</a> was included when compiling 
the corresponding binaries. </p>

<!--webbot bot="Include" endspan i-checksum="23935" -->
  <!--webbot bot="Include" U-Include="_include/clfsmgmt.htm" TAG="BODY" startspan -->

<p>Type information also has been published in a statically linked library, named 
CLFSMGMT.LIB, which Microsoft distributes with the Software Development Kit (SDK) 
starting for Windows Vista. This does not have the forensic quality as has type 
information in symbol files for the binaries that ship with an operating system, 
for although it is as accurate for when the library was built, there is no requirement 
that the library have been built with the operating system that it targets. There 
can be, and often is, some discrepancy, and there is anyway not always a fresh library 
for each service pack. </p>

<!--webbot bot="Include" endspan i-checksum="57935" -->
  <h2>Layout </h2>
  <p>The <span class="struct">ETW_NOTIFICATION_HEADER</span> is 0x48 bytes in both 
  32-bit and 64-bit Windows in versions 6.0 and higher. Whether it or something 
  enough like it exists in versions before 6.0, i.e., before
  <span class="function">NtTraceControl</span>, is left for another time. Offsets, 
  types and names in the table that follows are from type information in symbol 
  files and libraries, and from the published C-language definition, as described 
  above. </p>
  <table class="Struct">
    <colgroup>
      <col class="Offset"><col class="Definition"><col class="Versions">
    </colgroup>
    <thead>
      <tr>
        <th>Offset </th>
        <th>Definition </th>
        <th>Versions </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0x00 </td>
        <td>
        <pre class="source"><a href="etw_notification_type.htm">ETW_NOTIFICATION_TYPE</a> NotificationType;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x04 </td>
        <td>
        <pre class="source">ULONG NotificationSize;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x08 </td>
        <td>
        <pre class="source">ULONG Offset;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x0C </td>
        <td>
        <pre class="source">BOOLEAN ReplyRequested;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td rowspan="2">0x10 </td>
        <td>
        <pre class="source">ULONG Reserved1;</pre>
        </td>
        <td>6.0 only </td>
      </tr>
      <tr>
        <td>
        <pre class="source">ULONG Timeout;</pre>
        </td>
        <td>6.1 and higher </td>
      </tr>
      <tr>
        <td>0x14 </td>
        <td>
        <pre class="source">union {
    ULONG ReplyCount;
    ULONG NotifyeeCount;
};</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x18 </td>
        <td>
        <pre class="source">ULONGLONG Reserved2;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x20 </td>
        <td>
        <pre class="source">ULONG TargetPID;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x24 </td>
        <td>
        <pre class="source">ULONG SourcePID;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x28 </td>
        <td>
        <pre class="source">GUID DestinationGuid;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
      <tr>
        <td>0x38 </td>
        <td>
        <pre class="source">GUID SourceGuid;</pre>
        </td>
        <td>6.0 and higher </td>
      </tr>
    </tbody>
  </table>
  <p>When <span class="member">Reserved1</span> gave way to <span class="member">
  Timeout</span> is not yet known. The former is known from type information in 
  CLFSMGMT.LIB but this library is not known in a version that targets any Windows 
  Vista service pack. Inspection of binaries can reveal when
  <span class="member">Timeout</span> was first used. More research is required.
  </p>
  <div class="Footer">
    <p class="Dates">This page was created on 27th November 2016 but was not published 
    until 31st <a href="../../../../../../../new/18/12.htm">December 2018</a>. It 
    was last modified on 30th <a href="../../../../../../../new/22/10.htm">November 
    2022</a>. </p>
    <!--webbot bot="Include" U-Include="../../../../_include/c1822.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2018-2022. Geoff Chappell. All rights reserved. 
<a href="../../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="5181" -->
  </div>
</div>

</body>

</html>
