<!doctype html>
<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>The Advanced Boot Options Menu in Windows Vista</title>
<link rel="stylesheet" type="text/css" href="../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../_styles/notes.css">
<script type="text/javascript" src="../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../_scripts/notes.js" defer></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript Header" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li> 
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../index.htm">Home</a> </li><!--
     --><li class="LinkListItem"><a target="_self" href="../../toc.htm">Table of Contents</a> </li><!--
     --><li class="LinkListItem"><a href="../../../about/index.htm">About This Site</a> </li>
      </ul>
      <ul class="PreferNoWrap">
        <li class="LinkListItem"><a href="../../../new/index.htm">What’s New?</a> </li><!--
     --><li class="LinkListItem"><a href="../../../feedback/index.htm">Feedback</a> </li><!--
     --><li class="LinkListItem"><a href="../../../consult/index.htm">Consult</a> </li>
      </ul>
      </li>
    </ul>
  </div>
  <div id="Logo">
    <p><span class="PreferNoWrap">Geoff Chappell -</span> <span class="PreferNoWrap">Software Analyst</span> </p>
  </div>
</div>

<!--webbot bot="Include" endspan i-checksum="55207" -->
<div class="Main">
  <h1>Advanced Boot Options Menu in Windows Vista </h1>
  <p>A machine on which Windows Vista is installed may present a Windows Boot Manager 
  menu in text mode at start up to offer a choice of operating systems or of configurations 
  in which to start an operating system. When the current selection in this menu 
  corresponds to an installation of Windows Vista, the menu advises that the F8 
  key may be pressed to “specify an advanced option for this choice”. Doing so calls 
  up an Advanced Boot Options menu. </p>
  <p>The Advanced Boot Options menu can also be made to persist for an operating 
  system. Set the BCD element <span class="bcdopt">advancedoptions</span> to true 
  in the corresponding <span class="bcdobj">osloader</span> application object. 
  Once done, whenever this object is selected from the Windows Boot Manager menu, 
  the WINLOAD.EXE that runs for the selected operating system starts by presenting 
  the Advanced Boot Options menu. </p>
  <p>The effect of selecting from the Advanced Boot Options menu is to start the 
  operating system as if one or more BCD options had been set (but without editing 
  them into the BCD store). The following table shows the correspondence, which 
  for some reason Microsoft seems not to document: </p>
  <table>
    <tr>
      <th>Menu Entry </th>
      <th>Option </th>
      <th>Value </th>
    </tr>
    <tr>
      <td rowspan="4">Safe Mode </td>
      <td><span class="bcdopt">bootlog</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td><span class="bcdopt">quietboot</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td><span class="bcdopt">safeboot</span> </td>
      <td><span class="keyword">Minimal</span> (0) </td>
    </tr>
    <tr>
      <td><span class="bcdopt">sos</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td rowspan="4">Safe Mode with Networking </td>
      <td><span class="bcdopt">bootlog</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td><span class="bcdopt">quietboot</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td><span class="bcdopt">safeboot</span> </td>
      <td><span class="keyword">Network</span> (1) </td>
    </tr>
    <tr>
      <td><span class="bcdopt">sos</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td rowspan="5">Safe Mode with Command Prompt </td>
      <td><span class="bcdopt">bootlog</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td><span class="bcdopt">quietboot</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td><span class="bcdopt">safeboot</span> </td>
      <td><span class="keyword">Minimal</span> (0) </td>
    </tr>
    <tr>
      <td><span class="bcdopt">safebootalternateshell</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td><span class="bcdopt">sos</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td>Enable Boot Logging </td>
      <td><span class="bcdopt">bootlog</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td>Enable low-resolution video (640x480) </td>
      <td><span class="bcdopt">vga</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td>Last Known Good Configuration (advanced) </td>
      <td><span class="bcdopt">lastknowngood</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td rowspan="2">Directory Services Restore Mode </td>
      <td><span class="bcdopt">safeboot</span> </td>
      <td><span class="keyword">DsRepair</span> (2) </td>
    </tr>
    <tr>
      <td><span class="bcdopt">sos</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td>Debugging Mode </td>
      <td><span class="bcdopt">debug</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td>Disable automatic restart on system failure </td>
      <td><span class="bcdopt">nocrashautoreboot</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td>Disable Driver Signature Enforcement </td>
      <td><span class="undocumented bcdopt">oslnointegritychecks</span> </td>
      <td>true </td>
    </tr>
    <tr>
      <td>Start Windows Normally </td>
      <td><span class="bcdopt">quietboot</span> </td>
      <td>true </td>
    </tr>
  </table>
  <p>As with additions to the <a href="editoptions.htm">Edit Boot Options menu</a>, 
  some additions may have been acted on already, if only partially, and may therefore 
  not have exactly the same effect as when loaded from the BCD store. The
  <span class="bcdopt">oslnointegritychecks</span> option is not permitted to persist 
  in the BCD store, so that the only (known) way to activate it is through the Disable 
  Driver Signature Enforcement entry on the Advanced Boot Options menu. </p>
  <div class="Footer">
    <p class="Dates">This page was created on 23rd February 2009. </p>
    <!--webbot bot="Include" U-Include="../../_include/c09.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2009. Geoff Chappell. All rights reserved. 
<a href="../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" endspan i-checksum="41384" -->
  </div>
</div>

</body>

</html>
