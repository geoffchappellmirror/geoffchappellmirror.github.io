<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>StopRpcServer</title>
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/master.css">
<link rel="stylesheet" type="text/css" href="../../../../../../_styles/document.css">
<link rel="stylesheet" type="text/css" href="../../../_styles/win32.css">
<script type="text/javascript" src="../../../../../../_scripts/master.js"></script>
<script type="text/javascript" src="../../../../../../_scripts/document.js"></script>
<script type="text/javascript" src="../../../_scripts/win32.js"></script>
</head>

<body>

<!--webbot bot="Include" U-Include="../../../_include/noscript.htm" TAG="BODY" startspan -->

<div class="NoScript" id="Banner">
  <div id="Links">
    <ul class="LinkList">
      <li class="LinkListItem"><a href="../../../../../../index.htm"><span>Home</span></a> </li>
      <li class="LinkListItem"><a target="_self" href="../../../toc.htm"><span>Table of Contents</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../about/index.htm"><span>About This Site</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../new/index.htm"><span>What’s New?</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../feedback/index.htm"><span>Feedback</span></a> </li>
      <li class="LinkListItem"><a href="../../../../../../consult/index.htm"><span>Consult</span></a> </li>
    </ul>
  </div>
  <div id="Logo">
    <p>Geoff Chappell, Software Analyst </p>
  </div>
</div>

<!--webbot bot="Include" i-checksum="54033" endspan -->
<!--webbot bot="Include" U-Include="../../../_include/draft.htm" TAG="BODY" startspan -->

<div class="Header">
  <p class="alert">DRAFT: Take more than your usual care. </p>
</div>

<!--webbot bot="Include" i-checksum="34080" endspan -->
<h1>StopRpcServer </h1>
<p>A service DLL running in a <a href="../index.htm">SVCHOST</a> process calls this function to stop an RPC 
server instance. </p>
<h2>Declaration </h2>
<p>Access to the function is indirect, through the <span class="member">StopRpcServer</span> 
member of the <span class="struct"><a href="globaldata.htm">SVCHOST_GLOBAL_DATA</a></span> 
structure whose address was passed to the service DLL’s <span class="function">
<a href="../dll/svchostpushserviceglobals.htm">SvchostPushServiceGlobals</a></span> 
function. The member has the following type definition: </p>
<pre class="source">typedef NTSTATUS (WINAPI *) LPSTOP_RPC_SERVER (RPC_IF_HANDLE IfSpec);</pre>
<h3>Parameters </h3>
<p>The <span class="argument">IfSpec</span> argument is the address of a MIDL-generated 
structure that describes the interface to remove. </p>
<h3>Return Value </h3>
<p>The function returns zero for success, else an error code. </p>
<h2>Behaviour </h2>
<p>The function asks that the given interface be removed from the RPC Run-Time registry. 
The result of this call to <span class="function">RpcServerUnregisterIf</span> becomes 
the result of the function. Whether the function succeeds or fails, an instance 
is considered to have stopped. If no other instance is running, the function tells 
the server to stop listening for RPCs and then waits for all calls to complete.
</p>
<h2>Availability </h2>
<p>The <span class="function">StopRpcServer</span> function is exposed to service 
DLLs by SVCHOST.EXE in versions 5.1 and higher. </p>
<div class="Footer">
  <p class="Dates">This page was created on 13th October 2008 and was last modified 
  on 26th October 2008. </p>
  <!--webbot bot="Include" U-Include="../../../_include/c08.htm" TAG="BODY" startspan -->

<p class="Copyright">Copyright © 2008. Geoff Chappell. All rights reserved. 
<a href="../../../../../../about/terms.htm">Conditions apply</a>. </p>

<!--webbot bot="Include" i-checksum="62741" endspan -->
</div>

</body>

</html>
